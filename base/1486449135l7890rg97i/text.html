<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'Arial'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сайт <a href="http://stopforumspam.com"><span style=" font-family:'Courier New'; text-decoration: underline; color:#0000ff;">stopforumspam.com</span></a> - это общественный проект, предоставляющий сведения об E-mail и IP с которых осуществляются спамерские атаки на форумы. База простоянно обновляется и актуализируется. Имеется API для автоматизированных запросов. Использование бесплатное, но авторы проекта охотно принимают донаты.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a>Пример запроса к StopForumSpam:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">http://www.stopforumspam.com/api?&amp;</span><a name="post30298"></a><span style=" font-family:'Courier New'; font-weight:600; color:#6a1009;">email=olya-komosko@mail.ru</span><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">&amp;f=serial</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a>Ответ будет дан в виде сериализованного ассоциативного массива:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">a:2:{s:7:&quot;success&quot;;i:1;s:5:&quot;email&quot;;a:4:{s:8:&quot;lastseen&quot;;s:19:&quot;2017-02-06 16:29:28&quot;;s:9:&quot;frequency&quot;;i:22;s:7:&quot;</span><a name="post30298"></a><span style=" font-family:'Courier New'; font-weight:600; color:#6a1009;">appears</span><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">&quot;;i:</span><a name="post30298"></a><span style=" font-family:'Courier New'; font-weight:600; color:#6a1009;">1</span><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">;s:10:&quot;</span><a name="post30298"></a><span style=" font-family:'Courier New'; font-weight:600; color:#6a1009;">confidence</span><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">&quot;;d:</span><a name="post30298"></a><span style=" font-family:'Courier New'; font-weight:600; color:#6a1009;">83.019999999999996</span><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">;}}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a>Тут невооруженным взглядом видно, что параметр <a name="post30298"></a><span style=" font-family:'Courier New'; font-weight:600; color:#6a1009;">a</span><span style=" font-family:'Courier New'; font-weight:600; color:#6a1009;">ppears</span><a name="post30298"></a> (появление в базе спамеров) равно 1, а параметр <a name="post30298"></a><span style=" font-family:'Courier New'; font-weight:600; color:#6a1009;">c</span><span style=" font-family:'Courier New'; font-weight:600; color:#6a1009;">onfidence</span><a name="post30298"></a> (уверенность) равен 83%.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a>Для PunBB 1.4.4 можно сделать следующую проверку. Необходимо найти файл include/email.php, и добавить в него функцию:</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">function is_spam_email($email)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">  try </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">  {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">    $data = unserialize(file_get_contents('http://www.stopforumspam.com/api?&amp;email='.urlencode($email).'&amp;f=serial'));</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">    </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">    // Если сервис StopForumSpam не отвечает</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">    if($data === false) </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">      return false;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">    </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">    // Если в ответе нет нужных полей</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">    if(!(isset($data['email']['appears']) and isset(['email']['confidence'])))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">      return false;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a1009;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">    if($data['email']['appears']!=0 and $data['email']['confidence']&gt;=70)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">      return true; // Email в базе спаммеров</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">    else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">      return false;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">  } </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">  catch (Exception $e) </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">  {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">   return false; // Попытка запроса была неудачной</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">  }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a><span style=" font-family:'Courier New'; color:#6a1009;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a>Затем<span style=" color:#000000;"> надо найти файл </span>register.php и добавить в него код </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="post30298"></a>Везде сам использую взамен капч и вопрос/ответ. На форумах или CMS. Вот тебе ТС решение. Вставь с 156 строки в файл register.php следующий код:<br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">$data = unserialize(file_get_contents('http://www.stopforumspam.com/api?&amp;email=' . urlencode($email1) . '&amp;f=serial'));</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">if($data['email']['appears'] != 0)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a1009;">  $errors[] = 'Простите, но ваш E-Mail находиться в спам-листах.';</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>