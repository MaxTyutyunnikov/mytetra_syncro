<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В Debian Linux 11 Stable и Ubuntu версий 19-20 имеется плавающий баг. Баг заключается в том, что открытие файлового диалога на сохранение или открытие файла происходит крайне медленно, несколько десятков секунд, а в особо запущенных случаях - минуты. При этом на 100% загружается одно ядро, вентилятор начинает бешенно крутиться и охлаждать процессор.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Явно видно, что баг проявляется в стандартном окне файлового диалога, созданного через библиотеку Qt. Поиск решения чтобы избавиться от этого бага был труден и тернист, в официальных багтрекерах готового решения найти не удалось.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В любом случае, дело оказалось в файле <span style=" font-family:'FreeMono'; color:#6a1009;">~/,config/QtProject.conf</span>, с которым некорректно работает какой-то компонент Qt. Возможно, возникают какие-то проблемы с обработкой UTF-8 строк. В общем, при каких-то условиях запись <span style=" font-family:'FreeMono'; color:#6a1009;">shortcuts</span> в этом файле начинает содержать все большую и большую строку, состоящую из кодов символов <span style=" font-family:'FreeMono'; color:#6a1009;">0xC2 0x83 0xC3 0x82</span>. В момент решения проблемы, строка имела размер примерно 125Мб.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">shortcuts=file:///home/user/Desktop, file:///home/user/\xc3\x83\xc2\x83\xc3\x82</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">\xc2\x83\xc3\x83\xc2\x82\xc3\x82\xc2\x83\xc3\x83\xc2\x83\xc3\x82\xc2\x82</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">\xc3\x83\xc2\x82\xc3\x82\xc2\x83\xc3\x83\xc2\x83\xc3\x82\xc2\x83\xc3\x83</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">\xc2\x82\xc3\x82\xc2\x82\xc3\x83\xc2\x83\xc3\x82\xc2\x82\xc3\x83\xc2\x82</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">\xc3\x82\xc2\x83\xc3\x83\xc2\x83\xc3\x82\xc2\x83\xc3\x83\xc2\x82\xc3\x82</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009;">...</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Возможно, в каких-то обновлениях Debian Linux эта проблема генерации гигантской строки была решена, а файл <span style=" font-family:'FreeMono'; color:#6a1009;">~/,config/QtProject.conf</span> остался и не дает нормально работать файловому диалогу.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:42px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Решение:</span> просто удалить пользовательский файл <span style=" font-family:'FreeMono'; color:#6a1009;">~/,config/QtProject.conf</span>. Да, при этом исчезнут наработанные шорткаты для часто используемых директорий, но что от них толку, если с ними файловый диалог не может нормально работать? Так что самое простое - удалить данный файл, и диалоги сохранения/ открытия файлов начинают работать мгновенно.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ох, и долго мне не давал по-человечески работать в Linux этот баг. Хорошо, что после года мучений мне наконец посчастливилось от него избавиться, поняв в каком-то виде причину его появления. Решение я нашел вот в этом обсуждении: <a href="https://bbs.archlinux.org/viewtopic.php?pid=2055916#p2055916"><span style=" text-decoration: underline; color:#0000ff;">https://bbs.archlinux.org/viewtopic.php?pid=2055916#p2055916</span></a>. Словосочетание &quot;<span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">move away&quot; переводится как &quot;удалить&quot;. Не сразу понятно что это, ведь обычно ожидаешь слов &quot;delete&quot; или &quot;remove&quot;, а тут вона как литературно завернули.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>