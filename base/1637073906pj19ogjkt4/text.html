<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Содержание статьи</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Структура ZIP-файла с прошивкой</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Распаковываем system.new.dat</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Скрипт</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ручной способ</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Структура каталогов Android</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Удаляем и добавляем приложения</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Меняем анимацию загрузки</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Изменяем звуковое оформление</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Добавляем шрифты</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Меняем системные настройки (build.prop)</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Внедряем в прошивку Google Apps</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Свободное место</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сборка</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Подводные камни</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Установка</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выводы</li></ul>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Наверняка у тебя как у пользователя Android возникало желание сделать операционную систему лучше, добавить полезное, убрать лишнее и поделиться своим творением с обществом. Сборка собственной прошивки из исходников — сложный процесс, требующий глубоких знаний предмета, однако никто не запрещает взять стандартную прошивку смартфона и адаптировать ее под свои нужды. Это не так уж и сложно сделать.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Начнем с того, что тебе нужен Linux. В Windows ты сможешь только разобрать прошивку, но собрать обратно уже не получится по чисто техническим причинам. Теперь о прошивке. Обычно они распространяются в виде ZIP-архивов, прошиваемых через кастомные рекавери. Именно один из них нам и понадобится для опытов. Начинать путь ромодела я рекомендую с какой-нибудь максимально приближенной к AOSP кастомной прошивки, потому что в ней зачастую проще разобраться, чем в стоке.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Нужный ZIP можно найти на</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><a href="https://forum.xda-developers.com/"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; text-decoration: underline; color:#dd2200;">XDA Developers</span></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> или </span><a href="http://4pda.ru/forum/"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; text-decoration: underline; color:#dd2200;">4PDA</span></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">. Но имей в виду, что нужна прошивка конкретно для твоей модели аппарата, — у того же Galaxy S7 есть несколько модификаций для разных рынков, не всегда совместимых между собой.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="toc01."></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;"> </span></p>
<h2 style=" margin-top:36px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:100%; background-color:#ffffff;"><span style=" font-family:'Roboto'; font-size:x-large; font-weight:696; color:#111111; background-color:#ffffff;">Структура ZIP-файла с прошивкой</span></h2>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">После загрузки распакуем архив с помощью любого архиватора. Внутри будет следующий набор файлов и папок:</span></p>
<ul type="square" style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:16px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">META-INF</span><span style=" font-size:18px;"> — папка с метаинформацией о прошивке (сертификат автора, манифест со списком файлов, их контрольными суммами), скриптом обновления (updater-script) и инсталлятором (update-binary), который выполняет команды скрипта по монтированию разделов, копированию файлов и другим действиям с NAND-памятью;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">boot.img</span><span style=" font-size:18px;"> — образ с ядром и RAM-диском (он прошивается в раздел boot);</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">system.new.dat</span><span style=" font-size:18px;"> — это, грубо говоря, и есть сама прошивка, а точнее образ раздела system, содержащий операционную систему Android за вычетом ядра;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">system.transfer.list</span><span style=" font-size:18px;"> — содержит список команд, которые необходимо выполнить, чтобы поблочно скопировать содержимое system.new.dat в раздел system при установке прошивки;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">system.patch.dat</span><span style=" font-size:18px;"> — используется для OTA-обновлений, то есть выборочного внесения изменений в прошивку; если прошивка «полная», он имеет нулевой размер.</span><img src="image16370738126a2opxijb2.png" /><span style=" font-size:14px; font-style:italic; color:#444444; background-color:#ffffff;">Содержимое ZIP-файла прошивки LineageOS для Nexus 5<br /></span></li></ul>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px; font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; font-size:14px; font-style:italic; color:#444444;"><br /></p>
<p style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><img src="image16370739521ty9pcmzac.png" /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:1; text-indent:0px;"><br /></p>
<h3 style=" margin-top:0px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:109.091%;"><a href="https://xakep.ru/issues/xb/005"><span style=" font-family:'Roboto'; font-size:large; font-weight:696; text-decoration: underline; color:#111111;">Реверс малвари</span></a></h3>
<ul type="square" style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:10px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:23.4px;"><a href="https://xakep.ru/issues/xb/005"><span style=" font-size:18px; text-decoration: underline; color:#dd2200;">Содержание выпуска</span></a></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:23.4px;"><a href="https://xakep.ru/about"><span style=" font-size:18px; text-decoration: underline; color:#dd2200;">Подписка на «Хакер»</span></a></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="toc02."></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;"> </span></p>
<h2 style=" margin-top:36px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:100%; background-color:#ffffff;"><span style=" font-family:'Roboto'; font-size:x-large; font-weight:696; color:#111111; background-color:#ffffff;">Распаковываем system.new.dat</span></h2>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Файлы</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">system.new.dat</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> и </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">system.transfer.list</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> представляют для нас наибольший интерес. Точнее, не они, а содержащаяся в них система. Но добраться до нее не так просто.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#000000; background-color:#ffffff;"> </span><span style=" font-family:'Roboto'; font-size:large; font-weight:696; color:#111111; background-color:#ffffff;">Скрипт</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Самые ленивые могут разобрать прошивку с помощью скрипта</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><a href="https://github.com/matriex/System_Extractor-Linux"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; text-decoration: underline; color:#dd2200;">System_Extractor-Linux</span></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">.</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:16px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Распаковываем архив с прошивкой в любую папку.</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Качаем скрипт </span><a href="https://github.com/matriex/System_Extractor-Linux/archive/master.zip"><span style=" font-size:18px; text-decoration: underline; color:#dd2200;">по ссылке</span></a><span style=" font-size:18px;"> и разархивируем в любую папку.</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Запускаем файл </span><span style=" font-family:'Courier New,Courier,monospace'; font-size:18px;">ext</span><span style=" font-size:18px;"> (если будет ругаться на отсутствие Java, просто пропусти, нажав </span><span style=" font-family:'Courier New,Courier,monospace'; font-size:18px;">y</span><span style=" font-size:18px;">; Java нужна только для запаковки).</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Теперь выбираем распаковку, нажав кнопку 1, а затем Enter.</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Новая папка с именем </span><span style=" font-family:'Courier New,Courier,monospace'; font-size:18px;">extract_*</span><span style=" font-size:18px;"> появится рядом с файлом </span><span style=" font-family:'Courier New,Courier,monospace'; font-size:18px;">ext</span><span style=" font-size:18px;"> и папкой </span><span style=" font-family:'Courier New,Courier,monospace'; font-size:18px;">tools</span><span style=" font-size:18px;">. Копируем в нее файлы </span><span style=" font-family:'Courier New,Courier,monospace'; font-size:18px;">system.new.dat</span><span style=" font-size:18px;"> и </span><span style=" font-family:'Courier New,Courier,monospace'; font-size:18px;">system.transfer.list</span><span style=" font-size:18px;">.</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">После копирования файлов нажимаем Enter и ждем. Через некоторое время нужно будет опять нажать Enter, ввести пароль администратора и еще раз тапнуть Enter.</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Готово. Содержимое system в папке </span><span style=" font-family:'Courier New,Courier,monospace'; font-size:18px;">extract_*/output</span><span style=" font-size:18px;">.</span></li></ol>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; font-size:18px; color:#222222;"><br /></p>
<p align="center" style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1637074017bd0wob6gqx.png" /></p>
<p align="center" style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; font-size:14px; font-style:italic; color:#444444; background-color:#ffffff;">Скрипт для распаковки system.new.dat в Linux<br /></span><a name="toc02.2"></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;"> </span></p>
<h3 style=" margin-top:36px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:109.091%; background-color:#ffffff;"><span style=" font-family:'Roboto'; font-size:large; font-weight:696; color:#111111; background-color:#ffffff;">Ручной способ</span></h3>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Распаковываем архив с прошивкой в любую папку (например, в</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">rom</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">):</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ mkdir </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">~</span><span style=" font-family:'Courier New,Courier,monospace'; color:#008800;">/rom</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#008800;">$ unzip путь_до_архива -d ~/</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">rom</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">/</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Скачиваем нужные нам инструменты в эту папку:</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ cd </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">~</span><span style=" font-family:'Courier New,Courier,monospace'; color:#008800;">/rom</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#008800;">$ wget https:/</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">/</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">github</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">com</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">/</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">xpirt</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">/</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">sdat2img</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">/</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">raw</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">/</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">master</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">/</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">sdat2img</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">py</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Запускаем скрипт:</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ chmod </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">+</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">x sdat2img</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">py</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">./</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">sdat2img</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">py system</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">transfer</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">list system</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000088;">new</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">dat system</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">img</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Он преобразует файл</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">system.new.dat</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> в raw-образ с именем </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">system.img</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">. Монтируем образ к подпапке </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">mnt</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">:</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ mkdir mnt</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ sudo mount </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">-</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">t ext4 </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">-</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">o loop system</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">img </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">~</span><span style=" font-family:'Courier New,Courier,monospace'; color:#008800;">/rom/</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">mnt</span><img src="image16370738121zy1vx69jx.png" /><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; font-style:italic; color:#444444; background-color:#ffffff;">Содержимое образа system<br /></span></p>
<p align="center" style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><br /></p>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#000000; background-color:#ffffff;"> </span><img src="image1637074192b9qlkyznec.png" /></p>
<p align="center" style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><br /></p>
<h2 style=" margin-top:36px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:100%; background-color:#ffffff;"><span style=" font-family:'Roboto'; font-size:x-large; font-weight:696; color:#111111; background-color:#ffffff;">Структура каталогов Android</span></h2>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">После распаковки system появится следующая каталоговая структура:</span></p>
<ul type="square" style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:16px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">app</span><span style=" font-size:18px;"> — предустановленные приложения со стандартными привилегиями;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">priv-app</span><span style=" font-size:18px;"> — предустановленные приложения с повышенными привилегиями, в том числе некоторые компоненты системы;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">bin</span><span style=" font-size:18px;"> — бинарные файлы формата ELF, аналог каталогов </span><span style=" font-family:'Courier New,Courier,monospace'; font-size:18px;">/bin</span><span style=" font-size:18px;"> и </span><span style=" font-family:'Courier New,Courier,monospace'; font-size:18px;">/usr/bin</span><span style=" font-size:18px;"> в Linux. Содержит различные системные компоненты, используемые более высокоуровневыми компонентами системы;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">etc</span><span style=" font-size:18px;"> — файлы настроек. Полный аналог </span><span style=" font-family:'Courier New,Courier,monospace'; font-size:18px;">/etc</span><span style=" font-size:18px;"> в Linux, используемый, однако, только теми самыми системными компонентами. Приложения Android хранят индивидуальные настройки в каталогах </span><span style=" font-family:'Courier New,Courier,monospace'; font-size:18px;">/data/data/</span><span style=" font-size:18px;">;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">fonts</span><span style=" font-size:18px;"> — шрифты. По умолчанию содержит только фирменные шрифты Roboto;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">framework</span><span style=" font-size:18px;"> — библиотеки Java-классов, используемых системой и приложениями. Тут же лежит файл </span><span style=" font-family:'Courier New,Courier,monospace'; font-size:18px;">framework-res.apk</span><span style=" font-size:18px;">, содержащий полное описание интерфейса операционной системы, включая все графические файлы;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">lib</span><span style=" font-size:18px;"> и </span><span style=" font-size:18px; font-weight:696;">lib64</span><span style=" font-size:18px;"> — Linux-библиотеки, используемые низкоуровневыми компонентами системы. Аналог каталогов </span><span style=" font-family:'Courier New,Courier,monospace'; font-size:18px;">/lib</span><span style=" font-size:18px;"> и </span><span style=" font-family:'Courier New,Courier,monospace'; font-size:18px;">/usr/lib</span><span style=" font-size:18px;"> в Linux, включая такие стандартные библиотеки, как libc, libz, libssl. На устройствах с архитектурой ARMv7 и ниже каталог lib64 будет отсутствовать;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">media</span><span style=" font-size:18px;"> — медиафайлы: рингтоны, звуки уведомлений, звуки интерфейса и анимация загрузки ОС;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">tts</span><span style=" font-size:18px;"> — файлы, необходимые синтезатору речи;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">usr</span><span style=" font-size:18px;"> — каталог, который обычно содержит файлы, необходимые для работы приложений из каталога bin. По сути, аналог </span><span style=" font-family:'Courier New,Courier,monospace'; font-size:18px;">/usr/share</span><span style=" font-size:18px;">;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">vendor</span><span style=" font-size:18px;"> — файлы, поставляемые производителем устройства. Обычно содержит бинарный firmware для различных железных компонентов, например модуля Wi-Fi;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">xbin</span><span style=" font-size:18px;"> — необязательный каталог; кастомные прошивки используют его для хранения таких вещей, как интерпретатор bash, SSH, PowerTOP, BusyBox, и других полезных инструментов;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">build.prop</span><span style=" font-size:18px;"> — файл, содержащий информацию о сборке, а также различные низкоуровневые настройки;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">addon.d</span><span style=" font-size:18px;"> — содержит скрипты, запускаемые после установки прошивки. Сюда же GApps прописывают свой скрипт, благодаря которому возрождаются после переустановки прошивки.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Ознакомившись с базовой структурой Android, начнем вносить изменения.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="toc04."></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;"> </span></p>
<h2 style=" margin-top:36px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:100%; background-color:#ffffff;"><span style=" font-family:'Roboto'; font-size:x-large; font-weight:696; color:#111111; background-color:#ffffff;">Удаляем и добавляем приложения</span></h2>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Все предустановленные программы можно найти в двух папках:</span></p>
<ul type="square" style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:16px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">/system/app/;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">/system/priv-app/.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Друг от друга они отличаются привилегиями доступа. Если программы из</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">app</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> имеют такие же полномочия, как сторонние программы (например, установленные из Play Store), то приложения из </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">priv-app</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> могут использовать привилегированные API (права privileged). Подробнее об этом можно узнать из </span><a href="https://xakep.ru/2016/04/20/android-api/"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; text-decoration: underline; color:#dd2200;">нашей статьи</span></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">.</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Для предустановки приложения в прошивку просто кинь ее APK-файл в</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">/system/app/</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">. Можно, конечно, создать отдельную папку, но в нашем случае в этом нет смысла, потому что папка служит для хранения библиотек и odex-файлов, которых у нас попросту нет. Для удаления просто удали папку с ним.</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Можно пойти дальше и поменять стоковые приложения на аналоги. К примеру, для замены календаря удаляем папку</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; font-style:italic; color:#222222;">Calendar</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> и копируем в </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">/system/app</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> наш любимый </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">com.rpagyc.simplecalendar.apk</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">. А можно и не копировать. Тогда прошивка будет без календаря.</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Главное, помни: стоковые программы могут быть связаны между собой. Поэтому удаление одной проги вполне может привести к полной неработоспособности другой (к примеру, CalendarProvider и Calendar: удалив первый, ты сделаешь неработоспособным не только стоковый, но и любой другой календарь). К счастью, в чистых AOSP-прошивках взаимосвязей не так много.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="toc05."></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;"> </span></p>
<h2 style=" margin-top:36px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:100%; background-color:#ffffff;"><span style=" font-family:'Roboto'; font-size:x-large; font-weight:696; color:#111111; background-color:#ffffff;">Меняем анимацию загрузки</span></h2>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Анимация хранится в виде PNG-картинок, упакованных в архив</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">/system/media/bootanimation.zip</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> без сжатия. Внутри архива находятся:</span></p>
<ul type="square" style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:16px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">desc.txt</span><span style=" font-size:18px;"> — файл, описывающий анимацию;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">part0</span><span style=" font-size:18px;"> — папка с файлами анимаций, которые воспроизводятся первыми;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">part1</span><span style=" font-size:18px;"> — папка с файлами анимаций, которые воспроизводятся вторыми;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">...</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">part?</span><span style=" font-size:18px;"> — крайняя папка, изображения с которой воспроизводятся в конце.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Файл</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">desc.txt</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> может содержать нечто вроде</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#006666;">1920</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#006666;">1080</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#006666;">60</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">p </span><span style=" font-family:'Courier New,Courier,monospace'; color:#006666;">1</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#006666;">0</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;"> part0</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">p </span><span style=" font-family:'Courier New,Courier,monospace'; color:#006666;">0</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#006666;">0</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;"> part1</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Назначение этих строк интуитивно понятно: 1920 × 1080 — разрешение картинки, 60 — число кадров в секунду. Part0 и part1 указывают на папки, из которых будет воспроизводиться анимация, и последовательность воспроизведения. Вообще, может быть как одна часть, так и несколько (три и больше).</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Изображения, находящиеся в папках part, пронумерованы пятью цифрами в порядке воспроизведения:</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">00000.png</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">, </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">00001.png</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">, </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">00002.png</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">... Эти изображения можно поменять на свои, тем самым создав оригинальную анимацию. А можно просто удалить файл </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">bootanimation.zip</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">. Тогда девайс будет показывать анимацию из стандартного Android. Или воспользоваться </span><a href="https://4pda.ru/forum/index.php?showtopic=170907"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; text-decoration: underline; color:#dd2200;">уже готовой коллекцией анимаций на 4PDA</span></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;"><br /></p>
<p align="center" style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><img src="image1637074245hqkvyyqs36.png" /></p>
<p align="center" style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; font-style:italic; color:#444444; background-color:#ffffff;">Четыре части в bootanimation.zip для LineageOS<br /></span><a name="toc06."></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;"> </span></p>
<h2 style=" margin-top:36px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:100%; background-color:#ffffff;"><span style=" font-family:'Roboto'; font-size:x-large; font-weight:696; color:#111111; background-color:#ffffff;">Изменяем звуковое оформление</span></h2>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Фактически все звуки, которые воспроизводит система, хранятся в папке</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">/system/media/audio</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">. Внутри нее ты найдешь следующие папки:</span></p>
<ul type="square" style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:16px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">alarms</span><span style=" font-size:18px;"> — мелодии будильника;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">notifications</span><span style=" font-size:18px;"> — звуки уведомлений;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">ringtones</span><span style=" font-size:18px;"> — мелодии звонка;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">ui</span><span style=" font-size:18px;"> — системные звуки, например низкий заряд батареи, фокусировка камеры, выбор элементов интерфейса.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">В alarms, notifications, ringtones можно накидать сколько угодно любых мелодий. Взять их можно, например, здесь:</span></p>
<ul type="square" style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:16px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://forum.allnokia.ru/viewtopic.php?t=27216"><span style=" font-size:18px; text-decoration: underline; color:#dd2200;">стандартные мелодии из разных телефонов и смартфонов Nokia</span></a><span style=" font-size:18px;">;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://4pda.ru/forum/index.php?showtopic=273921"><span style=" font-size:18px; text-decoration: underline; color:#dd2200;">знаменитые стандартные рингтоны</span></a><span style=" font-size:18px;">;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="https://4pda.ru/forum/index.php?showtopic=501"><span style=" font-size:18px; text-decoration: underline; color:#dd2200;">просто множество рингтонов</span></a><span style=" font-size:18px;">;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://forum.allsiemens.com/viewtopic.php?t=24783"><span style=" font-size:18px; text-decoration: underline; color:#dd2200;">мелодии с разных телефонов</span></a><span style=" font-size:18px;">.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">И маленький лайфхак: удаление файлов из папки</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">ui</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> приведет не к сбоям и ошибкам, а к исчезновению системных звуков. Поэтому ты можешь легко отключить звук создания снимка с камеры, снятия скриншота, просто потерев содержащие эти звуки файлы (их имена интуитивно понятны).</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="toc07."></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;"> </span></p>
<h2 style=" margin-top:36px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:100%; background-color:#ffffff;"><span style=" font-family:'Roboto'; font-size:x-large; font-weight:696; color:#111111; background-color:#ffffff;">Добавляем шрифты</span></h2>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Шрифты хранятся в</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">fonts</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">. Найти архивы с файлами шрифтов можно на </span><a href="https://4pda.ru/forum/index.php?s=&amp;showtopic=161587&amp;view=findpost&amp;p=4647418"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; text-decoration: underline; color:#dd2200;">4PDA</span></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> и </span><a href="https://forum.xda-developers.com/android/themes/fonts-flashable-zips-t3219827"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; text-decoration: underline; color:#dd2200;">XDA</span></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">. Для установки достаточно скопировать с заменой ttf-файлы из архива в папку </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">fonts</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="toc08."></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;"> </span></p>
<h2 style=" margin-top:36px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:100%; background-color:#ffffff;"><span style=" font-family:'Roboto'; font-size:x-large; font-weight:696; color:#111111; background-color:#ffffff;">Меняем системные настройки (build.prop)</span></h2>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">В образе system есть интересный файлик</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">build.prop</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">, содержащий множество полезной информации о железе устройства и настройках, устанавливаемых по умолчанию, для различных стоковых приложений. Справедливости ради замечу, что это не всегда так. Например, в Gigaset ME и ME Pro </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">build.prop</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> разделен на две части. В одной части содержатся настройки для Gigaset ME, а для ME Pro некоторые строки продублированы, но ключи (название смартфона и так далее) в них другие. Это было сделано, чтобы обеспечить более-менее корректную работоспособность одной и той же прошивки на разных аппаратах.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;"><br /></p>
<p align="center" style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><img src="image16370743018c68q20nn3.png" /></p>
<p align="center" style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; font-style:italic; color:#444444; background-color:#ffffff;">Дополнительный файл для Gigaset ME и ME Pro<br /></span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Build.prop содержит (или может содержать) огромное количество настроек. Некоторые из них ничего не меняют, некоторые улучшают одно за счет ухудшения другого, но есть те, которые действительно полезны:</span></p>
<ul type="square" style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:16px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">ro.product.model</span><span style=" font-size:18px;"> и </span><span style=" font-size:18px; font-weight:696;">ro.product.manufacturer</span><span style=" font-size:18px;"> — модель смартфона и имя производителя. С помощью замены этих строк можно заставить Play Store думать, будто у тебя другой смартфон, что откроет доступ к большему количеству софта. Для всяких малоизвестных китайских смартфонов эти строчки могут стать спасительными;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">hw.qemu.mainkeys</span><span style=" font-size:18px;"> — принимает только два значения: 0 — показать наэкранные клавиши навигации, 1 — не показывать кнопки. Отсутствие строки соответствует 0;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">debug.sf.nobootanimation</span><span style=" font-size:18px;"> — значение 1 отключает анимацию загрузки, что немного поднимает ее скорость. Установка 0 или удаление строки возвращает анимацию на место;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">ro.telephony.default_network</span><span style=" font-size:18px;"> — говорит системе, в какой режим должна быть переключена мобильная сеть при загрузке;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">ro.sf.lcd_density</span><span style=" font-size:18px;"> — DPI дисплея, наиболее точное значение для дисплея можно посчитать через </span><a href="https://www.sven.de/dpi/"><span style=" font-size:18px; text-decoration: underline; color:#dd2200;">удобный сайт</span></a><span style=" font-size:18px;">. Но никто не запрещает поставить и большее или меньшее значение по своему вкусу: более высокие значения делают элементы интерфейса крупнее, низкие — меньше;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">ro.config.vc_call_vol_steps</span><span style=" font-size:18px;"> — количество шагов громкости во время разговора (по умолчанию 8);</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">ro.config.media_vol_steps</span><span style=" font-size:18px;"> — количество шагов громкости мультимедиа (по умолчанию 15).</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="toc09."></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;"> </span></p>
<h2 style=" margin-top:36px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:100%; background-color:#ffffff;"><span style=" font-family:'Roboto'; font-size:x-large; font-weight:696; color:#111111; background-color:#ffffff;">Внедряем в прошивку Google Apps</span></h2>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Почти всегда кастомные прошивки поставляются без сервисов Google и магазина приложений. Разработчики предлагают нам установить их отдельно с помощью пакета GApps. Однако его можно интегрировать прямо в прошивку.</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Для начала необходимо скачать пакет GApps. Я рекомендую брать архивы</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><a href="http://opengapps.org/"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; text-decoration: underline; color:#dd2200;">Open GApps</span></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">. Выбираешь версию Android, архитектуру процессора и вариант комплектации (Pico, Nano, Stock...), который определяет, сколько различных приложений Google содержит архив. Я рекомендую скачать версию Pico. Она содержит только Play Store и набор необходимых для его работы библиотек.</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Интеграция GApps в прошивку выполняется так:</span></p>
<ol style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:16px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Распаковываем ZIP-архив GApps с помощью любого архиватора.</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Переходим в папку Core.</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Видим множество архивов с расширением </span><span style=" font-family:'Courier New,Courier,monospace'; font-size:18px;">.tar.lz</span><span style=" font-size:18px;">. Извлекаем с помощью lzip.</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">После распаковки копируем файлы из папок в соответствующие папки в system. Что куда кидать, нетрудно догадаться по структуре каталогов в архиве. Например, configupdater (со скриншота) нужно кидать в папку </span><span style=" font-family:'Courier New,Courier,monospace'; font-size:18px;">priv-app</span><span style=" font-size:18px;">.</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Переходим в папку GApps (находится рядом с Core) и проделываем пункты 3 и 4 для файлов в ней.</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">Все, мы интегрировали GApps в нашу прошивку!</span></li></ol>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; font-size:18px; color:#222222;"><br /></p>
<p align="center" style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1637074353ywcsa7lwe8.png" /></p>
<p align="center" style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; font-size:14px; font-style:italic; color:#444444; background-color:#ffffff;">Структура каталогов configupdater-all.tar.lz<br /></span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="toc10."></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;"> </span></p>
<h2 style=" margin-top:36px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:100%; background-color:#ffffff;"><span style=" font-family:'Roboto'; font-size:x-large; font-weight:696; color:#111111; background-color:#ffffff;">Свободное место</span></h2>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Необходимо понимать, что место для установки прошивок ограниченно. Нельзя установить прошивку, размер которой перевешивает размер раздела</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">system</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> устройства. Посмотреть его значение можно, используя </span><a href="https://xakep.ru/2016/05/12/android-adb/"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; text-decoration: underline; color:#dd2200;">ADB</span></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">:</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ adb shell df </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">/</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">system</span><img src="image163707381250iep811rp.png" /><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; font-style:italic; color:#444444; background-color:#ffffff;">Инфа о разделе system<br /></span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Второй вариант: поставить на устройство</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><a href="https://play.google.com/store/apps/details?id=jackpal.androidterm"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; text-decoration: underline; color:#dd2200;">терминал</span></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> и набрать команду</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ df </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">/</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">system</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Размер раздела в байтах можно узнать, установив на смартфон</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><a href="https://play.google.com/store/apps/details?id=stericson.busybox"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; text-decoration: underline; color:#dd2200;">BusyBox</span></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> и выполнив в терминале команду</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ busybox df </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">-</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">B </span><span style=" font-family:'Courier New,Courier,monospace'; color:#006666;">1</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">/</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">system</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Или то же самое с помощью ADB:</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ adb shell busybox df </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">-</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">B </span><span style=" font-family:'Courier New,Courier,monospace'; color:#006666;">1</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">/</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">system</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Место, занимаемое прошивкой, будет приблизительно равно размеру system в распакованном виде. Вообще, при создании прошивки необходимо учитывать, что юзер также может прошить поверх нее различные модификации (SuperSU, Xposed) или перенести приложения в раздел system. Например, минимальный пакет приложений Google (Pico) требует минимум 150 Мбайт дополнительного пространства для установки.</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">При необходимости размер файла прошивки можно уменьшить, удалив не только ненужные программы из</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">/system/app</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> (</span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">/system/priv-app</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">) и звуки вызова из </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">system/media/audio</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> и </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">bootanimation.zip</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">, но и:</span></p>
<ul type="square" style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:16px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">/system/tts/lang_pico</span><span style=" font-size:18px;"> — языки примитивного голосового движка Pico TTS, голосовой движок Google это не затронет;</span></li>
<li style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;" style=" margin-top:0px; margin-bottom:16px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px; font-weight:696;">/system/usr/srec/config/</span><span style=" font-size:18px;"> — офлайн-языки. Можно будет скачать потом онлайн, если понадобится.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="toc11."></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;"> </span></p>
<h2 style=" margin-top:36px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:100%; background-color:#ffffff;"><span style=" font-family:'Roboto'; font-size:x-large; font-weight:696; color:#111111; background-color:#ffffff;">Сборка</span></h2>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">После внесения изменений нужно собрать все обратно. Сначала запакуем раздел</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">system</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> в </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">system.new.dat</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">. Скачиваем нужные нам инструменты:</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ wget https</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">:</span><span style=" font-family:'Courier New,Courier,monospace'; color:#880000;">//github.com/xpirt/img2sdat/raw/master/img2sdat.py</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ wget https</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">:</span><span style=" font-family:'Courier New,Courier,monospace'; color:#880000;">//github.com/xpirt/img2sdat/raw/master/blockimgdiff.py</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ wget https</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">:</span><span style=" font-family:'Courier New,Courier,monospace'; color:#880000;">//github.com/xpirt/img2sdat/raw/master/common.py</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ wget https</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">:</span><span style=" font-family:'Courier New,Courier,monospace'; color:#880000;">//github.com/xpirt/img2sdat/raw/master/rangelib.py</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ wget https</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">:</span><span style=" font-family:'Courier New,Courier,monospace'; color:#880000;">//github.com/xpirt/img2sdat/raw/master/sparse_img.py</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ sudo apt</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">-</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000088;">get</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;"> install android</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">-</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">tools</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">-</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">fsutils</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Преобразовываем нашу папку обратно в RAW-образ. Назовем его</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">system_new.img</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">:</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ sudo make_ext4fs </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">-</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">T </span><span style=" font-family:'Courier New,Courier,monospace'; color:#006666;">0</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">-</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">S file_contexts </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">-</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">l </span><span style=" font-family:'Courier New,Courier,monospace'; color:#006666;">1073741824</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">-</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">a system system_new</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">img output</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">/</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">1073741824</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> меняем на размер раздела </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">system</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> в байтах. Желательно даже сделать его чуть меньше. Делаем из RAW-образа sparse-образ:</span></p>
<p style=" margin-top:15px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ img2simg system_new</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">img system_snew</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">img</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Преобразуем наш образ в</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">system.transfer.list</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> и </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">system.new.dat</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">, которые и нужно кидать в архив с прошивкой, но сначала удалим старые файлы:</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ rm </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">-</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">rf system</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">transfer</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">list</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ rm </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">-</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">rf system</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000088;">new</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">dat</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ rm </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">-</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">rf system</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">patch</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">dat</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ chmod </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">+</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">x img2sdat</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">py</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">./</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">img2sdat</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">py system_snew</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">img</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Отделим файлы прошивки от лишней шелухи (файлов, которые мы загружали для работы. Для этого удобно пользоваться архивом с прошивкой). Удалили? Теперь нужно запаковать прошивку в ZIP-архив (любым архиватором).</span></p>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Осталось подписать архив. Сделать это можно как на самом Android с помощью</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span><a href="https://play.google.com/store/apps/details?id=kellinwood.zipsigner2"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; text-decoration: underline; color:#dd2200;">ZipSigner</span></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">, так и на ПК (потребуется установленная Java):</span></p>
<p style=" margin-top:15px; margin-bottom:0px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ wget https</span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">:</span><span style=" font-family:'Courier New,Courier,monospace'; color:#880000;">//github.com/appium/sign/raw/master/dist/sign.jar</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:36px; margin-right:36px; -qt-block-indent:0; text-indent:0px; line-height:160%; background-color:#f5f5f5;"><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">$ java </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">-</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">jar </span><span style=" font-family:'Courier New,Courier,monospace'; color:#666600;">файл.</span><span style=" font-family:'Courier New,Courier,monospace'; color:#000000;">zip</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#eeeeee;"><a name="toc11.1"></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> </span></p>
<h3 style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:109.091%;"><span style=" font-family:'Roboto'; font-size:large; font-weight:696; color:#111111;">Подводные камни</span></h3>
<p style=" margin-top:0px; margin-bottom:5px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;">Во время сборки </span><span style=" font-family:'Courier New,Courier,monospace'; color:#222222;">system.new.dat</span><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222;"> ты можешь столкнуться с несколькими проблемами, вызванными постоянными изменениями в механизмах формирования прошивок Android. Описанный выше способ должен хорошо сработать в случае основанной на Android 5.1 прошивки, в более новых могут возникнуть сложности, так что потребуется использовать другие версии инструментов сборки. К сожалению, мы не можем описать все нюансы сборки, поэтому, возможно, придется погуглить.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><a name="toc12."></a><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;"> </span></p>
<h2 style=" margin-top:36px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:100%; background-color:#ffffff;"><span style=" font-family:'Roboto'; font-size:x-large; font-weight:696; color:#111111; background-color:#ffffff;">Установка</span></h2>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Для установки кастомной прошивки необходим кастомный рекавери TWRP, позволяющий устанавливать неподписанные или подписанные тестовым ключом прошивки (именно такую мы создали). В журнале мы неоднократно описывали процесс его установки, да и в ветках форума, посвященных твоему устройству, обычно есть достаточно информации для того, чтобы это сделать.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;"><br /></p>
<p align="center" style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><img src="image1637074418s520b99kdy.png" /></p>
<p align="center" style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; font-style:italic; color:#444444; background-color:#ffffff;">TWRP<br /></span></p>
<h2 style=" margin-top:36px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:100%; background-color:#ffffff;"><span style=" font-family:'Roboto'; font-size:x-large; font-weight:696; color:#111111; background-color:#ffffff;">Выводы</span></h2>
<p style=" margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; background-color:#ffffff;"><span style=" font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;">Эта статья описывает лишь верхушку огромного айсберга под названием «модификация прошивок». «Серьезные» прошивки не только дополняют ядро и саму прошивку со стоковыми приложениями множеством функций (которые зачастую вырваны из других ядер и прошивок), организовывая или даже меняя принципы их взаимодействия, но и вполне могут кардинально менять принципы работы ОС. Правда, такая поделка — это уже не Android, а отдельная ОС, даже если Play-сервисы получится туда поставить (кстати, такие действия, мягко говоря, не поощряются Google). Ну и не забываем: все оболочки от производителей — TouchWiz, ZenUI, HTC Sense и так далее — всего лишь обычные кастомы, максимально привязанные к железу устройства и друг к другу.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:26px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:26px; font-family:'HelveticaNeue,Helvetica Neue,Helvetica,Arial,Lucida Grande,sans-serif'; color:#222222; background-color:#ffffff;"><br /></p></body></html>