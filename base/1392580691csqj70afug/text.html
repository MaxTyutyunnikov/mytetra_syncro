<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Оглавление</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:large; font-weight:600;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Введение в программирование модель/представление</span></li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Архитектура модель/представление</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модели</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Представления</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Делегаты</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сортировка</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вспомогательные классы</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование моделей и представлений</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Две модели, включённые в состав Qt</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование представлений с существующей моделью</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Классы моделей</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Основные концепции</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модельные индексы</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Строки и столбцы</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Родители элементов</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Роли элемента</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Резюме</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование модельных индексов</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Дополнительные материалы</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Классы представлений</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Концепции</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование существующего представления</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование модели</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование множества представлений с одной моделью</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обработка выбора элементов</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Разделение выбора между представлениями</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Классы делегатов</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Концепции</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование существующих делегатов</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Простой делегат</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Предоставление редактора</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Запись данных в модель</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обновление геометрии редактора</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Редактирование подсказок</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обработка выбора элементов в представлениях</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Концепции</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Текущий элемент и выделенные элементы</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование модели выбора</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выбор элементов</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтение состояния выбора</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обновление выбора</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выбор всех элементов в модели</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Создание новых моделей</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Разработка модели</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пример модели только-для-чтения</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Измерения модели</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Заголовки и данные модели</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Редактируемая модель</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Создание редактируемой модели</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вставка и удаление строк</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Следующие шаги</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вспомогательные классы представления элементов</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Виджеты-cписки</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Виджеты-деревья</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Виджеты-таблицы</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Общие возможности</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Скрытые элементы</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выделения</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Поиск</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование перетаскивания (Drag and Drop) с представлениями элементов</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование вспомогательных представлений</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование классов модель/представление</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Разрешение применения перетаскивания к элементам</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Кодирование экспортируемых данных</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вставка отпускаемых данных в модель</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Декодирование импортируемых данных</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модели-посредники</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование моделей-посредников</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Настройка моделей-посредников</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пользовательские модели фильтрации</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пользовательские модели сортировки</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Создание собственных моделей</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обработка элементов данных</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Доступ только для чтения</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Редактируемые элементы</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Изменение размеров моделей</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ленивое заполнение (Lazy Population) модели данных</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Навигация и создание индекса модели</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Родители и дети</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Поддержка перетаскивания (Drag and Drop) и обработка MIME-типов</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">MIME данные</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Получение отпускаемых данных</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вспомогательные представления</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Оптимизация производительности для больших объемов данных</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Классы модель/представление</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Связанные примеры</li></ul>
<p style=" margin-top:18px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:xx-large; font-weight:600;">Программирование модель/представление</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; font-weight:600;">Введение в программирование модель/представление</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В Qt 4 введен новый набор классов для просмотра элементов использующих архитектуру модель/представление для управления взаимосвязью между данными и методом их представления пользователю. Разделение функциональности, введенное в этой архитектуре, дает разработчикам большую гибкость в настройке отображения элементов и предоставляет стандартный интерфейс модели, позволяющий широкому диапазону источников данных использовать существующие представления элементов. В этом документе мы дадим краткое описание парадигмы модель/представление, выделим концепции и опишем архитектуру системы представления элементов. Каждый компонент данной архитектуры будет описан и будут предоставлены примеры, показывающие как использовать предоставленные классы. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Архитектура модель/представление</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Архитектура модель-представление-контроллер (Model-View-Controller, MVC) является шаблоном проектирования, берущим начало от Smalltalk, который часто используется для создания пользовательских интерфейсов. <span style=" color:#000000;">В книге &quot;Design Patterns&quot; Гам</span>мы (Gamma) и других написано:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:40px; -qt-block-indent:0; text-indent:0px;">MVC состоит из трех типов объектов. Модель - объект приложения, представление - его экранное представление и контроллер - определяет реакцию пользовательского интерфейса на пользовательский ввод. До MVC при разработке пользовательского интерфейса эти объекты смешивались вместе. MVC разделяет их, для увеличения гибкости и возможности повторного использования.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если объединить объекты представления и контроллера, то в результате получится архитектура модель/представление. Это все еще отделяет способ хранения данных от способа их представления пользователю, но обеспечивает простую структуру, основанную на тех же принципах. Данное разделение дает возможность показать пользователю одни и те же данных в различных представлениях и реализовать новые типы представлений без изменения базовой структуры данных. Чтобы обеспечить гибкость управления пользовательским вводом, мы представляем концепцию <span style=" font-style:italic;">делегата</span> (delegate). Преимущество наличия делегата в этой структуре состоит в том, что это дает возможность для настройки представления и редактирования элементов данных.</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image2128904289.png" style="vertical-align: top;" /> </p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Архитектура модель/представление</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модель осуществляет соединение с источником данных, предоставляя необходимый <span style=" font-style:italic;">интерфейс</span> другим компонентам архитектуры. Характер связи зависит от типа источника данных и способа реализации модели.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Из модели представление получает <span style=" font-style:italic;">модельные индексы</span>, являющиеся ссылками на элементы данных. Передавая модельные индексы модели, представление может получить элементы данных из источника данных.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В стандартных представлениях <span style=" font-style:italic;">делегат</span> отображает элементы данных. Если элемент редактируемый, делегат связывается с моделью непосредственно используя модельные индексы.</p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Как правило, классы модель/представление могут быть разделены на три описанные выше группы: модели, представления и делегаты. Каждый из этих компонентов описывается <span style=" font-style:italic;">абстрактным</span> классом, предоставляющим общий интерфейс и, в некоторых случаях, особенности реализации по умолчанию. Абстрактные классы подразумевают наследование от них в порядке, предоставляющем полный набор функциональности, ожидаемой другими компонентами; это позволяет также писать специализированные компоненты.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модели, представления и делегаты взаимодействуют друг с другом используя <span style=" font-style:italic;">сигналы и слоты</span>:</p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сигналы от модели информируют представление об изменениях данных в источнике данных.</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сигналы от представления предоставляют информацию о пользовательском взаимодействии с отображаемыми элементами.</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сигналы от делегата используются во время редактирования, сообщают модели и представлению о состоянии редактора. </li></ul>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Модели</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Все модели элементов основаны на классе <span style=" font-family:'Courier New'; color:#6a0e07;">QAbstractItemModel</span>. Этот класс определяет интерфейс, используемый представлениями и делегатами для доступа к данным. Сами данные не должны храниться в модели; они могут храниться в структуре данных или хранилище, предоставляемом отдельным классом, файле, базе данных или каком-либо другом прикладном компоненте.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Базовые концепции моделей описаны в разделе <span style=" color:#000000;">&quot;Классы моделей&quot;</span>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">QAbstractItemModel</span> обеспечивает достаточно гибкий интерфейс к данным для обработки представлений, которые представляют данные в виде таблиц, списков и деревьев. Однако, при реализации новых моделей в виде структур списков и таблиц, классы <span style=" font-family:'Courier New'; color:#6a0e07;">QAbstractListModel</span> и <span style=" font-family:'Courier New'; color:#6a0e07;">QAbstractTableModel</span> послужат лучшей отправной точкой, так как они предоставляют реализации соответствующих функций по умолчанию. На основе каждого из этих классов можно создать подклассы для предоставления моделей, поддерживающих специфичные виды списков и таблиц.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Процесс создания подклассов моделей обсуждается в разделе <span style=" color:#000000;">&quot;Создание новых моделей&quot;</span>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Qt предоставляет несколько готовых моделей, которые могут использоваться для обработки элементов данных:</p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">QStringListModel</span> используется для хранения простого списка элементов <span style=" font-family:'Courier New'; color:#6a0e07;">QString</span>.</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">QStandardItemModel</span> управляет более сложными древовидными структурами элементов, каждый из которых может содержать произвольные данные.</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">QFileSystemModel</span> предоставляет информацию о файлах и директориях локальной файловой системы.</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">QSqlQueryModel</span>, <span style=" font-family:'Courier New'; color:#6a0e07;">QSqlTableModel</span> и <span style=" font-family:'Courier New'; color:#6a0e07;">QSqlRelationalTableModel</span> используются для доступа к базам данных, учитывающим соглашения архитектуры модель/представление.</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если эти стандартные модели не отвечают вашим требованиям, то для создания своих собственных моделей вы можете создать подкласс <span style=" font-family:'Courier New'; color:#6a0e07;">QAbstractItemModel</span>, <span style=" font-family:'Courier New'; color:#6a0e07;">QAbstractListModel</span> или <span style=" font-family:'Courier New'; color:#6a0e07;">QAbstractTableModel</span>. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Представления</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Предоставляются полные реализации для различных видов представлений: <span style=" font-family:'Courier New'; color:#6a0e07;">QListView</span> отображает список элементов, <span style=" font-family:'Courier New'; color:#6a0e07;">QTableView</span> отображает данные модели в виде таблицы, а <span style=" font-family:'Courier New'; color:#6a0e07;">QTreeView</span> отображает элементы модели в виде иерархического списка. Каждый из этих классов основан на базовом абстрактном классе <span style=" font-family:'Courier New'; color:#6a0e07;">QAbstractItemView</span>. Хотя эти классы и готовы к использованию, они могут иметь подклассы, для более точной настройки представления.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Доступные представления описаны в разделе &quot;<span style=" color:#000000;">Классы представлений&quot;</span>. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Делегаты</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">QAbstractItemDelegate</span> - это абстрактный базовый класс делегата в структуре модель/представление. Начиная с Qt 4.4, стандартная реализация делегата предоставляемая <span style=" font-family:'Courier New'; color:#6a0e07;">QStyledItemDelegate</span>, и используется как делегат по умолчанию стандартных представлений Qt. Однако, <span style=" font-family:'Courier New'; color:#6a0e07;">QStyledItemDelegate</span> и <span style=" font-family:'Courier New'; color:#6a0e07;">QItemDelegate</span> являются независимыми альтернативами для рисования и предоставления редакторов элементов представлений. Разница между ними состоит в том, что <span style=" font-family:'Courier New'; color:#6a0e07;">QStyledItemDelegate</span> использует текущий стиль для отрисовки своих элементов. По этой причине мы рекомендуем использовать <span style=" font-family:'Courier New'; color:#6a0e07;">QStyledItemDelegate</span> в качестве базового при реализации пользовательских делегатов или когда работают с таблицами стилей Qt.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Делегаты описаны в разделе &quot;<span style=" color:#000000;">Классы делегатов&quot;</span>.</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Сортировка</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В архитектуре модель/представление имеется два подхода к сортировке; какой подход выбрать - зависит от вашей базовой модели.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если ваша модель сортируемая, т.е. если она переопределит функцию <span style=" font-family:'Courier New'; color:#6a0e07;">QAbstractItemModel::sort()</span>, то и <span style=" font-family:'Courier New'; color:#6a0e07;">QTableView</span> и <span style=" font-family:'Courier New'; color:#6a0e07;">QTreeView</span> предоставляют API, позволяющее программно сортировать данные вашей модели. Кроме того, вы можете разрешить интерактивную сортировку (interactive sorting) (т.е. позволить пользователям сортировать данные нажимая на заголовки представления), соединив сигнал <span style=" font-family:'Courier New'; color:#6a0e07;">QHeaderView::sortIndicatorChanged()</span> со слотом <span style=" font-family:'Courier New'; color:#6a0e07;">QTableView::sortByColumn()</span> или же со слотом <span style=" font-family:'Courier New'; color:#6a0e07;">QTreeView::sortByColumn()</span><span style=" color:#000000;">,</span> соответственно.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Альтернативный подход, если ваша модель не имеет необходимого интерфейса или вы хотите использовать представление списка для отображения ваших данных, заключается в использовании модели-посредника для преобразования структуры вашей модели перед передачей данных в представление. Детально это рассматривается в разделе &quot;<span style=" color:#000000;">Модели-посредники&quot;</span>. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Вспомогательные классы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Множество <span style=" font-style:italic;">вспомогательных</span> классов унаследованы от классов стандартных представлений для удобства использования в приложениях, зависящих от основанных на элементах представлениях Qt и классах таблиц. Они не предназначены для создания на их основе подклассов, а существуют просто как эквивалент классов Qt3, работающих по старой схеме. Примерами таких классов служат <span style=" font-family:'Courier New'; color:#6a0e07;">QListWidget</span>, <span style=" font-family:'Courier New'; color:#6a0e07;">QTreeWidget</span> и <span style=" font-family:'Courier New'; color:#6a0e07;">QTableWidget</span>, реализующие поведение, подобное поведению классов Qt 3 <span style=" font-family:'Courier New'; color:#6a0e07;">QListBox</span>, <span style=" font-family:'Courier New'; color:#6a0e07;">QListView</span> и <span style=" font-family:'Courier New'; color:#6a0e07;">QTable</span>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Эти классы менее гибки, чем классы представлений и не могут использоваться с произвольными моделями. Если вы не сильно нуждаетесь в наборе основанных на элементах классов, мы рекомендуем использовать при обработке данных в представлениях элементов подход на основе модель/представление.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если же вы хотите воспользоваться достоинствами разделения данных и представления не отказываясь от схемы явного предварительного заполнения данных, как например <span style=" font-family:'Courier New'; color:#6a0e07;">QListView</span>, <span style=" font-family:'Courier New'; color:#6a0e07;">QTableView</span> и <span style=" font-family:'Courier New'; color:#6a0e07;">QTreeView</span> с моделью <span style=" font-family:'Courier New'; color:#6a0e07;">QStandardItemModel</span>. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; font-weight:600;">Использование моделей и представлений</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В следующих разделах объясняется, как использовать шаблон модель/представление в Qt. Каждый из разделов включает в себя пример и сопровождается разделом, в котором показывается как создавать новые компоненты. </p>
<p style="-qt-paragraph-type:empty; margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Две модели, включённые в состав Qt</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Qt предоставляет две стандартные модели: <span style=" font-family:'Courier New'; color:#6a0e07;">QStandardItemModel</span> и <span style=" font-family:'Courier New'; color:#6a0e07;">QFileSystemModel</span>. <span style=" font-family:'Courier New'; color:#6a0e07;">QStandardItemModel</span> - это многоцелевая модель, которая может использоваться для представления различных структур данных в виде списка, таблицы или дерева. Данная модель также обрабатывает элементы данных. <span style=" font-family:'Courier New'; color:#6a0e07;">QFileSystemModel</span> - это модель, которая обрабатывает информацию о содержимом директории. Как результат, она не содержит самих элементов данных, а просто представляет файлы и директории локальной файловой системы.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">QFileSystemModel</span> предоставляет готовую к использованию и подходящую для экспериментов модель, которая легко настраивается для работы с существующими данными. На примере этой модели, мы можем показать, как настраивать модель для использования с готовыми представлениями и как управлять данными с помощью модельных индексов. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Использование представлений с существующей моделью</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Классы <span style=" font-family:'Courier New'; color:#6a0e07;">QListView</span> и <span style=" font-family:'Courier New'; color:#6a0e07;">QTreeView</span> являются наиболее подходящими для использования с <span style=" font-family:'Courier New'; color:#6a0e07;">QFileSystemModel</span>. Нижеприведенный пример отображает содержимое директории в виде дерева и его же в виде списка. Представления разделяют пользовательский выбор элементов, так что они подсвечиваются в обоих представлениях.</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1802460797.png" /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Мы подготавливаем к использованию <span style=" font-family:'Courier New'; color:#6a0e07;">QFileSystemModel</span> и создаем представления для отображения содержимого директории. Здесь показан самый простой способ использования модели. Создание и использование модели выполняются в единственной функции <span style=" font-family:'Courier New'; color:#6a0e07;">main()</span>:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> int main(int argc, char *argv[])</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     QApplication app(argc, argv);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     QSplitter *splitter = new QSplitter;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     QFileSystemModel *model = new QFileSystemModel;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     model-&gt;setRootPath(QDir::currentPath());</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модель настроена для использования данных из определенной файловой системы. Вызов <span style=" font-family:'Courier New'; color:#6a1009;">setRootPath()</span> сообщает модели какой диск в файловой системе делать видимым для представлений.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Мы создаем два представления для отображения двумя различными способами элементов, предоставляемых моделью:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     QTreeView *tree = new QTreeView(splitter);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     tree-&gt;setModel(model);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     tree-&gt;setRootIndex(model-&gt;index(QDir::currentPath()));</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     QListView *list = new QListView(splitter);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     list-&gt;setModel(model);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     list-&gt;setRootIndex(model-&gt;index(QDir::currentPath()));</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Представления создаются также, как и другие виджеты. Настройка представления для отображения элементов модели производится просто вызовом функции <span style=" font-family:'Courier New'; color:#6a0e07;">setModel()</span> с моделью директории, переданной в качестве аргумента. Мы фильтруем предоставляемые моделью данные вызывая функцию <span style=" font-family:'Courier New'; color:#6a0e07;">setRootIndex()</span> на каждом представлении, передавая соответствующий <span style=" font-style:italic;">модельный индекс</span> из файловой системы для текущего каталога.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Функция <span style=" font-family:'Courier New'; color:#6a0e07;">index()</span>, используемая в этом случае, является уникальной для <span style=" font-family:'Courier New'; color:#6a0e07;">QFileSystemModel</span>; мы передаем ей каталог и она возвращает модельный индекс. Модельные индексы обсуждаются в &quot;<span style=" color:#000000;">Классы моделей&quot;</span>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Оставшаяся часть функции лишь отображает представления на виджете и запускает цикл обработки событий приложения:</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     splitter-&gt;setWindowTitle(&quot;Two views onto the same file system model&quot;);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     splitter-&gt;show();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     return app.exec();</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В вышеприведенном примере мы не упомянули обработку выбора элементов пользователем. Эта тема более подробно раскрыта в разделе &quot;<span style=" color:#000000;">Обработка выбора в представлении элементов&quot;.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; font-weight:600;">Классы моделей</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">До ознакомления с обработкой выбора, вам будет полезно изучить концепции, используемые в структуре модель/представление. </p>
<p style="-qt-paragraph-type:empty; margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Основные концепции</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В архитектуре модель/представление, модель предоставляет стандартный интерфейс, используемый представлениями и делегатами для доступа к данным. В Qt, стандартный интерфейс определен с помощью класса <span style=" font-family:'Courier New'; color:#6a0e07;">QAbstractItemModel</span>. Независимо от того, как элементы данных хранятся в структуре данных, все подклассы <span style=" font-family:'Courier New'; color:#6a0e07;">QAbstractItemModel</span> представляют данные в виде иерархической структуры, содержащей таблицы элементов. Представления используют это <span style=" font-style:italic;">соглашение</span> для доступа к элементам данных модели, но они не ограничены в способах предоставления информации пользователю.</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image2122637629.png" /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">С помощью механизма сигналов и слотов, модели уведомляют связанные представления об изменениях в данных.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Данный раздел описывает некоторые концепции, являющиеся важнейшими для получения другими компонентами доступа к элементам данных через класс модели. Более продвинутые концепции обсуждаются в следующих разделах. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Модельные индексы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для того, чтобы гарантировать, что представления данных отделены от способа доступа к ним, введено понятие <span style=" font-style:italic;">модельного индекса</span>. Каждая часть информации, которая может быть получена через модель, представлена модельным индексом. Представления и делегаты используют эти индексы для запроса отображаемых данных.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В результате, только модели требуется знать, как хранятся данные, а тип данных, управляемых моделью, может быть определен довольно приблизительно. Модельные индексы содержат указатель на модель, которая их создала, что предотвращает беспорядок при работе с более, чем одной моделью.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> QAbstractItemModel *model = index.model();</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модельные индексы предоставляют <span style=" font-style:italic;">временные</span> ссылки на части информации и могут использоваться для получения или изменения данных посредством модели. В связи с тем, что модели могут время от времени реорганизовывать свою структуру, модельные индексы могут стать недействительными и <span style=" font-style:italic;">не должны храниться</span>. Если требуется долгоживущая ссылка на часть данных, должен быть создан <span style=" font-style:italic;">постоянный модельный индекс</span>. Он предоставляет ссылку на данные, которая поддерживается моделью актуальной. Временные модельные индексы предоставляются классом <span style=" font-family:'Courier New'; color:#6a0e07;">QModelIndex</span>, а постоянные модельные индексы предоставляются классом <span style=" font-family:'Courier New'; color:#6a0e07;">QPersistentModelIndex</span>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для получения модельного индекса, соответствующего элементу данных, у модели должны быть заданы три свойства: номер строки, номер столбца и модельный индекс родительского элемента. Следующий раздел детально описывает и поясняет эти свойства. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Строки и столбцы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Основной формой представления модели является таблица, в которой элемент задается номерами строки и столбца. <span style=" font-style:italic;">Это не означает, что основные части информации хранятся в виде массива</span>; использование номеров строк и столбцов является лишь соглашением, позволяющим элементам взаимодействовать друг с другом. Мы можем получить информацию о любом элементе, указав модели номер строки и столбца и получив индекс, представляющий элемент:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> QModelIndex index = model-&gt;index(row, column, ...);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модели, предоставляющие интерфейсы к простым одноуровневым структурам данных, таким как списки и таблицы, не нуждаются в другой информации помимо номеров строк и столбцов, но, поскольку вышеупомянутый код требует этого, мы должны сообщить несколько больше данных для получения модельного индекса.</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image887768905.png" style="vertical-align: top;" /> </p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Строки и столбцы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Диаграмма показывает представление основной табличной модели, в которой каждый элемент определяется парой номеров - строки и столбца. Мы получаем модельный индекс, который ссылается на элемент данных, передавая соответствующие номера строки и столбца в модель.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> QModelIndex indexA = model-&gt;index(0, 0, QModelIndex());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> QModelIndex indexB = model-&gt;index(1, 1, QModelIndex());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> QModelIndex indexC = model-&gt;index(2, 1, QModelIndex());</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Элементы верхнего уровня модели всегда имеют в качестве родителя специфический <span style=" font-family:'Courier New,courier';">QModelIndex()</span>. Он будет описан в следующем разделе.</p></td></tr></table>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Родители элементов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Таблицеподобный интерфейс к элементам данных, предоставляемый моделью, идеален при использовании данных в представлениях в виде таблицы или списка; система номеров строк и столбцов точно указывает способ отображения представлениями элементов. Однако, структуры, подобные представлению дерева, требуют более гибкого интерфейса к элементам. В результате, каждый элемент также может быть родителем другой таблицы элементов, почти также, как элемент верхнего уровня в представлении дерева может вмещать в себя список других элементов.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При запросе индекса элемента модели, мы должны предоставить некоторую информацию о родительском элементе. Единственным способом обращения к элементу вне модели является модельный индекс, так что модельный индекс родителя также должен быть известен:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> QModelIndex index = model-&gt;index(row, column, parent);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image884613323.png" style="vertical-align: top;" /> </p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Родители, строки и столбцы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Диаграмма показывает представление модели дерева, в которой каждый элемент определяется родителем, номером строки и номером столбца.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Элементы &quot;A&quot; и &quot;C&quot; представлены как верхнеуровневые элементы модели:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> QModelIndex indexA = model-&gt;index(0, 0, QModelIndex());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> QModelIndex indexC = model-&gt;index(2, 1, QModelIndex());</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Элемент &quot;A&quot; имеет множество дочерних объектов. Модельный индекс элемента &quot;B&quot; может быть получен с помощью следующего кода:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> QModelIndex indexB = model-&gt;index(1, 0, indexA);</span></p></td></tr></table>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Роли элемента</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Элементы модели могут выполнять различные <span style=" font-style:italic;">роли</span> для других компонентов, позволяя в различных ситуациях получать различные виды данных. Например, <span style=" font-family:'Courier New'; color:#6a0e07;">Qt::DisplayRole</span> используется для доступа к строке, которая может отображаться в представлении как текст. Как правило, элементы содержат информацию для нескольких различных ролей, а стандартные роли определяются с помощью <span style=" font-family:'Courier New'; color:#6a0e07;">Qt::ItemDataRole</span>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Мы можем запросить у модели информацию об элементе, передав ей модельный индекс, соответствующий элементу и задав роль для получения данных желаемого типа:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> QVariant value = model-&gt;data(index, role);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image820011336.png" style="vertical-align: top;" /> </p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Роли элемента</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Роль указывает модели, данные какого типа будут переданы. Представления могут отображать роли различными способами, поэтому важно обеспечить информацию, соответствующую каждой роли.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Раздел &quot;<span style=" color:#000000;">Создание новых моделей&quot; </span>более подробно описывает несколько необычное использование ролей.</p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Наиболее частые способы использования элементов данных описываются стандартными ролями, определенными в <span style=" font-family:'Courier New'; color:#6a0e07;">Qt::ItemDataRole</span>. Снабжая элемент данных информацией для каждой роли, модель может предоставить предпочтения для отображения элемента пользователю представлениями и делегатами. Различные виды представлений имеют возможность интерпретировать эти данные или игнорировать эту информацию, если требуется. Также имеется возможность определять дополнительные, специфические для приложения, роли. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Резюме</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модельные индексы дают представлениям и делегатам информацию о размещении элементов, предоставляемых моделью, и независимую от структуры данных.</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Элементы определяются номерами строк и столбцов и модельным индексом их родительских элементов.</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модельные индексы создаются моделями по требованию других компонентов, таких как представления и делегаты.</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если при вызове функции <span style=" font-family:'Courier New'; color:#6a0e07;">index()</span> в качестве родительского элемента передается действительный модельный индекс, то возвращаемый индекс ссылается на элемент, находящийся ниже в иерархии модели, чем родитель. Полученный индекс ссылается на дочерний элемент этого индекса.</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если в качестве родительского элемента функции <span style=" font-family:'Courier New'; color:#6a0e07;">index() </span>передается недействительный модельный индекс, то возвращаемый индекс ссылается на элемент верхнего уровня.</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Роль</span> различается для различных видов данных, связанных с элементом. </li></ul>
<p style="-qt-paragraph-type:empty; margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Использование модельных индексов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы продемонстрировать, как данные могут быть получены из модели с помощью модельных индексов, мы создаем <span style=" font-family:'Courier New'; color:#6a0e07;">QFileSystemModel</span> без представления и отображаем в виджете имена файлов и директорий. Хотя этот пример и не показывает нормального способа использования модели, он демонстрирует соглашения, используемые моделями при работе с модельными индексами.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Мы создаем модель файловой системы следующим способом:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     QFileSystemModel *model = new QFileSystemModel;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     QModelIndex parentIndex = model-&gt;index(QDir::currentPath());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     int numRows = model-&gt;rowCount(parentIndex);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В этом случае, мы создаем <span style=" font-family:'Courier New'; color:#6a0e07;">QFileSystemModel</span> по умолчанию, получив родительский индекс с помощью специфической реализации <span style=" font-family:'Courier New'; color:#6a0e07;">index()</span>, предоставляемой этой моделью, а с помощью функции <span style=" font-family:'Courier New'; color:#6a0e07;">rowCount()</span> мы получаем количество строк в модели.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для простоты, мы интересовались лишь элементами первого столбца модели. Мы рассмотрим каждую строку по очереди, получая модельный индекс для первого элемента каждой строки, и читаем данные, хранящиеся в модели для этого элемента.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     for (int row = 0; row &lt; numRows; ++row) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">         QModelIndex index = model-&gt;index(row, 0, parentIndex);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для получения модельного индекса мы задаем номер строки, номер столбца (ноль для первого столбца) и модельный индекс, соответствующий родителю всех элементов, которые мы хотим получить. Текст, хранящийся в каждом элементе, может быть получен с помощью функции модели <span style=" font-family:'Courier New'; color:#6a0e07;">data()</span>. Мы задаем модельный индекс и <span style=" font-family:'Courier New'; color:#6a0e07;">DisplayRole</span>, чтобы получить информацию об элементе в виде строки.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">         QString text = model-&gt;data(index, Qt::DisplayRole).toString();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">         // Отображение текста в виджете.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вышеприведенный пример демонстрирует основные принципы, используемые для восстановления данных из модели:</p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Измерения модели могут быть получены с помощью <span style=" font-family:'Courier New'; color:#6a0e07;">rowCount()</span> и <span style=" font-family:'Courier New'; color:#6a0e07;">columnCount()</span>. Эти функции обычно требуют, чтобы был определен родительский модельный индекс.</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модельные индексы используются для доступа к элементам модели. Для задания элемента требуются номер строки, номер столбца и модельный индекс родительского элемента.</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для доступа к элементам модели верхнего уровня, в качестве модельного индекса родительского элемента, с помощью <span style=" font-family:'Courier New,courier';">QModelIndex()</span>, задается нулевой модельный индекс.</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Элементы содержат данные для различных ролей. Для получения данных определенной роли, модели должны быть сообщены модельный индекс и роль. </li></ul>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Дополнительные материалы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Новые модели могут быть созданы с помощью реализации стандартного интерфейса, предоставляемого <span style=" font-family:'Courier New'; color:#6a0e07;">QAbstractItemModel</span>. Мы продемонстрируем это в разделе &quot;<span style=" color:#000000;">Создание новых моделей&quot;</span>, создав удобную готовую к использованию модель для хранения списка строк. </p>
<p style="-qt-paragraph-type:empty; margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; font-weight:600;">Классы представлений</span> </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Концепции</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В архитектуре модель/представление, представление получает элементы данных от модели и предоставляет их пользователю. Способ, которым данные предоставляются пользователю, не обязан походить на структуру данных, предоставляемую моделью, и может быть <span style=" font-style:italic;">полностью отличным</span> от основной структуры данных, хранящей элементы данных.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Разделение содержимого и представления достигается с помощью использования стандартного модельного интерфейса, предоставляемого <span style=" font-family:'Courier New'; color:#6a0e07;">QAbstractItemModel</span>, стандартного интерфейса представления, предоставляемого <span style=" font-family:'Courier New'; color:#6a0e07;">QAbstractItemView</span>, и использования модельных индексов, единообразно представляющих элементы данных. Представления обычно управляют размещением данных, полученных от модели. Они могут отображать отдельные элементы непосредственно или использовать <span style=" font-weight:600; color:#000000;">делегаты</span> для реализации особенностей отображения и редактирования.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Наряду с отображением элементов, представления управляют навигацией между элементами и некоторыми аспектами выбора элемента. Представления также реализуют основные возможности пользовательского интерфейса, такие как контекстные меню и перетаскивание. Представление может предоставить средства обслуживания редактирования элементов или могут работать с <span style=" font-weight:600; color:#000000;">делегатом</span>, предоставляющим собственный редактор.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Представление может быть создано без модели, но модель должна быть предоставлена прежде, чем оно сможет отобразить полезную информацию. Представления отслеживают выбор элементов пользователем с помощью <span style=" font-weight:600; color:#000000;">выбора</span>, который может быть реализован отдельно для различных представлений или быть общим для различных представлений.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Некоторые представления, такие как <span style=" font-family:'Courier New'; color:#6a0e07;">QTableView</span> и <span style=" font-family:'Courier New'; color:#6a0e07;">QTreeView</span>, отображают заголовки также как элементы. Заголовки также реализованы с помощью класса представления <span style=" font-family:'Courier New'; color:#6a0e07;">QHeaderView</span>. Заголовки обычно обращаются к той же модели, что и содержащее их представление. Они получают данные от модели с помощью функции <span style=" font-family:'Courier New'; color:#6a0e07;">QAbstractItemModel::headerData()</span> и обычно отображают информацию заголовков в виде надписей. Для получения экзотических заголовков, можно создать подклассы <span style=" font-family:'Courier New'; color:#6a0e07;">QHeaderView</span>. </p>
<p style="-qt-paragraph-type:empty; margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Использование существующего представления</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Qt предоставляет три готовых к использованию класса представлений, которые отображают информацию в виде, привычном большинству пользователей. <span style=" font-family:'Courier New'; color:#6a0e07;">QListView</span> может отображать элементы модели в виде простого списка или в виде классического представления пиктограмм. <span style=" font-family:'Courier New'; color:#6a0e07;">QTreeView</span> отображает элементы данных модели в виде иерархии списков, позволяющей компактно представить глубоко вложенные структуры. <span style=" font-family:'Courier New'; color:#6a0e07;">QTableView</span> представляет элементы модели в виде таблицы, очень сильно похожей на приложение электронной таблицы.</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1522275024.png" /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Реализация поведения по умолчанию для вышеприведенных представлений, достаточна для большинства приложений. Они предоставляют основные средства редактирования и могут быть настроены для более специфических пользовательских интерфейсов. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Использование модели</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Возьмем модель списка строк, которую <span style=" color:#000000;">мы создали </span><span style=" font-style:italic; color:#000000;">в качестве примера</span>, настроим ее на некоторые данные и создадим представление для отображения содержимого модели. Все это может быть сделано в рамках одной функции:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> int main(int argc, char *argv[])</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     QApplication app(argc, argv);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> // Убраны отступы для облегчения цитирования:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> QStringList numbers;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> numbers &lt;&lt; &quot;One&quot; &lt;&lt; &quot;Two&quot; &lt;&lt; &quot;Three&quot; &lt;&lt; &quot;Four&quot; &lt;&lt; &quot;Five&quot;;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> QAbstractItemModel *model = new StringListModel(numbers);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обратите внимание на то, что мы объявили <span style=" font-family:'Courier New'; color:#6a0e07;">StringListModel</span> как <span style=" font-family:'Courier New'; color:#6a0e07;">QAbstractItemModel</span>. Это позволяет нам использовать абстрактный интерфейс модели и гарантирует, что этот код будет работать даже в том случае, если мы заменим модель списка на другую модель.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Представление списка, предоставляемое <span style=" font-family:'Courier New'; color:#6a0e07;">QListView</span>, вполне достаточно для отображения элементов модели списка строк. Мы создаем представление и устанавливаем его на модель с помощью следующих строк кода:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> QListView *view = new QListView;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> view-&gt;setModel(model);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Представление отображается обычным способом:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     view-&gt;show();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     return app.exec();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Представление отображает содержимое модели, получая данные через интерфейс модели. При попытке пользователя редактировать элемент, представление использует делегата по умолчанию для предоставления виджета редактора.</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image359479505.png" /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Рисунок выше демонстрирует, как <span style=" font-family:'Courier New'; color:#6a0e07;">QListView</span> представляет данные модели списка строк. Так как модель редактируемая, представление автоматически, используя делегата по умолчанию, позволяет быть отредактированным каждому элементу. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Использование множества представлений с одной моделью</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Отображение одной модели во множестве представлений - просто вопрос установки одной и той же модели для каждого представления. В следующем коде мы создаем два представления-таблицы, каждое из которых использует простую модель, которую мы создали в этом примере:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     QTableView *firstTableView = new QTableView;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     QTableView *secondTableView = new QTableView;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     firstTableView-&gt;setModel(model);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     secondTableView-&gt;setModel(model);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Использование сигналов и слотов в архитектуре модель/представление означает, что об изменении данных в модели может быть сообщено всем связанным с ней представлениям, гарантируя при этом доступ к одним и тем же данным независимо от используемого представления.</p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image637389306.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">На рисунке выше показаны два различных представления одной модели, каждое из которых содержит множество выделенных элементов. Несмотря на то, что данные в представлениях синхронизированы, каждое представление содержит свою внутреннюю модель выбора. В некоторых ситуациях это может быть полезно, но для большинства приложений желательна общая модель выбора. </p>
<p style="-qt-paragraph-type:empty; margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Обработка выбора элементов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Механизм обработки выбора элементов в представлении предоставляется классом <span style=" font-family:'Courier New'; color:#6a0e07;">QItemSelectionModel</span>. Все стандартные представления создают свои собственные модели выбора по умолчанию и взаимодействуют с ними стандартным образом. Модель выбора, используемая представлением, может быть получена с помощью функции <span style=" font-family:'Courier New'; color:#6a0e07;">selectionModel()</span>, а заменить модель выбора можно с помощью функции <span style=" font-family:'Courier New'; color:#6a0e07;">setSelectionModel()</span>. Возможность управлять моделью выбора, используемой представлением, полезна, если вы хотите предоставить множество представлений для одних и тех же данных модели.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вообще, если вы создаете подкласс модели или представления, вам не требуется управлять содержимым модели выбора напрямую. Однако если требуется, можно получить доступ к интерфейсу модели выбора, что обсуждается в &quot;<span style=" color:#000000;">Обработке выбора в представлениях элементов&quot;</span>. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Разделение выбора между представлениями</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Хотя предоставление представлением своей собственной модели выбора по умолчанию и удобно, но при использовании нескольких представлений с одной моделью часто желательно, чтобы и данные модели и выбор пользователя были показаны одинаково во всех представлениях. Так как классы представлений позволяют заменять свои внутренние модели выбора, мы можем добиться единообразного отображения выбора в разных представлениях с помощью следующего кода:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     secondTableView-&gt;setSelectionModel(firstTableView-&gt;selectionModel());</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Второму представлению устанавливают модель выбора первого представления. Теперь оба представления работают с одной моделью выбора, синхронно показывая и данные, и выбранные элементы.</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1529402774.png" /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В вышеприведенном примере для отображения данных одной модели использовались два представления одинакового типа. Однако, если используются два различных представления, то выбранные элементы могут быть представлены в каждом представлении по-разному; например, выбор смежных элементов в представлении таблицы, в представлении дерева может быть отображен как фрагментированный набор выделенных элементов. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; font-weight:600;">Классы делегатов</span> </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Концепции</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В отличие от шаблона модель-представление-контроллер (MVC), архитектура модель/представление не включает в себя полностью независимые компоненты для управления взаимодействием с пользователем. Как правило, представление отвечает за представление пользователю данных модели и за обработку пользовательского ввода. Чтобы придать немного гибкости способу, которым этот ввод получается, взаимодействие осуществляется с помощью делегатов (delegates). Эти компоненты предоставляют возможности ввода, а также отвечают за отрисовку индивидуальных элементов в некоторых представлениях. Стандартный интерфейс управления делегатами определен в классе <span style=" font-family:'Courier New'; color:#6a0e07;">QAbstractItemDelegate</span>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ожидается, что делегаты способны самостоятельно отрисовывать свое содержимое, реализовав функции <span style=" font-family:'Courier New'; color:#6a0e07;">paint()</span> и <span style=" font-family:'Courier New'; color:#6a0e07;">sizeHint()</span>. Однако, простые, основанные на виджетах, делегаты могут быть созданы как подкласс <span style=" font-family:'Courier New'; color:#6a0e07;">QItemDelegate</span> вместо <span style=" font-family:'Courier New'; color:#6a0e07;">QAbstractItemDelegate</span>, и получить преимущества реализации этих функций по умолчанию.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Редакторы для делегатов могут быть реализованы либо с использованием виджетов для управления процессом редактирования либо непосредственной обработкой событий. Первый подход раскрывается в этом разделе, а также показан в примере<span style=" font-family:'Courier New'; color:#6a0e07;"> &quot;Spin Box Delegate&quot;</span>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Пример <span style=" font-weight:600; color:#000000;">Pixelator</span> показывает как создавать пользовательский делегат, выполняющий специализированный рендеринг для представления таблицы. </p>
<p style="-qt-paragraph-type:empty; margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Использование существующих делегатов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Стандартные представления, поставляемые вместе с Qt, используют экземпляры класса <span style=" font-family:'Courier New'; color:#6a0e07;">QItemDelegate</span> для предоставления средств редактирования. Эта реализация по умолчанию интерфейса делегата отображает элементы в обычном стиле для каждого из стандартных представлений: <span style=" font-family:'Courier New'; color:#6a0e07;">QListView</span>, <span style=" font-family:'Courier New'; color:#6a0e07;">QTableView</span> и <span style=" font-family:'Courier New'; color:#6a0e07;">QTreeView</span>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Стандартные представления используют делегат по умолчанию, обрабатывающий все стандартные роли. Способ их интерпретации описывается в документации к <span style=" font-family:'Courier New'; color:#6a0e07;">QItemDelegate</span>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Функция <span style=" font-family:'Courier New'; color:#6a0e07;">itemDelegate()</span> возвращает делегат, используемый представлением. Функция <span style=" font-family:'Courier New'; color:#6a0e07;">setItemDelegate()</span> позволяет вам установить пользовательский делегат для стандартного представления и важно использовать эту функцию когда устанавливается делегат для пользовательского представления. </p>
<p style="-qt-paragraph-type:empty; margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Простой делегат</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Реализованный здесь делегат использует <span style=" font-family:'Courier New'; color:#6a0e07;">QSpinBox</span> для предоставления средств редактирования и предназначен в основном для использования с моделями, которые отображают целые числа. Хотя для этой цели мы установили пользовательскую модель таблицы, основанную на целых числах, мы легко можем использовать вместо нее <span style=" font-family:'Courier New'; color:#6a0e07;">QStandardItemModel</span>, так как вводом данных управляет пользовательский делегат. Мы создадим представление таблицы для отображения содержимого модели и оно будет использовать пользовательский делегат для редактирования.</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1961342312.png" /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Мы создаем подкласс делегата от <span style=" font-family:'Courier New'; color:#6a0e07;">QItemDelegate</span> поскольку мы не хотим писать функции пользовательского вывода на экран. Однако, мы все же должны предоставить функции для управления виджетом-редактором:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> class SpinBoxDelegate : public QItemDelegate</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     Q_OBJECT</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> public:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     SpinBoxDelegate(QObject *parent = 0);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     QWidget *createEditor(QWidget *parent, const QStyleOptionViewItem &amp;option,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">                           const QModelIndex &amp;index) const;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     void setEditorData(QWidget *editor, const QModelIndex &amp;index) const;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     void setModelData(QWidget *editor, QAbstractItemModel *model,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">                       const QModelIndex &amp;index) const;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     void updateEditorGeometry(QWidget *editor,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">         const QStyleOptionViewItem &amp;option, const QModelIndex &amp;index) const;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> };</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обратите внимание, что при создании делегата виджеты-редакторы не создаются. Мы создаем виджет-редактор только когда это необходимо. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Предоставление редактора</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В этом примере, когда представление таблицы нуждается в редакторе, оно просит делегат предоставить виджет-редактор, соответствующий модифицируемому элементу. Функцию<span style=" font-family:'Courier New'; color:#6a0e07;"> createEditor() </span>снабжаем всем, что необходимо делегату для установки соответствующего виджета:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> QWidget *SpinBoxDelegate::createEditor(QWidget *parent,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     const QStyleOptionViewItem &amp;/* option */,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     const QModelIndex &amp;/* index */) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     QSpinBox *editor = new QSpinBox(parent);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     editor-&gt;setMinimum(0);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     editor-&gt;setMaximum(100);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     return editor;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обратите внимание, что мы не нуждаемся в хранении указателя на виджет-редактор, так как представление берет на себя ответственность за его уничтожение когда он станет не нужен.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Мы установили стандартный фильтр событий делегата на редактор для гарантирования того, что он предоставит ожидаемые пользователями стандартные &quot;горячие&quot; клавиши редактирования. Чтобы сделать возможным более сложное поведение в редактор могут быть добавлены дополнительные &quot;горячие&quot; клавиши; это обсуждается в разделе &quot;<span style=" color:#000000;">Редактирование подсказок&quot;</span>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Представление убеждается в правильности установки данных редактора и геометрии с помощью вызова функций, которые для этих целей мы определим позднее. Мы можем создать различные редакторы, зависящие от предоставляемого представлением модельного индекса. Например, если у нас есть столбец целых чисел и столбец строк мы можем вернуть либо <span style=" font-family:'Courier New,courier';">QSpinBox</span> либо <span style=" font-family:'Courier New,courier';">QLineEdit</span>, в зависимости от того, какой столбец редактируется.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Делегат должен предоставить функцию копирования данных модели в редактор. В этом примере мы читаем данные, хранящиеся в <span style=" color:#000000;">роли отображения </span>(display role), и соответственно устанавливаем значение в окошке счетчика.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> void SpinBoxDelegate::setEditorData(QWidget *editor,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">                                     const QModelIndex &amp;index) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     int value = index.model()-&gt;data(index, Qt::EditRole).toInt();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     QSpinBox *spinBox = static_cast&lt;QSpinBox*&gt;(editor);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     spinBox-&gt;setValue(value);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В этом примере мы знаем, что виджет-редактор это окошко счетчика, но мы можем предоставлять различные редакторы для разных типов данных в модели, в этом случае мы должны привести виджет к соответствующему типу до обращения к его функциям-членам. </p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Запись данных в модель</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Когда пользователь завершает редактирования значения в окошке счетчика, представление просит делегата сохранить отредактированное значение в модели, вызвав функцию <span style=" font-family:'Courier New'; color:#6a0e07;">setModelData()</span>.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> void SpinBoxDelegate::setModelData(QWidget *editor, QAbstractItemModel *model,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">                                    const QModelIndex &amp;index) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     QSpinBox *spinBox = static_cast&lt;QSpinBox*&gt;(editor);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     spinBox-&gt;interpretText();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     int value = spinBox-&gt;value();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New'; color:#6a0e07;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;">     model-&gt;setData(index, value, Qt::EditRole);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:20px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New'; color:#6a0e07;"> }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Так как представление управляет виджетами-редакторами делегата, мы должны только обновить модель с предоставленным редактором содержимым. В данном случае мы удостоверяемся в том, что окошко счетчика обновилось и обновляем содержащую значение модель, используя заданный индекс.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Стандартный класс <span style=" font-family:'Courier New'; color:#6a0e07;">QItemDelegate</span> сообщает представлению когда он завершил редактирование испуская сигнал <span style=" font-family:'Courier New'; color:#6a0e07;">closeEditor()</span>. Представление проверяет, что виджет-редактор закрыт и уничтожен. В этом примере мы предоставили только простые средства редактирования, поэтому нам никогда не понадобится испускать этот сигнал.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Все операции над данными выполняются через интерфейс, предоставляемый <a href="qabstractitemmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel</span></a>. Это делает делегата в значительной степени независимым от типа данных, с которыми он манипулирует, но должны быть сделаны некоторые допущения в порядке использования определенных типов виджетов-редакторов. В этом примере мы предполагали, что модель всегда содержит целые числа, но мы можем использовать этот делегат с другими видами моделей, поскольку <a href="qvariant.html"><span style=" text-decoration: underline; color:#0057ae;">QVariant</span></a> предоставляет удобные значения по умолчанию для непредвиденных данных. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Обновление геометрии редактора</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">За управление геометрией редактора отвечает делегат. Геометрия должна быть установлена при создании редактора, при изменении размеров или положения элемента в представлении. К счастью, представление предоставляет всю необходимую информацию о геометрии внутри объекта <a href="qstyleoptionviewitem.html"><span style=" text-decoration: underline; color:#0057ae;">опция представления</span></a> (view option).</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> void SpinBoxDelegate::updateEditorGeometry(</span><a href="qwidget.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QWidget</span></a><span style=" font-family:'Courier New,courier';"> *editor,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     const </span><a href="qstyleoptionviewitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QStyleOptionViewItem</span></a><span style=" font-family:'Courier New,courier';"> &amp;option, const </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> &amp;/* index */) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     editor-&gt;setGeometry(option.rect);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В данном случае мы используем только информацию, предоставляемую опцией представления в прямоугольнике элемента. Делегат, который отображает элементы с несколькими примитивами, не использует прямоугольник элемента непосредственно. Он поместит редактор в зависимости от других примитивов в элементе. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Редактирование подсказок</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">После редактирования делегаты должны предоставить другим компонентам подсказки о результате процесса редактирования и предоставить подсказки, которые будут помогать любым последующим операциям редактирования. Достигается это испусканием сигнала <a href="qabstractitemdelegate.html#closeEditor"><span style=" text-decoration: underline; color:#0057ae;">closeEditor()</span></a> с соответствующей подсказкой. Эту обязанность берет на себя стандартный фильтр событий <a href="qitemdelegate.html"><span style=" text-decoration: underline; color:#0057ae;">QItemDelegate</span></a>, который мы установили на окошко счетчика при его создании.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Поведение окошка счетчика можно настраивать, чтобы сделать его более дружественным. В фильтре событий по умолчанию, предоставляемом <a href="qitemdelegate.html"><span style=" text-decoration: underline; color:#0057ae;">QItemDelegate</span></a>, если пользователь нажмет <span style=" font-weight:600;">Return</span> для подтверждения своего выбора в окошке счетчика, делегат фиксирует значение в модели и закрывает окошко счетчика. Мы можем изменить это поведение, установив на окошко счетчика свой собственный фильтр событий и предоставив подсказки редактирования, соответствующие нашим нуждам; например, мы можем испустить <a href="qabstractitemdelegate.html#closeEditor"><span style=" text-decoration: underline; color:#0057ae;">closeEditor()</span></a> с подсказкой <a href="qabstractitemdelegate.html#EndEditHint-enum"><span style=" text-decoration: underline; color:#0057ae;">EditNextItem</span></a> для автоматического начала редактирования следующего элемента в представлении.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Другим подходом, не требующим использования фильтра событий, является предоставление нашего собственного виджета-редактора, возможно унаследованный для удобства от <a href="qspinbox.html"><span style=" text-decoration: underline; color:#0057ae;">QSpinBox</span></a>. Альтернативным подходом будет передать нам больше контроля над поведением виджета-редактора за счет написания дополнительного кода. В большинстве случаев более удобно установить фильтр событий в делегате, если вам необходимо настраивать поведение стандартного виджета-редактора Qt.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Делегаты не испускают эти подсказки, но тогда они будут слабее интегрированы в приложения и будут менее удобны, чем те, что испускают подсказки для поддержки общепринятых действий редактирования. </p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; font-weight:600;">Обработка выбора элементов в представлениях</span> </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Концепции</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В модели выбора, предлагаемой в классах представления элементов, предоставляется множество усовершенствований по сравнению с моделью выбора Qt 3. Она предоставляет более качественное описание выбора, основанное на возможностях архитектуры модель/представление. Несмотря на то, что стандартные классы для управления выбором в представлениях элементов вполне функциональны, для удовлетворения требований ваших моделей и представлений вы можете создавать свои собственные модели выбора.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Информация о выбранных элементах представления хранится в экземпляре класса <a href="qitemselectionmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QItemSelectionModel</span></a>. Этот класс содержит свои собственные модельные индексы элементов независимо от представления. В связи с тем, что возможно использование нескольких представлений с одной моделью, можно разделить одну модель выбора между несколькими представлениями, позволив тем самым приложению отобразить одни и те же данные различными способами.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выбор состоит из <span style=" font-style:italic;">выбранных диапазонов</span>. Эти диапазоны компактно хранят информацию о множестве выбранных элементов, запоминая только начальный и конечный модельные индексы для каждого диапазона выбранных элементов. Для описания выбора несмежных элементов используется более одного диапазона выделения.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выбор применяется к набору модельных индексов, хранящихся в модели выбора. Последний выбор элементов известен как <span style=" font-style:italic;">текущее выделение</span>. Свойства этого набора могут быть изменены с помощью некоторых команд управления выбора. Они обсуждаются позже в этом разделе. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Текущий элемент и выделенные элементы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В представлении всегда имеется текущий элемент и выделенный элемент - два независимых состояния. Элемент может быть текущим элементом и выделенным элементом одновременно. Представление отвечает за обеспечение того, чтобы всегда имелся текущий элемент поскольку для перемещения с помощью клавиатуры, например, требуется текущий элемент.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Таблица ниже подчеркивает разницу между текущим элементом и выделенными элементами.</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0"><thead>
<tr>
<td>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Текущий элемент</span></p></td>
<td>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Выбранные элементы</span></p></td></tr></thead>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Может быть только один текущий элемент.</p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Может быть много выбранных элементов.</p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Текущий элемент изменяется при перемещении с помощью клавиатуры или щелчков кнопок мыши.</p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Состояние выделения элементов устанавливается или снимается, зависящий от нескольких предопределенных режимов - например, выделения единственного элемента, множественного выделения, и т.д. - когда пользователь взаимодействует с элементами.</p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Текущий элемент будет редактироваться, если нажата клавиша редактирования, <span style=" font-weight:600;">F2</span>, или по элементу дважды щелкнули мышью (в том случае, если редактирование разрешено).</p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Текущий элемент может быть использован вместе с указателем определяющим диапазон, который будет выбранным или невыбранным (или сочетанием этих двух).</p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Текущий элемент обозначается прямоугольником фокуса ввода.</p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выбранные элементы обозначаются с помощью прямоугольника выделения.</p></td></tr></table>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При манипулировании выбором, часто полезно думать о <a href="qitemselectionmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QItemSelectionModel</span></a> как о наборе состояний выбора всех элементов в модели. Как только модель выбора установлена, наборы элементов могут быть выбраны, их выбор может быть отменен или изменен без необходимости знать, какие конкретно элементы выбраны. Индексы всех выбранных элементов могут быть получены в любое время, а с помощью механизма сигналов и слотов другие компоненты могут быть оповещены об изменениях в модели выбора. </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Использование модели выбора</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Стандартные классы представлений по умолчанию предоставляют модели выбора, которые могут использоваться в большинстве приложений. Модель выбора, принадлежащая одному представлению, может быть получена с помощью функции представления <a href="qabstractitemview.html#selectionModel"><span style=" text-decoration: underline; color:#0057ae;">selectionModel()</span></a> и разделена между несколькими представлениями с помощью функции <a href="qabstractitemview.html#setSelectionModel"><span style=" text-decoration: underline; color:#0057ae;">setSelectionModel()</span></a>, так что создание новых моделей выбора вообще не требуется.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выбор создают задавая модель и пару модельных индексов в <a href="qitemselection.html"><span style=" text-decoration: underline; color:#0057ae;">QItemSelection</span></a>. Он использует индексы для ссылки на элементы данной модели и интерпретируются как левый верхний и правый нижний элементы в блоке выбранных элементов. Для того, чтобы выбор повлиял на модель выбора, его следует применить к ней; это может быть сделано различными способами, и каждый из них будет иметь различное влияние на уже выбранные элементы модели. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Выбор элементов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для демонстрации некоторых основных возможностей выбора, мы создаем экземпляр пользовательской модели таблицы, содержащей всего 32 элемента, и для его данных устанавливаем табличное представление:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     TableModel *model = new TableModel(8, 4, &amp;app);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qtableview.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTableView</span></a><span style=" font-family:'Courier New,courier';"> *table = new </span><a href="qtableview.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTableView</span></a><span style=" font-family:'Courier New,courier';">(0);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     table-&gt;setModel(model);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qitemselectionmodel.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QItemSelectionModel</span></a><span style=" font-family:'Courier New,courier';"> *selectionModel = table-&gt;selectionModel();</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для дальнейшего использования получаем модель выбора табличного представления по умолчанию. Мы не изменяем в модели никаких элементов, но вместо этого выбираем несколько элементов, которые представление покажет в левом верхнем углу таблицы. Чтобы сделать это, мы должны получить модельные индексы левого верхнего и правого нижнего элементов блока, который должен быть выбран:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> topLeft;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> bottomRight;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     topLeft = model-&gt;index(0, 0, </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';">());</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     bottomRight = model-&gt;index(5, 2, </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';">());</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы сделать эти элементы в модели выбранными и увидеть соответствующие изменения в табличном представлении, мы должны создать объект выбора и применить его к модели выбора:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qitemselection.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QItemSelection</span></a><span style=" font-family:'Courier New,courier';"> selection(topLeft, bottomRight);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     selectionModel-&gt;select(selection, </span><a href="qitemselectionmodel.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QItemSelectionModel</span></a><span style=" font-family:'Courier New,courier';">::Select);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выбор применяется к модели выбора с помощью команды, заданной комбинацией <a href="qitemselectionmodel.html#SelectionFlag-enum"><span style=" text-decoration: underline; color:#0057ae;">флагов выбора</span></a>. В данном случае, используемые флаги указывают, что объект выбора должен быть представлен в модели независимо от предыдущего состояния выбора. Результирующий выбор отображается представлением.</p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1285486692.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выбор элементов может быть изменен с помощью различных операций, определяемых флагами выбора. Выбор, образующийся в результате этих действий, может иметь сложную структуру, но будет эффективно представлен моделью выбора. Использование различных флагов для изменения выбора элементов будет показано при описании обновления выбора. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Чтение состояния выбора</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модельные индексы, хранящиеся в модели выбора, могут быть прочитаны с помощью функции <a href="qitemselectionmodel.html#selectedIndexes"><span style=" text-decoration: underline; color:#0057ae;">selectedIndexes()</span></a>. Она возвращает несортированный список модельных индексов, который мы можем перебирать не задумываясь о том, к какой модели они относятся:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qmodelindex.html#QModelIndexList-typedef"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndexList</span></a><span style=" font-family:'Courier New,courier';"> indexes = selectionModel-&gt;selectedIndexes();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> index;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     foreach(index, indexes) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         </span><a href="qstring.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QString</span></a><span style=" font-family:'Courier New,courier';"> text = </span><a href="qstring.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QString</span></a><span style=" font-family:'Courier New,courier';">(&quot;(%1,%2)&quot;).arg(index.row()).arg(index.column());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         model-&gt;setData(index, text);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В вышеприведенном коде Qt для перебора индексов, возвращаемых моделью выбора, и изменения соответствующих им элементов используется удобная <a href="containers.html"><span style=" text-decoration: underline; color:#0057ae;">конструкция foreach</span></a>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модель выбора испускает сигналы, сообщающие об изменениях в выборе. Они уведомляют другие компоненты как об изменениях модели выбора в целом, так и об изменениях элемента модели, имеющего в данным момент фокус. Мы можем соединить сигнал <a href="qitemselectionmodel.html#selectionChanged"><span style=" text-decoration: underline; color:#0057ae;">selectionChanged()</span></a> со слотом и исследовать вновь выбранные элементы или элементы, которые при изменении выбора сделаны невыбранными. Слот вызывается с двумя объектами <a href="qitemselection.html"><span style=" text-decoration: underline; color:#0057ae;">QItemSelection</span></a>: один содержит список индексов, соответствующих выбранным элементам; другой содержит список индексов, соответствующих элементам, выбор которых был отменен.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В следующем коде мы предоставим слот, который получает сигнал <a href="qitemselectionmodel.html#selectionChanged"><span style=" text-decoration: underline; color:#0057ae;">selectionChanged()</span></a>, заполняет строку выделенными элементами и очищает содержимое элементов, выбор которых отменен.</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> void MainWindow::updateSelection(const </span><a href="qitemselection.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QItemSelection</span></a><span style=" font-family:'Courier New,courier';"> &amp;selected,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     const </span><a href="qitemselection.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QItemSelection</span></a><span style=" font-family:'Courier New,courier';"> &amp;deselected)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> index;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qmodelindex.html#QModelIndexList-typedef"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndexList</span></a><span style=" font-family:'Courier New,courier';"> items = selected.indexes();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     foreach (index, items) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         </span><a href="qstring.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QString</span></a><span style=" font-family:'Courier New,courier';"> text = </span><a href="qstring.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QString</span></a><span style=" font-family:'Courier New,courier';">(&quot;(%1,%2)&quot;).arg(index.row()).arg(index.column());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         model-&gt;setData(index, text);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     items = deselected.indexes();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     foreach (index, items)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         model-&gt;setData(index, &quot;&quot;);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Мы можем отследить изменение фокуса элементов внутри модели, соединив сигнал <a href="qitemselectionmodel.html#currentChanged"><span style=" text-decoration: underline; color:#0057ae;">currentChanged()</span></a> со слотом, вызываемым с двумя модельными индексами. Эти индексы соответствуют элементу, имевшему фокус раньше, и элементу, имеющему фокус в данный момент.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В следующем коде мы предоставляем слот, получающий сигнал <a href="qitemselectionmodel.html#currentChanged"><span style=" text-decoration: underline; color:#0057ae;">currentChanged()</span></a> и использующий информацию, им предоставляемую, для обновления панели состояния <a href="qmainwindow.html"><span style=" text-decoration: underline; color:#0057ae;">QMainWindow</span></a>:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> void MainWindow::changeCurrent(const </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> &amp;current,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     const </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> &amp;previous)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     statusBar()-&gt;showMessage(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         tr(&quot;Moved from (%1,%2) to (%3,%4)&quot;)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">             .arg(previous.row()).arg(previous.column())</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">             .arg(current.row()).arg(current.column()));</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">С помощью этих сигналов контролируется выбор, сделанный пользователем, но мы можем изменять модель выбора непосредственно. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Обновление выбора</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Команды выбора специфицируются комбинацией флагов выбора, определенной как <a href="qitemselectionmodel.html#SelectionFlag-enum"><span style=" text-decoration: underline; color:#0057ae;">QItemSelectionModel::SelectionFlag</span></a>. Каждый из флагов выбора указывает модели выбора, как изменять внутренний набор уже выбранных элементов при каждом вызове функции <a href="qitemselection.html#select"><span style=" text-decoration: underline; color:#0057ae;">select()</span></a>. Наиболее часто используется флаг <a href="qitemselectionmodel.html#SelectionFlag-enum"><span style=" text-decoration: underline; color:#0057ae;">Select</span></a>, который указывает модели выбора запомнить выбранные элементы именно так, как они были выбраны. Флаг <a href="qitemselectionmodel.html#SelectionFlag-enum"><span style=" text-decoration: underline; color:#0057ae;">Toggle</span></a> указывает модели выбора инвертировать состояние выбора всех указанных элементов, т.е. невыбранные элементы сделать выбранными, а выбранные сделать невыбранными. Флаг <a href="qitemselectionmodel.html#SelectionFlag-enum"><span style=" text-decoration: underline; color:#0057ae;">Deselect</span></a> делает все указанные элементы невыбранными.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Отдельные элементы модели выбора обновляются с помощью создания выбора элементов и применения его к модели выбора. В следующем коде мы применяем второй выбор элементов к показанной выше табличной модели, используя команду <a href="qitemselectionmodel.html#SelectionFlag-enum"><span style=" text-decoration: underline; color:#0057ae;">Toggle</span></a> для инвертирования состояния выбора указанных элементов.</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qitemselection.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QItemSelection</span></a><span style=" font-family:'Courier New,courier';"> toggleSelection;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     topLeft = model-&gt;index(2, 1, </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';">());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     bottomRight = model-&gt;index(7, 3, </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';">());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     toggleSelection.select(topLeft, bottomRight);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     selectionModel-&gt;select(toggleSelection, </span><a href="qitemselectionmodel.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QItemSelectionModel</span></a><span style=" font-family:'Courier New,courier';">::Toggle);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Результат этого действия показан в табличном представлении, обеспечивающем хорошую визуализацию наших достижений:</p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1822595597.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">По умолчанию команды выбора работают только с элементами заданными модельными индексами. Однако флаг, используемый для описания команды выбора, может использоваться совместно с дополнительными флагами для изменения строк и столбцов. Например, если вы вызываете <a href="qitemselectionmodel.html#select"><span style=" text-decoration: underline; color:#0057ae;">select()</span></a> только с одним индексом, но с командой, которая является комбинацией флагов <a href="qitemselectionmodel.html#SelectionFlag-enum"><span style=" text-decoration: underline; color:#0057ae;">Select</span></a> и <a href="qitemselectionmodel.html#SelectionFlag-enum"><span style=" text-decoration: underline; color:#0057ae;">Rows</span></a>, то будет выбрана строка, содержащая элемент, на который ссылается модельный индекс. Следующий код показывает использование флагов <a href="qitemselectionmodel.html#SelectionFlag-enum"><span style=" text-decoration: underline; color:#0057ae;">Rows</span></a> и <a href="qitemselectionmodel.html#SelectionFlag-enum"><span style=" text-decoration: underline; color:#0057ae;">Columns</span></a>:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qitemselection.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QItemSelection</span></a><span style=" font-family:'Courier New,courier';"> columnSelection;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     topLeft = model-&gt;index(0, 1, </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';">());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     bottomRight = model-&gt;index(0, 2, </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';">());</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     columnSelection.select(topLeft, bottomRight);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     selectionModel-&gt;select(columnSelection,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         </span><a href="qitemselectionmodel.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QItemSelectionModel</span></a><span style=" font-family:'Courier New,courier';">::Select | </span><a href="qitemselectionmodel.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QItemSelectionModel</span></a><span style=" font-family:'Courier New,courier';">::Columns);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qitemselection.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QItemSelection</span></a><span style=" font-family:'Courier New,courier';"> rowSelection;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     topLeft = model-&gt;index(0, 0, </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';">());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     bottomRight = model-&gt;index(1, 0, </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';">());</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     rowSelection.select(topLeft, bottomRight);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     selectionModel-&gt;select(rowSelection,</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         </span><a href="qitemselectionmodel.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QItemSelectionModel</span></a><span style=" font-family:'Courier New,courier';">::Select | </span><a href="qitemselectionmodel.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QItemSelectionModel</span></a><span style=" font-family:'Courier New,courier';">::Rows);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Несмотря на то, что модели выбора передано только четыре индекса, использование флагов выбора <a href="qitemselectionmodel.html#SelectionFlag-enum"><span style=" text-decoration: underline; color:#0057ae;">Columns</span></a> и <a href="qitemselectionmodel.html#SelectionFlag-enum"><span style=" text-decoration: underline; color:#0057ae;">Rows</span></a> приводит к тому, что выбираются два столбца и две строки. На следующем рисунке показан результат этого действия:</p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1260867166.png" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Команды, выполнявшиеся на нашей демонстрационной модели, привели к большому количеству выбранных элементов в ней. Возможно отменить выбор всех элементов, или полностью заменить текущий выбор элементов на новый.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для замены текущего выбора новым, комбинируйте флаги выбора с флагом <a href="qitemselectionmodel.html#SelectionFlag-enum"><span style=" text-decoration: underline; color:#0057ae;">Current</span></a>. Команда, использующая этот флаг, указывает, что модель выбора должна заменить свой текущий набор модельных индексов на тот, что указан при вызове <a href="qitemselectionmodel.html#select"><span style=" text-decoration: underline; color:#0057ae;">select()</span></a>. Для удаления прежнего выбора прежде, чем вы сделаете новый, используйте другие флаги выбора совместно с флагом <a href="qitemselectionmodel.html#SelectionFlag-enum"><span style=" text-decoration: underline; color:#0057ae;">Clear</span></a>. Это приведет к переустановке набора модельных индексов модели выбора. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Выбор всех элементов в модели</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для выбора всех элементов модели, необходимо создать выбор для каждого из уровней модели, охватывающий все элементы этого уровня. Мы делаем это, восстанавливая индексы соответствующие левому верхнему и правому нижнему элементам заданного родительского индекса:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> topLeft = model-&gt;index(0, 0, parent);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> bottomRight = model-&gt;index(model-&gt;rowCount(parent)-1,</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         model-&gt;columnCount(parent)-1, parent);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выбор создается с этими индексами и моделью. При этом будут выбраны соответствующие элементы модели выбора:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qitemselection.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QItemSelection</span></a><span style=" font-family:'Courier New,courier';"> selection(topLeft, bottomRight);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     selectionModel-&gt;select(selection, </span><a href="qitemselectionmodel.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QItemSelectionModel</span></a><span style=" font-family:'Courier New,courier';">::Select);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Это должно быть сделано для всех уровней модели. Родительский индекс для элементов верхнего уровня мы определяем обычным образом:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> parent = </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';">();</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В иерархических моделях для определения, является ли заданный элемент родительским для элементов более низкого уровня используется функция <a href="qabstractitemmodel.html#hasChildren"><span style=" text-decoration: underline; color:#0057ae;">hasChildren()</span></a>. </p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; font-weight:600;">Создание новых моделей</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Разделение функциональных возможностей между компонентами архитектуры модель/представление позволяет создавать новые модели, способные использовать преимущества существующих представлений. Такой подход позволяет представлять данные из разнообразных источников, используя стандартные графические компоненты пользовательского интерфейса, такие как <a href="qlistview.html"><span style=" text-decoration: underline; color:#0057ae;">QListView</span></a>, <a href="qtableview.html"><span style=" text-decoration: underline; color:#0057ae;">QTableView</span></a> и <a href="qtreeview.html"><span style=" text-decoration: underline; color:#0057ae;">QTreeView</span></a>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Класс <a href="qabstractitemmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel</span></a> предоставляет интерфейс, который достаточно гибок для поддержки источников данных, хранящих информацию в иерархических структурах, позволяющих вставлять, удалять и изменять данные, или сортировать их различными способами. А также предоставляет поддержку операций перетаскивания (drag and drop).</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Классы <a href="qabstractlistmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractListModel</span></a> и <a href="qabstracttablemodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractTableModel</span></a> предоставляют поддержку интерфейсов для более простых неиерархических структур данных, и более легки для использования в качестве отправной точки для простых моделей списков и таблиц.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В этом разделе мы создадим простую модель только-для-чтения для исследования основных принципов архитектуры модель/представление. Позже в этом разделе, мы приспособим эту модель для того, чтобы данные могли быть изменены пользователем.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для получения примера более сложной модели, смотрите пример <a href="itemviews-simpletreemodel.html"><span style=" text-decoration: underline; color:#0057ae;">Простая модель дерева</span></a>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Минимальные требования, которым должны удовлетворять подклассы <a href="qabstractitemmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel</span></a>, описаны в документе <a href="model-view-programming.html#model-subclassing-reference"><span style=" text-decoration: underline; color:#0057ae;">Создание собственных моделей</span></a>. </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Разработка модели</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При создании новой модели для существующей структуры данных очень важно решить, какой тип модели лучше всего подходит для обеспечения интерфейса к данным. Если структура данных может быть определена как список или таблица элементов, вы можете создать подкласс <a href="qabstractlistmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractListModel</span></a> или <a href="qabstracttablemodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractTableModel</span></a>, так как эти классы предоставляют подходящие реализации функций по умолчанию.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Однако, если базовая структура данных может быть представлена только в виде иерархической древовидной структуры, возникает необходимость в создании подкласса <a href="qabstractitemmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel</span></a>. Такой подход показан в примере <a href="itemviews-simpletreemodel.html"><span style=" text-decoration: underline; color:#0057ae;">Простая модель дерева</span></a>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В этом разделе мы реализуем простую модель, основанную на списке строк, для создания которой идеальной основой является класс <a href="qabstractlistmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractListModel</span></a>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Безотносительно формы, которую принимает основная структура данных, хорошим тоном в специализированных моделях является добавление стандартного API <a href="qabstractitemmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel</span></a> к тому, который предоставляет более естественный доступ к структуре данных. Это облегчает заполнение модели данными, но кроме того позволяет другим компонентам архитектуры модель/представление взаимодействовать с моделью, используя стандартный API. Нижеприведенная модель предоставляет пользовательский конструктор исключительно с этой целью. </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Пример модели только-для-чтения</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Реализованная здесь модель - это простая неиерархическая модель только-для-чтения, основанная на стандартном классе <a href="qstringlistmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QStringListModel</span></a>. Она имеет <a href="qstringlist.html"><span style=" text-decoration: underline; color:#0057ae;">QStringList</span></a> в качестве внутреннего хранилища данных и реализует лишь самое необходимое для функционирования модели. Для облегчения реализации, мы создаем подкласс <a href="qabstractlistmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractListModel</span></a> так как он определяет удобное поведение по умолчанию для моделей списков и предоставляет более простой интерфейс, чем класс <a href="qabstractitemmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel</span></a>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При реализации модели следует помнить, что <a href="qabstractitemmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel</span></a> не хранит данных, он лишь предоставляет интерфейс, используемый представлениями для доступа к данным. Для минимальной модели только-для-чтения, необходимы реализации лишь нескольких функций, которые предоставлены по умолчанию для большинства интерфейсов. Декларация класса следующая:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> class StringListModel : public </span><a href="qabstractlistmodel.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QAbstractListModel</span></a></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     Q_OBJECT</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> public:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     StringListModel(const </span><a href="qstringlist.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QStringList</span></a><span style=" font-family:'Courier New,courier';"> &amp;strings, </span><a href="qobject.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QObject</span></a><span style=" font-family:'Courier New,courier';"> *parent = 0)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         : </span><a href="qabstractlistmodel.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QAbstractListModel</span></a><span style=" font-family:'Courier New,courier';">(parent), stringList(strings) {}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     int rowCount(const </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> &amp;parent = </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';">()) const;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qvariant.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QVariant</span></a><span style=" font-family:'Courier New,courier';"> data(const </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> &amp;index, int role) const;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qvariant.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QVariant</span></a><span style=" font-family:'Courier New,courier';"> headerData(int section, </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::Orientation orientation,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">                         int role = </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::DisplayRole) const;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> private:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qstringlist.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QStringList</span></a><span style=" font-family:'Courier New,courier';"> stringList;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> };</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Кроме конструктора модели, мы должны реализовать только две функции: <a href="qabstractitemmodel.html#rowCount"><span style=" text-decoration: underline; color:#0057ae;">rowCount()</span></a>, возвращающую количество строк в модели, и <a href="qabstractitemmodel.html#data"><span style=" text-decoration: underline; color:#0057ae;">data()</span></a>, возвращающую элемент данных, соответствующий определенному модельному индексу.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Хорошо работающие модели также реализуют <a href="qabstractitemmodel.html#headerData"><span style=" text-decoration: underline; color:#0057ae;">headerData()</span></a> для получения представлениями деревьев и таблиц чего-либо для отображения в их заголовках.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обратите внимание на то, что это неиерархическая модель, поэтому мы не должны беспокоиться о родительско-дочерних отношениях. Если наша модель иерархическая, мы также должны реализовать функции <a href="qabstractitemmodel.html#index"><span style=" text-decoration: underline; color:#0057ae;">index()</span></a> и <a href="qabstractitemmodel.html#parent"><span style=" text-decoration: underline; color:#0057ae;">parent()</span></a>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Список строк хранится в закрытой переменной-члене <span style=" font-family:'Courier New,courier';">stringList</span>. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Измерения модели</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Мы хотим, чтобы количество строк в модели было таким же, что и количество элементов в списке строк. Помня об этом, мы реализуем функцию <a href="qabstractitemmodel.html#rowCount"><span style=" text-decoration: underline; color:#0057ae;">rowCount()</span></a>:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> int StringListModel::rowCount(const </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> &amp;parent) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     return stringList.count();</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Так как модель неиерархическая, мы можем спокойно игнорировать модельный индекс, соответствующий родительскому элементу. По умолчанию, модели, производные от <a href="qabstractlistmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractListModel</span></a>, содержат только один столбец, поэтому нам не нужно переопределять функцию <a href="qabstractitemmodel.html#columnCount"><span style=" text-decoration: underline; color:#0057ae;">columnCount()</span></a>. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Заголовки и данные модели</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В качестве элементов в представлении мы хотим возвратить строки из списка строк. Функция <a href="qabstractitemmodel.html#data"><span style=" text-decoration: underline; color:#0057ae;">data()</span></a> ответственна за возвращение элемента данных, соответствующего аргументу-индексу:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> </span><a href="qvariant.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QVariant</span></a><span style=" font-family:'Courier New,courier';"> StringListModel::data(const </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> &amp;index, int role) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     if (!index.isValid())</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         return </span><a href="qvariant.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QVariant</span></a><span style=" font-family:'Courier New,courier';">();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     if (index.row() &gt;= stringList.size())</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         return </span><a href="qvariant.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QVariant</span></a><span style=" font-family:'Courier New,courier';">();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     if (role == </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::DisplayRole)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         return stringList.at(index.row());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         return </span><a href="qvariant.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QVariant</span></a><span style=" font-family:'Courier New,courier';">();</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если переданный модельный индекс валиден, номер строки находится в пределах диапазона значений списка строк и требуемая роль нами поддерживается, мы возвращаем валидный <a href="qvariant.html"><span style=" text-decoration: underline; color:#0057ae;">QVariant</span></a>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Некоторые представления, такие как <a href="qtreeview.html"><span style=" text-decoration: underline; color:#0057ae;">QTreeView</span></a> и <a href="qtableview.html"><span style=" text-decoration: underline; color:#0057ae;">QTableView</span></a>, могут отображать заголовки наряду с элементами данных. Если наша модель отображается в представлении с заголовками, мы хотим, чтобы заголовки содержали номера строк и столбцов. Мы можем предоставить информацию о заголовках реализовав функцию <a href="qabstractitemmodel.html#headerData"><span style=" text-decoration: underline; color:#0057ae;">headerData()</span></a>:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> </span><a href="qvariant.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QVariant</span></a><span style=" font-family:'Courier New,courier';"> StringListModel::headerData(int section, </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::Orientation orientation,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">                                      int role) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     if (role != </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::DisplayRole)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         return </span><a href="qvariant.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QVariant</span></a><span style=" font-family:'Courier New,courier';">();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     if (orientation == </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::Horizontal)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         return </span><a href="qstring.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QString</span></a><span style=" font-family:'Courier New,courier';">(&quot;Column %1&quot;).arg(section);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         return </span><a href="qstring.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QString</span></a><span style=" font-family:'Courier New,courier';">(&quot;Row %1&quot;).arg(section);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">И снова мы возвращаем валидный <a href="qvariant.html"><span style=" text-decoration: underline; color:#0057ae;">QVariant</span></a> только в том случае, если роль поддерживается. При решении, что должно быть возвращено, также принимается во внимание ориентация заголовка.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Не все представления отображают заголовки с элементами данных, и они могут быть настроены для сокрытия заголовков. Тем не менее, рекомендуется реализовывать функцию <a href="qabstractitemmodel.html#headerData"><span style=" text-decoration: underline; color:#0057ae;">headerData()</span></a> для предоставления важной информации о данных, предоставляемых моделью.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Элемент может иметь несколько ролей, предоставляя различные данные в зависимости от указанной роли. Элементы нашей модели имеют только одну роль, <a href="qt.html#ItemDataRole-enum"><span style=" text-decoration: underline; color:#0057ae;">DisplayRole</span></a>, так что мы возвращаем данные элемента независимо от указанной роли. Однако, данные, предоставляемые для роли <a href="qt.html#ItemDataRole-enum"><span style=" text-decoration: underline; color:#0057ae;">DisplayRole</span></a>, мы может повторно использовать в других ролях, таких как <a href="qt.html#ItemDataRole-enum"><span style=" text-decoration: underline; color:#0057ae;">ToolTipRole</span></a>, которую представления могут использовать для отображения информации об элементе во всплывающей подсказке. </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Редактируемая модель</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модель только-для-чтения показывает, насколько просто данные могут быть предоставлены пользователю, но для многих приложений гораздо полезней редактируемая модель списка. Мы можем модифицировать модель только-для-чтения и сделать элементы редактируемыми изменив функцию data(), реализованную только для чтения, и реализовав две дополнительных функции: <a href="qabstractitemmodel.html#flags"><span style=" text-decoration: underline; color:#0057ae;">flags()</span></a> и <a href="qabstractitemmodel.html#setData"><span style=" text-decoration: underline; color:#0057ae;">setData()</span></a>. Добавляем декларации следующих функций в определение класса:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::ItemFlags flags(const </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> &amp;index) const;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     bool setData(const </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> &amp;index, const </span><a href="qvariant.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QVariant</span></a><span style=" font-family:'Courier New,courier';"> &amp;value,</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">                  int role = </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::EditRole); </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Создание редактируемой модели</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Перед созданием редактора, делегат проверяет, является ли элемент редактируемым. Модель должна дать знать делегату, являются ли ее элементы редактируемыми. Мы делаем это, возвращая флаги для каждого элемента модели; в нашем случае, мы делаем доступными все элементы и позволяем им быть выбранными и редактируемыми:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::ItemFlags StringListModel::flags(const </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> &amp;index) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     if (!index.isValid())</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         return </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::ItemIsEnabled;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     return </span><a href="qabstractitemmodel.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QAbstractItemModel</span></a><span style=" font-family:'Courier New,courier';">::flags(index) | </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::ItemIsEditable;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обратите внимание на то, что нам нет надобности знать, как делегат осуществляет процесс редактирования. Мы лишь должны предоставить делегату способ занести данные в модель. Это достигается с помощью функции <a href="qabstractitemmodel.html#setData"><span style=" text-decoration: underline; color:#0057ae;">setData()</span></a>:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> bool StringListModel::setData(const </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> &amp;index,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">                               const </span><a href="qvariant.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QVariant</span></a><span style=" font-family:'Courier New,courier';"> &amp;value, int role)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     if (index.isValid() &amp;&amp; role == </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::EditRole) {</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         stringList.replace(index.row(), value.toString());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         emit dataChanged(index, index);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         return true;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     return false;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В этой модели, элемент списка строк, соответствующий модельному индексу, заменяется на предоставленное значение. Однако, прежде, чем мы изменим список строк, мы должны убедиться, что индекс валиден, элемент имеет корректный тип, а роль поддерживается. В соответствии с соглашениями, мы утверждаем, что роль - это <a href="qt.html#ItemDataRole-enum"><span style=" text-decoration: underline; color:#0057ae;">EditRole</span></a>, так как эта роль обычно используется стандартными делегатами представлений. Однако для булевых значений вы можете использовать <a href="qt.html#ItemDataRole-enum"><span style=" text-decoration: underline; color:#0057ae;">Qt::CheckStateRole</span></a> и установить флаг <a href="qt.html#ItemFlag-enum"><span style=" text-decoration: underline; color:#0057ae;">Qt::ItemIsUserCheckable</span></a>; тогда флажок будет использоваться для редактирования значения. Основные данные нашей модели одинаковы для всех ролей, это облегчает объединение модели со стандартными компонентами.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">После того, как данные установлены, модель должна дать знать представлениям, что некоторые данные изменены. Модель делает это, испуская сигнал <a href="qabstractitemmodel.html#dataChanged"><span style=" text-decoration: underline; color:#0057ae;">dataChanged()</span></a>. Так как у нас изменился только один элемент данных, указанный в сигнале диапазон элементов данных ограничен одним модельным индексом.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Также функцию data() нужно изменить, чтобы добавить проверку <a href="qt.html#ItemDataRole-enum"><span style=" text-decoration: underline; color:#0057ae;">Qt::EditRole</span></a>:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> </span><a href="qvariant.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QVariant</span></a><span style=" font-family:'Courier New,courier';"> StringListModel::data(const </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> &amp;index, int role) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     if (!index.isValid())</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         return </span><a href="qvariant.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QVariant</span></a><span style=" font-family:'Courier New,courier';">();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     if (index.row() &gt;= stringList.size())</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         return </span><a href="qvariant.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QVariant</span></a><span style=" font-family:'Courier New,courier';">();</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     if (role == </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::DisplayRole || role == </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::EditRole)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         return stringList.at(index.row());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         return </span><a href="qvariant.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QVariant</span></a><span style=" font-family:'Courier New,courier';">();</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> } </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Вставка и удаление строк</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В модели можно менять количество строк и столбцов. В модели списка строк имеет смысл изменять только количество строк, поэтому мы должны переопределить только функции для вставки и удалении строк. Они объявлены в определении класса:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     bool insertRows(int position, int rows, const </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> &amp;index = </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';">());</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     bool removeRows(int position, int rows, const </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> &amp;index = </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';">());</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Так как строки модели соответствуют строкам списка, то функция <span style=" font-family:'Courier New,courier';">insertRows()</span> вставляет нужное количество пустых строк в список перед указанной позицией. Количество вставляемых строк эквивалентно указанному количеству строк.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для определения, куда должны быть вставлены строки, обычно используется родительский индекс. В нашем случае, мы имеем один список строк верхнего уровня, поэтому мы вставляем пустые строки в этот список.</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> bool StringListModel::insertRows(int position, int rows, const </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> &amp;parent)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     beginInsertRows(</span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';">(), position, position+rows-1);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     for (int row = 0; row &lt; rows; ++row) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         stringList.insert(position, &quot;&quot;);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     endInsertRows();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     return true;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сперва, для уведомления других компонентов о том, что количество строк собирается измениться, модель вызывает функцию <a href="qabstractitemmodel.html#beginInsertRows"><span style=" text-decoration: underline; color:#0057ae;">beginInsertRows()</span></a>. Функция определяет номера первой и последней строк, которые должны быть вставлены, а также модельный индекс их родительского элемента. После изменения списка строк, модель вызывает <a href="qabstractitemmodel.html#endInsertRows"><span style=" text-decoration: underline; color:#0057ae;">endInsertRows()</span></a> для завершения операции и уведомления других компонентов о том, что изменились измерения модели, для сообщения о том, что действия выполнены успешно, возвращается true.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Функция для удаления строк из моделей также проста в написании. Строки, удаляемые из модели, задаются позицией и количеством. Для упрощения реализации, мы игнорируем родительский индекс и лишь удаляем строки из списка.</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> bool StringListModel::removeRows(int position, int rows, const </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> &amp;parent)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     beginRemoveRows(</span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';">(), position, position+rows-1);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     for (int row = 0; row &lt; rows; ++row) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         stringList.removeAt(position);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     endRemoveRows();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     return true;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Перед удалением данных всегда вызывается функция <a href="qabstractitemmodel.html#beginRemoveRows"><span style=" text-decoration: underline; color:#0057ae;">beginRemoveRows()</span></a>, которая определяет номера первой и последней удаляемых строк. Это позволяет другим компонентам получить доступ к данным, прежде чем они станут недоступны. Для завершения операции и уведомления других компонентов о том, что измерения модели изменились, после удаления строк модель испускает сигнал <a href="qabstractitemmodel.html#endRemoveRows"><span style=" text-decoration: underline; color:#0057ae;">endRemoveRows()</span></a>. </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Следующие шаги</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Мы можем отобразить данные, предоставленные моделью, используя класс <a href="qlistview.html"><span style=" text-decoration: underline; color:#0057ae;">QListView</span></a>, который показывает элементы модели в виде вертикального списка. Для модели списка строк, это представление также предоставляет редактор по умолчанию, способный управлять элементами. Возможности, предоставляемые стандартными классами представлений, мы исследуем в <a href="model-view-programming.html#view-classes"><span style=" text-decoration: underline; color:#0057ae;">Классах представлений</span></a>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В документе <a href="model-view-programming.html#model-subclassing-reference"><span style=" text-decoration: underline; color:#0057ae;">Создание собственных моделей</span></a> требования к наследуемым от <a href="qabstractitemmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel</span></a> классам обсуждаются более подробно и предоставляется руководство по виртуальным функциям, которые должны быть реализованы для активирования различных возможностей в разных типах моделей. </p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; font-weight:600;">Вспомогательные классы представления элементов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Qt 4 также вводит стандартные виджеты, реализующие классические основанные на элементах контейнеры. Они ведут себя подобно классам представлений элементов Qt 3, но переписаны с целью производительности и удобства сопровождения для использования с базовым каркасом модель/представление. Старые классы представлений элементов всё ещё доступны в библиотеке совместимости (дополнительную информацию смотрите в <a href="porting4.html"><span style=" text-decoration: underline; color:#0057ae;">Руководстве по переносу кода</span></a>).</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Основанные на элементах виджеты имеют имена, отражающие их назначение: <span style=" font-family:'Courier New,courier';">QListWidget</span> предоставляет список элементов, <span style=" font-family:'Courier New,courier';">QTreeWidget</span> отображает многоуровневую древовидную структуру, а <span style=" font-family:'Courier New,courier';">QTableWidget</span> предоставляет таблицу с ячейками. Каждый из этих классов наследует поведение класса <span style=" font-family:'Courier New,courier';">QAbstractItemView</span>, который реализует общее поведение выбора элементов и управления заголовками. </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Виджеты-cписки</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Одноуровневые списки элементов обычно отображаются с помощью <span style=" font-family:'Courier New,courier';">QListWidget</span> и множества <span style=" font-family:'Courier New,courier';">QListWidgetItem</span>. Виджет-список создается тем же образом, что и любой другой виджет:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     QListWidget *listWidget = new QListWidget(this);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Элементы списка могут быть добавлены в виджет-список непосредственно при создании:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     new </span><a href="qlistwidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QListWidgetItem</span></a><span style=" font-family:'Courier New,courier';">(tr(&quot;Sycamore&quot;), listWidget);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     new </span><a href="qlistwidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QListWidgetItem</span></a><span style=" font-family:'Courier New,courier';">(tr(&quot;Chestnut&quot;), listWidget);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     new </span><a href="qlistwidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QListWidgetItem</span></a><span style=" font-family:'Courier New,courier';">(tr(&quot;Mahogany&quot;), listWidget);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Также они могут быть созданы без родительского виджета-списка и добавлены в список позже:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qlistwidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QListWidgetItem</span></a><span style=" font-family:'Courier New,courier';"> *newItem = new </span><a href="qlistwidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QListWidgetItem</span></a><span style=" font-family:'Courier New,courier';">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     newItem-&gt;setText(itemText);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     listWidget-&gt;insertItem(row, newItem);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Каждый элемент списка может отображать текст и пиктограмму. При настройке внешнего вида элемента можно изменить цвет и шрифт, используемые для отрисовки текста. Всплывающие подсказки, текст панели состояния и подсказки &quot;What's This?&quot; легко настраиваются для того, чтобы гарантировать, что список органично впишется в приложение.</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     newItem-&gt;setToolTip(toolTipText);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     newItem-&gt;setStatusTip(toolTipText);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     newItem-&gt;setWhatsThis(whatsThisText);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">По умолчанию элементы списка отображаются в порядке их добавления в список. Списки элементов могут быть отсортированы по алфавиту или в обратном порядке в соответствии с критерием, указанным в <a href="qt.html#SortOrder-enum"><span style=" text-decoration: underline; color:#0057ae;">Qt::SortOrder</span></a>:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     listWidget-&gt;sortItems(</span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::AscendingOrder);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     listWidget-&gt;sortItems(</span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::DescendingOrder); </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Виджеты-деревья</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Деревья или иерархические списки элементов предоставляются с помощью классов <span style=" font-family:'Courier New,courier';">QTreeWidget</span> и <span style=" font-family:'Courier New,courier';">QTreeWidgetItem</span>. Каждый элемент виджета-дерева может иметь свои собственные дочерние элементы и отображать данные в нескольких столбцах. Виджеты-деревья создаются точно также, как и другие виджеты:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     QTreeWidget *treeWidget = new QTreeWidget(this);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Прежде, чем добавлять элементы в виджет-дерево, должно быть установлено количество столбцов. Например, мы можем определить два столбца и создать текстовые метки для отображения заголовков наверху каждого столбца:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     treeWidget-&gt;setColumnCount(2);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qstringlist.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QStringList</span></a><span style=" font-family:'Courier New,courier';"> headers;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     headers &lt;&lt; tr(&quot;Subject&quot;) &lt;&lt; tr(&quot;Default&quot;);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     treeWidget-&gt;setHeaderLabels(headers);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Самый легкий способ настроить надписи для каждой секции состоит в создании списка строк. Для более сложных заголовков вы можете создать элемент дерева, оформить его и использовать в качестве заголовка виджета-дерева.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Элементы верхнего уровня виджета-дерева создаются с виджетом-деревом в качестве родителя. Они могут быть вставлены в произвольном порядке, или вы можете определить порядок, указав при создании элемента предшествующий элемент:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qtreewidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTreeWidgetItem</span></a><span style=" font-family:'Courier New,courier';"> *cities = new </span><a href="qtreewidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTreeWidgetItem</span></a><span style=" font-family:'Courier New,courier';">(treeWidget);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     cities-&gt;setText(0, tr(&quot;Cities&quot;));</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qtreewidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTreeWidgetItem</span></a><span style=" font-family:'Courier New,courier';"> *osloItem = new </span><a href="qtreewidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTreeWidgetItem</span></a><span style=" font-family:'Courier New,courier';">(cities);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     osloItem-&gt;setText(0, tr(&quot;Oslo&quot;));</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     osloItem-&gt;setText(1, tr(&quot;Yes&quot;));</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qtreewidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTreeWidgetItem</span></a><span style=" font-family:'Courier New,courier';"> *planets = new </span><a href="qtreewidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTreeWidgetItem</span></a><span style=" font-family:'Courier New,courier';">(treeWidget, cities);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Виджеты-деревья с элементами верхнего уровня обращаются несколько иначе, чем с элементами, находящимися в глубине иерархии. Элементы верхнего уровня могут быть удалены из дерева с помощью вызова функции виджета-дерева <a href="qtreewidget.html#takeTopLevelItem"><span style=" text-decoration: underline; color:#0057ae;">takeTopLevelItem()</span></a>, а элементы более низких уровней удаляются с помощью вызова функции <a href="qtreewidgetitem.html#takeChild"><span style=" text-decoration: underline; color:#0057ae;">takeChild()</span></a> их родительского элемента. На верхний уровень древовидной структуры элементы могут быть вставлены с помощью функции <a href="qtreewidget.html#insertTopLevelItem"><span style=" text-decoration: underline; color:#0057ae;">insertTopLevelItem()</span></a>. На более низких уровнях используется функция <a href="qtreewidgetitem.html#insertChild"><span style=" text-decoration: underline; color:#0057ae;">insertChild()</span></a> родительского элемента.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Элементы легко перемещаются между самым верхним и более низкими уровнями дерева. Нам требуется лишь проверить, являются ли эти элементы элементами верхнего уровня или нет. Эту информацию можно получить с помощью функции <span style=" font-family:'Courier New,courier';">parent()</span> элемента. Например, мы можем удалить текущий элемент виджета-дерева вне зависимости от его расположения:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qtreewidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTreeWidgetItem</span></a><span style=" font-family:'Courier New,courier';"> *parent = currentItem-&gt;parent();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     int index;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     if (parent) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         index = parent-&gt;indexOfChild(treeWidget-&gt;currentItem());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         delete parent-&gt;takeChild(index);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     } else {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         index = treeWidget-&gt;indexOfTopLevelItem(treeWidget-&gt;currentItem());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         delete treeWidget-&gt;takeTopLevelItem(index);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вставка элемента куда-нибудь в виджет-дерево осуществляется подобным образом:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qtreewidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTreeWidgetItem</span></a><span style=" font-family:'Courier New,courier';"> *parent = currentItem-&gt;parent();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qtreewidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTreeWidgetItem</span></a><span style=" font-family:'Courier New,courier';"> *newItem;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     if (parent)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         newItem = new </span><a href="qtreewidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTreeWidgetItem</span></a><span style=" font-family:'Courier New,courier';">(parent, treeWidget-&gt;currentItem());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     else</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         newItem = new </span><a href="qtreewidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTreeWidgetItem</span></a><span style=" font-family:'Courier New,courier';">(treeWidget, treeWidget-&gt;currentItem()); </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Виджеты-таблицы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Таблицы элементов, подобные тем которые предоставляются табличными редакторами, создаются с помощью <span style=" font-family:'Courier New,courier';">QTableWidget</span> и <span style=" font-family:'Courier New,courier';">QTableWidgetItem</span>. Они предоставляют прокручиваемую таблицу с заголовками и элементами в ней.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Таблицы могут создаваться сразу с нужным количеством строк и столбцов, или строки и столбцы могут добавляться по необходимости.</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qtablewidget.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTableWidget</span></a><span style=" font-family:'Courier New,courier';"> *tableWidget;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     tableWidget = new </span><a href="qtablewidget.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTableWidget</span></a><span style=" font-family:'Courier New,courier';">(12, 3, this);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Элементы создаются вне таблицы, а затем размещаются в нужном месте:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qtablewidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTableWidgetItem</span></a><span style=" font-family:'Courier New,courier';"> *newItem = new </span><a href="qtablewidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTableWidgetItem</span></a><span style=" font-family:'Courier New,courier';">(tr(&quot;%1&quot;).arg(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         pow(row, column+1)));</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     tableWidget-&gt;setItem(row, column, newItem);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Горизонтальные и вертикальные заголовки можно добавить в таблицу, создав их как элементы вне таблицы, а затем установив их в качестве заголовков:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qtablewidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTableWidgetItem</span></a><span style=" font-family:'Courier New,courier';"> *valuesHeaderItem = new </span><a href="qtablewidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTableWidgetItem</span></a><span style=" font-family:'Courier New,courier';">(tr(&quot;Values&quot;));</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     tableWidget-&gt;setHorizontalHeaderItem(0, valuesHeaderItem);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обратите внимание на то, что нумерация строк и столбцов в таблице начинается с нуля. </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Общие возможности</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">У всех вспомогательных основанных на элементах классов есть множество общих возможностей, которые доступны через один и тот же интерфейс. Мы представим их с примерами для разных виджетов в следующих разделах. Подробнее об использовании каждой из возможностей для каждого конкретного виджета смотрите <a href="model-view.html"><span style=" text-decoration: underline; color:#0057ae;">Классы модель/представление</span></a>. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Скрытые элементы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Иногда в виджете представления элементов полезно скрывать элементы, вместо того чтобы удалять их. Элементы всех виджетов могут быть скрыты, а потом вновь показаны. Определить, скрыт ли элемент, можно с помощью функции isItemHidden(), а скрыть элементы с помощью функции <span style=" font-family:'Courier New,courier';">setItemHidden()</span>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Так как эта операция воздействует на элементы, она доступна во всех трех вспомогательных классах представлений. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Выделения</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Способ, которым выделяются элементы, управляется режимом выделения виджета (<a href="qabstractitemview.html#SelectionMode-enum"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemView::SelectionMode</span></a>). Данное свойство указывает, может ли пользователь выбирать один или несколько элементов, и, если пользователь может выбирать несколько, должен ли это быть непрерывный диапазон. Режим выбора работает одинаково для всех виджетов.</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1132233828.png" style="vertical-align: top;" /> </p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Выделение единственного элемента:</span> Если пользователю нужно выбрать единственный элемент виджета, то режим по умолчанию - <span style=" font-family:'Courier New,courier';">SingleSelection</span> - наиболее подходящий. В этом режиме текущий элемент и выделенный элемент совпадают.</p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image2113450808.png" style="vertical-align: top;" /> </p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Выделение нескольких элементов:</span> В этом режиме, пользователь может изменять состояние выделения любого элемента в виджете без изменения существующего выделения, подобно тому как независимо друг от друга можно переключать флажки (checkboxes).</p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image441284582.png" style="vertical-align: top;" /> </p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Расширенное выделение:</span> Виджетам, которым часто требуется выбирать множество смежных элементов, например, электронные таблицы, требуется режим <span style=" font-family:'Courier New,courier';">ExtendedSelection</span>. В этом режиме непрерывные диапазоны элементов могут быть выделены с помощью мыши или клавиатуры. Сложные выделения, включающие множество несмежных друг-другу элементов, могут быть сделаны с помощью клавиш-модификаторов.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если пользователь выделяет элемент без использования клавиш-модификаторов, существующее выделение очищается.</p></td></tr></table>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выбранные в виджете элементы можно прочитать с помощью функции <span style=" font-family:'Courier New,courier';">selectedItems()</span>, возвращающей список соответствующих элементов, по которому можно перемещаться. Например, с помощью следующего кода мы можем найти сумму всех числовых значений выделенных элементов:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qlist.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QList</span></a><span style=" font-family:'Courier New,courier';">&lt;</span><a href="qtablewidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTableWidgetItem</span></a><span style=" font-family:'Courier New,courier';"> *&gt; selected = tableWidget-&gt;selectedItems();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qtablewidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTableWidgetItem</span></a><span style=" font-family:'Courier New,courier';"> *item;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     int number = 0;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     double total = 0;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     foreach (item, selected) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         bool ok;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         double value = item-&gt;text().toDouble(&amp;ok);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         if (ok &amp;&amp; !item-&gt;text().isEmpty()) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">             total += value;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">             number++;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         }</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Заметьте, что в режиме выделения единственного элемента, текущий элемент будет находиться в выделении. В режимах выделения нескольких элементов и расширенного выделения текущий элемент может не находиться в выделении, это зависит от способа, которым пользователь осуществляет выделение. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Поиск</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Часто бывает полезно иметь возможность найти элементы внутри представления или для разработчика, или в качестве возможности, предоставляемой пользователю. Все три вспомогательных класса представления элементов предоставляют такую возможность с помощью функции <span style=" font-family:'Courier New,courier';">findItems()</span>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Элементы ищутся по тексту, который они содержат, в соответствии с критериями, заданными набором значений <a href="qt.html#MatchFlag-enum"><span style=" text-decoration: underline; color:#0057ae;">Qt::MatchFlags</span></a>. С помощью функции <span style=" font-family:'Courier New,courier';">findItems()</span> можно получить список соответствующих элементов:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qtreewidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTreeWidgetItem</span></a><span style=" font-family:'Courier New,courier';"> *item;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qlist.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QList</span></a><span style=" font-family:'Courier New,courier';">&lt;</span><a href="qtreewidgetitem.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QTreeWidgetItem</span></a><span style=" font-family:'Courier New,courier';"> *&gt; found = treeWidget-&gt;findItems(</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         itemText, </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::MatchWildcard);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     foreach (item, found) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         treeWidget-&gt;setItemSelected(item, true);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         // Показать для каждого элемента item-&gt;text(0).</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вышеприведенный код выделяет элементы виджета-дерева, если их текст содержит заданную строку поиска. Этот пример можно использовать также в виджетах-списках и виджетах-таблицах. </p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; font-weight:600;">Использование перетаскивания (Drag and Drop) с представлениями элементов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Архитектура модель/представление полностью поддерживает инфраструктуру перетаскивания (drag and drop) Qt. Элементы списков, таблиц и деревьев можно перетаскивать внутри представлений, а их данные могут быть импортированы и экспортированы в виде закодированной в MIME информации.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Стандартные представления автоматически поддерживают внутреннюю операцию перетаскивания, когда элементы перемещаются внутри области отображения для изменения порядка их отображения. По умолчанию операция перетаскивания для этих представлений не разрешена, так как они созданы для простого, наиболее общего применения. Для того, чтобы элементы могли перетаскиваться, должны быть включены некоторые свойства представления, а самим элементам должно быть позволено перетаскиваться.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">К модели, которая позволяет только экспортировать данные из представления, предъявляются более скромные требования, чем к модели, которая позволяет перетаскивать информацию в себя и требующей полной доступности операций перетаскивания.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Смотрите также <a href="model-view-programming.html#model-subclassing-reference"><span style=" text-decoration: underline; color:#0057ae;">Создание собственных моделей</span></a> для более подробной информации о поддержке перетаскивания в новых моделях. </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Использование вспомогательных представлений</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Каждый тип элементов, используемых в <a href="qlistwidget.html"><span style=" text-decoration: underline; color:#0057ae;">QListWidget</span></a>, <a href="qtablewidget.html"><span style=" text-decoration: underline; color:#0057ae;">QTableWidget</span></a> и <a href="qtreewidget.html"><span style=" text-decoration: underline; color:#0057ae;">QTreeWidget</span></a>, настроен для использования разных наборов флагов по умолчанию. Например, каждый объект <a href="qlistwidgetitem.html"><span style=" text-decoration: underline; color:#0057ae;">QListWidgetItem</span></a> или <a href="qtreewidgetitem.html"><span style=" text-decoration: underline; color:#0057ae;">QTreeWidgetItem</span></a> изначально доступен, переключаем, выбираем и может использоваться как источник для операции перетаскивания; каждый объект <a href="qtablewidgetitem.html"><span style=" text-decoration: underline; color:#0057ae;">QTableWidgetItem</span></a> также может быть редактируемым и использоваться как приемник операции перетаскивания.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Несмотря на то, что все стандартные элементы имеют один или оба установленных флага поддержки перетаскивания, вам, как правило, требуется установить различные свойства самого представления для того, чтобы воспользоваться возможностями встроенной поддержки операций перетаскивания:</p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для разрешения перетаскивания элементов, установите свойство представления <a href="qabstractitemview.html#dragEnabled-prop"><span style=" text-decoration: underline; color:#0057ae;">dragEnabled</span></a> в значение <span style=" font-family:'Courier New,courier';">true</span>.</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы разрешить пользователю отпускать внутренние и внешние элементы внутри представления, установите свойство <a href="qabstractscrollarea.html#viewport"><span style=" text-decoration: underline; color:#0057ae;">viewport()</span></a> представления <a href="qwidget.html#acceptDrops-prop"><span style=" text-decoration: underline; color:#0057ae;">acceptDrops</span></a> в значение <span style=" font-family:'Courier New,courier';">true</span>.</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы показывать пользователю, куда будет помещен при отпускании перетаскиваемый в настоящий момент элемент, установите свойство представления <a href="qabstractitemview.html#showDropIndicator-prop"><span style=" text-decoration: underline; color:#0057ae;">showDropIndicator</span></a>. Это позволит предоставлять пользователю непрерывно обновляемую информацию о размещении элемента внутри представления.</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Например, с помощью следующих строк кода можно включить использование операции перетаскивания в виджете-списке:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> </span><a href="qlistwidget.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QListWidget</span></a><span style=" font-family:'Courier New,courier';"> *listWidget = new </span><a href="qlistwidget.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QListWidget</span></a><span style=" font-family:'Courier New,courier';">(this);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> listWidget-&gt;setSelectionMode(</span><a href="qabstractitemview.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QAbstractItemView</span></a><span style=" font-family:'Courier New,courier';">::SingleSelection);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> listWidget-&gt;setDragEnabled(true);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> listWidget-&gt;viewport()-&gt;setAcceptDrops(true);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> listWidget-&gt;setDropIndicatorShown(true);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В результате виджет-список позволит элементам быть скопированным в пределах области отображения и даже быть перемещенными в виджеты, содержащие данные такого же типа. В обоих случаях, элементы будут скорее скопированы, чем перемещены.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы разрешить пользователю свободно перемещать элементы внутри представления нужно установить <a href="qabstractitemview.html#dragDropMode-prop"><span style=" text-decoration: underline; color:#0057ae;">dragDropMode</span></a> виджета-списка:</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> listWidget-&gt;setDragDropMode(</span><a href="qabstractitemview.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QAbstractItemView</span></a><span style=" font-family:'Courier New,courier';">::InternalMove); </span></p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Использование классов модель/представление</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Настройка представления для использования операции перетаскивания происходит тем же образом, что и настройка традиционных представлений. Например, <a href="qlistview.html"><span style=" text-decoration: underline; color:#0057ae;">QListView</span></a> может быть настроен точно также, как и <a href="qlistwidget.html"><span style=" text-decoration: underline; color:#0057ae;">QListWidget</span></a>:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> </span><a href="qlistview.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QListView</span></a><span style=" font-family:'Courier New,courier';"> *listView = new </span><a href="qlistview.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QListView</span></a><span style=" font-family:'Courier New,courier';">(this);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> listView-&gt;setSelectionMode(</span><a href="qabstractitemview.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QAbstractItemView</span></a><span style=" font-family:'Courier New,courier';">::ExtendedSelection);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> listView-&gt;setDragEnabled(true);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> listView-&gt;setAcceptDrops(true);</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> listView-&gt;setDropIndicatorShown(true);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Так как доступ к отображаемым представлением данным управляется моделью, используемая модель также должна предоставлять поддержку операций перетаскивания. Действия, поддерживаемые моделью, можно задать переопределив функцию <a href="qabstractitemmodel.html#supportedDropActions"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel::supportedDropActions</span></a>(). Например, с помощью следующего кода можно сделать доступными операции копирования и перемещения:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::DropActions DragDropListModel::supportedDropActions() const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     return </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::CopyAction | </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::MoveAction;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модели можно передать любую комбинацию значений <a href="qt.html#DropAction-enum"><span style=" text-decoration: underline; color:#0057ae;">Qt::DropActions</span></a>, но их поддержку моделью необходимо прописать. Например, для использования <a href="qt.html#DropAction-enum"><span style=" text-decoration: underline; color:#0057ae;">Qt::MoveAction</span></a> должным образом моделью списка, модель должна иметь реализацию <a href="qabstractitemmodel.html#removeRows"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel::removeRows</span></a>() или непосредственно, или унаследовав ее от базового класса. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Разрешение применения перетаскивания к элементам</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Указать представлению, какие элементы можно перетаскивать, а на какие можно отпустить, модели могут с помощью переопределения функции <a href="qabstractitemmodel.html#flags"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel::flags</span></a>(), предоставляющей соответствующие флаги.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Например, модель, предоставляющая простой список, основанный на <a href="qabstractlistmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractListModel</span></a>, может позволить использование операции перетаскивания для каждого элемента, гарантируя, что возвращаемые флаги содержат значения <a href="qt.html#ItemFlag-enum"><span style=" text-decoration: underline; color:#0057ae;">Qt::ItemIsDragEnabled</span></a> и Qt::<a href="qt.html#ItemFlag-enum"><span style=" text-decoration: underline; color:#0057ae;">Qt::ItemIsDropEnabled</span></a>:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::ItemFlags DragDropListModel::flags(const </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> &amp;index) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::ItemFlags defaultFlags = </span><a href="qstringlistmodel.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QStringListModel</span></a><span style=" font-family:'Courier New,courier';">::flags(index);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     if (index.isValid())</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         return </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::ItemIsDragEnabled | </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::ItemIsDropEnabled | defaultFlags;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         return </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::ItemIsDropEnabled | defaultFlags;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обратите внимание на то, что отпускание позволяется только на верхнем уровне модели, а перетаскивание позволяется только для действительных элементов.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Так как модель унаследована от <a href="qstringlistmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QStringListModel</span></a>, то в вышеприведенном коде мы получили набор флагов по умолчанию вызвав ее реализацию функции flags(). </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Кодирование экспортируемых данных</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При экспортировании элементов данных из модели в операцию перетаскивания, они кодируются в формат, соответствующий одному или нескольким типам MIME. Модели декларируют типы MIME, которые они могут применять по отношению к элементам, с помощью переопределения функции <a href="qabstractitemmodel.html#mimeTypes"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel::mimeTypes</span></a>(), возвращающей список стандартных типов MIME.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Например, модель, которая предоставляет лишь простой текст, должна иметь следующую реализацию данной функции:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> </span><a href="qstringlist.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QStringList</span></a><span style=" font-family:'Courier New,courier';"> DragDropListModel::mimeTypes() const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qstringlist.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QStringList</span></a><span style=" font-family:'Courier New,courier';"> types;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     types &lt;&lt; &quot;application/vnd.text.list&quot;;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     return types;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Также модель должна иметь код, конвертирующий данные в соответствующий формат. Это достигается с помощью переопределенной функции <a href="qabstractitemmodel.html#mimeData"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel::mimeData</span></a>(), предоставляющей объект <a href="qmimedata.html"><span style=" text-decoration: underline; color:#0057ae;">QMimeData</span></a>, такой же, как и в любой другой операции перетаскивания.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Следующий код показывает, как каждый элемент данных, соответствующий списку индексов, может быть закодирован в виде простого текста и помещен в объект <a href="qmimedata.html"><span style=" text-decoration: underline; color:#0057ae;">QMimeData</span></a>.</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> </span><a href="qmimedata.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QMimeData</span></a><span style=" font-family:'Courier New,courier';"> *DragDropListModel::mimeData(const </span><a href="qmodelindex.html#QModelIndexList-typedef"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndexList</span></a><span style=" font-family:'Courier New,courier';"> &amp;indexes) const</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qmimedata.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QMimeData</span></a><span style=" font-family:'Courier New,courier';"> *mimeData = new </span><a href="qmimedata.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QMimeData</span></a><span style=" font-family:'Courier New,courier';">();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qbytearray.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QByteArray</span></a><span style=" font-family:'Courier New,courier';"> encodedData;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qdatastream.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QDataStream</span></a><span style=" font-family:'Courier New,courier';"> stream(&amp;encodedData, </span><a href="qiodevice.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QIODevice</span></a><span style=" font-family:'Courier New,courier';">::WriteOnly);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     foreach (const </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> &amp;index, indexes) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         if (index.isValid()) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">             </span><a href="qstring.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QString</span></a><span style=" font-family:'Courier New,courier';"> text = data(index, </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::DisplayRole).toString();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">             stream &lt;&lt; text;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     mimeData-&gt;setData(&quot;application/vnd.text.list&quot;, encodedData);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     return mimeData;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Так как функции передается список модельных индексов, этот подход достаточно универсален для использования в иерархических и неиерархических моделях.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обратите внимание на то, что пользовательские типы данных должны объявляться как <a href="qmetaobject.html"><span style=" text-decoration: underline; color:#0057ae;">мета-объекты</span></a> и для них должны быть реализованы потоковые операторы (stream operators). За подробностями обращайтесь к описанию класса <a href="qmetaobject.html"><span style=" text-decoration: underline; color:#0057ae;">QMetaObject</span></a>. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Вставка отпускаемых данных в модель</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Способ обработки моделью отпускания данных зависит от типа модели (список, таблица или дерево) и способа представления содержимого пользователю. Вообще, принимаемый для обработки отпускаемых данных подход должен зависеть от основного способа хранения данных.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модели различных типов имеют обыкновение по разному обрабатывать отпускаемые данные. Модели списков и таблиц предоставляют плоскую структуру хранения элементов данных. В результате они могут при отпускании данных на существующем элементе представления вставлять строки (и столбцы) или переписать содержимое элементов модели, используя некоторые из предоставленных данных. Модели деревьев часто могут добавлять дочерние элементы, содержащие новую информацию, к основным разделам данных, и поэтому их поведение может быть более очевидно пользователю.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Отпускаемые данные обрабатываются моделью с помощью переопределенной <a href="qabstractitemmodel.html#dropMimeData"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel::dropMimeData</span></a>(). Например, модель, работающая с простым списком строк, может по-разному обрабатывать отпускание данных на существующий элемент и на верхний уровень (т.е. на несуществующий элемент).</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модель сначала должна удостовериться, что операция должна быть выполнена, передаваемые данные имеют формат, который может использоваться, и что их назначение уместно для данной модели:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> bool DragDropListModel::dropMimeData(const </span><a href="qmimedata.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QMimeData</span></a><span style=" font-family:'Courier New,courier';"> *data,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::DropAction action, int row, int column, const </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> &amp;parent)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     if (action == </span><a href="qt.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">Qt</span></a><span style=" font-family:'Courier New,courier';">::IgnoreAction)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         return true;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     if (!data-&gt;hasFormat(&quot;application/vnd.text.list&quot;))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         return false;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     if (column &gt; 0)</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         return false;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Простая модель одностолбцового списка строк может сообщить об отказе в принятии данных, если перемещаемые данные не являются простым текстом или если переданный при перетаскивании номер столбца недействителен.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вставляемые в модель данные, в зависимости от того, отпускаются ли они над действительным или над недействительным элементом, обрабатываются по-разному. В этом простом примере мы хотим разрешить отпускание между существующими элементами, до первого элемента списка и после последнего.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Когда происходит отпускание модельный индекс, соответствующий родительскому элементу, будет либо действительным, указывая что отпускание произошло на элемент, либо будет недопустимым, указывая что отпускание произошло где-то в представлении, что соответствует верхнему уровню модели.</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     int beginRow;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     if (row != -1)</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         beginRow = row;</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сначала мы изучим переданный номер строки чтобы увидеть, можем ли мы использовать ее для вставки элементов в модель невзирая на то, является ли допустимым родительский индекс или нет.</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     else if (parent.isValid())</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         beginRow = parent.row();</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если родительский модельный индекс допустимый, то отпускание произойдет на элемент. В этой простой модели списка мы узнаем номер строки элемента и используем это значение для вставки отпускаемых элементов на верхний уровень модели.</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     else</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         beginRow = rowCount(</span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';">());</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Когда отпускание происходит где-нибудь в представлении и номер строки является недействительным, то элементы вставляются на верхний уровень модели.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В иерархических моделях, при отпускании над элементом, новые элементы лучше вставлять в модель в качестве дочерних по отношению к элементу, над которым происходит отпускание. В показанном здесь простом примере модель имеет один уровень, поэтому такой подход здесь неуместен. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Декодирование импортируемых данных</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Каждая из реализаций <a href="qabstractitemmodel.html#dropMimeData"><span style=" text-decoration: underline; color:#0057ae;">dropMimeData()</span></a> должна декодировать данные и вставлять их в основную структуру данных модели.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В простой модели списка строк декодированные элементы могут быть направлены в <a href="qstringlist.html"><span style=" text-decoration: underline; color:#0057ae;">QStringList</span></a>:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qbytearray.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QByteArray</span></a><span style=" font-family:'Courier New,courier';"> encodedData = data-&gt;data(&quot;application/vnd.text.list&quot;);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qdatastream.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QDataStream</span></a><span style=" font-family:'Courier New,courier';"> stream(&amp;encodedData, </span><a href="qiodevice.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QIODevice</span></a><span style=" font-family:'Courier New,courier';">::ReadOnly);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qstringlist.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QStringList</span></a><span style=" font-family:'Courier New,courier';"> newItems;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     int rows = 0;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     while (!stream.atEnd()) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         </span><a href="qstring.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QString</span></a><span style=" font-family:'Courier New,courier';"> text;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         stream &gt;&gt; text;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         newItems &lt;&lt; text;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         ++rows;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Строки могут быть вставлены в основную структуру данных. Чтобы быть последовательными, мы можем сделать это через интерфейс модели:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     insertRows(beginRow, rows, </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';">());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     foreach (const </span><a href="qstring.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QString</span></a><span style=" font-family:'Courier New,courier';"> &amp;text, newItems) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';"> idx = index(beginRow, 0, </span><a href="qmodelindex.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QModelIndex</span></a><span style=" font-family:'Courier New,courier';">());</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         setData(idx, text);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">         beginRow++;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     return true;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';"> }</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обратите внимание на то, что модель обычно должна предоставлять реализации функций <a href="qabstractitemmodel.html#insertRows"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel::insertRows</span></a>() и <a href="qabstractitemmodel.html#setData"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel::setData</span></a>(). </p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; font-weight:600;">Модели-посредники</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В структуре модель/представление, элементы данных предоставляемые одной моделью могут быть разделены между несколькими представлениями, и каждое из этих представлений может отображать информацию совершенно уникальным способом. Пользовательские представления и делегаты - эффективный метод, чтобы предоставить совершенно другие представления одних и тех же данных. Однако в приложениях часто требуется представление по-разному обработанных одних и тех же данных. Например, в виде списков, элементы которых по разному отсортированы.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Казалось бы вполне естественным выполнять сортировку и фильтрацию элементов данных силами самих представлений, но такой подход не позволяет многим представлениям совместно использовать результаты таких потенциально дорогостоящих операций. Альтернативный подход состоит в том, чтобы заставить саму модель сортировать данные, но в итоге каждое представление будет использовать результаты самой последней операции сортировки.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для решения этой проблемы в архитектуре модель/представление используются модели-посредники (proxy models), управляющие данными, передаваемыми между отдельными моделями и представлениями. Модели-посредники - это компоненты, ведущие себя по отношению к представлению подобно модели данных и осуществляющие доступ к модели данных от имени представления. Механизм сигналов и слотов, используемый в архитектуре модель/представление, гарантирует, что все представления будут обновлены независимо от того, сколько моделей-посредников расположено между ними и моделью-источником. </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Использование моделей-посредников</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модели-посредники могут быть вставлены между существующей моделью и любым количеством представлений. Qt предоставляет стандартную модель-посредник <a href="qsortfilterproxymodel.html"><span style=" text-decoration: underline; color:#0057ae;">QSortFilterProxyModel</span></a>, которая может использоваться как сама по себе, так и служить основой для подклассов, реализующих собственные способы фильтрации и сортировки. Класс <a href="qsortfilterproxymodel.html"><span style=" text-decoration: underline; color:#0057ae;">QSortFilterProxyModel</span></a> может использоваться следующим образом:</p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qsortfilterproxymodel.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QSortFilterProxyModel</span></a><span style=" font-family:'Courier New,courier';"> *filterModel = new </span><a href="qsortfilterproxymodel.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QSortFilterProxyModel</span></a><span style=" font-family:'Courier New,courier';">(parent);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     filterModel-&gt;setSourceModel(stringListModel);</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Courier New,courier';"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     </span><a href="qlistview.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QListView</span></a><span style=" font-family:'Courier New,courier';"> *filteredView = new </span><a href="qlistview.html"><span style=" font-family:'Courier New,courier'; text-decoration: underline; color:#0057ae;">QListView</span></a><span style=" font-family:'Courier New,courier';">;</span></p>
<p style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">     filteredView-&gt;setModel(filterModel);</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Так как модели-посредники являются наследниками <a href="qabstractitemmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel</span></a>, они могут быть соединены с представлением любого вида и быть разделенными между представлениями. Также они могут использоваться для обработки информации, полученной от другой модели-посредника.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Класс <a href="qsortfilterproxymodel.html"><span style=" text-decoration: underline; color:#0057ae;">QSortFilterProxyModel</span></a> разработан для того, чтобы использоваться непосредственно в приложениях. Наследуя от этого класса можно создать более специализированную модель-посредник, реализующую требуемые операции сравнения. </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Настройка моделей-посредников</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обработка данных моделью-посредником включает в себя отображение каждого элемента данных из его исходного расположения в источнике относительно его изначального расположения в соответствующее расположение в модели-посреднике. В некоторых моделях отдельные элементы могут не обрести соответствующего расположения в модели-посреднике; такие модели являются <span style=" font-style:italic;">фильтрующими</span> моделями-посредниками. Представления работают с элементами данных, используя модельные индексы, предоставляемые моделью-посредником, и не имеют никакого представления ни относительно расположения элементов в модели, ни о модели-источнике.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qsortfilterproxymodel.html"><span style=" text-decoration: underline; color:#0057ae;">QSortFilterProxyModel</span></a> позволяет отфильтровать данные перед предоставлением их представлению, а также позволяет предоставить представлениям содержимое модели-источника как предварительно отсортированные данные. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Пользовательские модели фильтрации</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Класс <a href="qsortfilterproxymodel.html"><span style=" text-decoration: underline; color:#0057ae;">QSortFilterProxyModel</span></a> предоставляет довольно универсальную фильтрующую модель, которая может использоваться в самых разных ситуациях. Продвинутые пользователи, для реализации собственных механизмов фильтрации, могут создать подкласс <a href="qsortfilterproxymodel.html"><span style=" text-decoration: underline; color:#0057ae;">QSortFilterProxyModel</span></a>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Подкласс <a href="qsortfilterproxymodel.html"><span style=" text-decoration: underline; color:#0057ae;">QSortFilterProxyModel</span></a> может переопределить две виртуальные функции, которые вызываются всякий раз, когда требуется или используется модельный индекс от модели-посредника:</p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qsortfilterproxymodel.html#filterAcceptsColumn"><span style=" text-decoration: underline; color:#0057ae;">filterAcceptsColumn()</span></a> используется для фильтрации определенных столбцов исходной модели.</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qsortfilterproxymodel.html#filterAcceptsRow"><span style=" text-decoration: underline; color:#0057ae;">filterAcceptsRow()</span></a> используется для фильтрации определенных строк исходной модели.</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Реализация этих функций в <a href="qsortfilterproxymodel.html"><span style=" text-decoration: underline; color:#0057ae;">QSortFilterProxyModel</span></a> по умолчанию всегда возвращает true для того, чтобы гарантировать, что все строки и столбцы будут переданы представлению; переопределение этих функций может возвращать false для фильтрации отдельных строк и столбцов. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Пользовательские модели сортировки</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для обеспечения отображения элементов модели-источника в модель-посредник, экземпляры <a href="qsortfilterproxymodel.html"><span style=" text-decoration: underline; color:#0057ae;">QSortFilterProxyModel</span></a> используют встроенную в Qt функцию <a href="qtalgorithms.html#qStableSort"><span style=" text-decoration: underline; color:#0057ae;">qStableSort</span></a>(), тем самым позволяя представлению получить отсортированную иерархию элементов без изменения структуры модели-источника. Для предоставления собственного метода сортировки, переопределите функцию <a href="qsortfilterproxymodel.html#lessThan"><span style=" text-decoration: underline; color:#0057ae;">lessThan()</span></a>, в которой пропишите свои правила сравнения. </p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; font-weight:600;">Создание собственных моделей</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Подклассы моделей необходимо обеспечить реализациями многих виртуальных функций, объявленных в базовом классе <a href="qabstractitemmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel</span></a>. Некоторое количество этих функций, которые необходимо реализовать, зависят от типа модели - предоставляет ли представление с простым списком, таблицей или сложной иерархией элементов. Унаследованные от <a href="qabstractlistmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractListModel</span></a> и <a href="qabstracttablemodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractTableModel</span></a> модели могут получить преимущество от стандартных реализаций функций, предоставляемых этими классами. Модели, которые предоставляют элементы данных в древовидных структурах, обязаны предоставить реализации для многих виртуальных функций <a href="qabstractitemmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel</span></a>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Функции, которые необходимо реализовать в подклассе модели, можно разделить на три группы:</p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Обработка данных элемента:</span> Все модели должны реализовать функции, которые дают возможность представлениям и делегатам запрашивать измерения модели, проверять элементы и извлекать данные.</li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Навигация и создание индекса:</span> Иерархические модели должны предоставить функции, которые могут вызываться представлениями для навигации в древовидных структурах, предоставляемых ими, и получения модельных индексов элементов.</li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Поддержка перетаскивания (drag and drop) и обработки MIME-типов:</span> Модели наследуют функции, управляющие способом, которым выполняются внутренние и внешние операции перетаскивания. Эти функции разрешают описывать элементы данных в терминах MIME-типов, которые могут понимать другие компоненты и приложения.</li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для получения дополнительной информации смотрите <a href="http://www.phptr.com/content/images/0131872494/samplechapter/blanchette_ch10.pdf"><span style=" text-decoration: underline; color:#0057ae;">главу &quot;Item View Classes&quot; в книге &quot;C++ GUI Programming with Qt 4&quot;</span></a>. </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Обработка элементов данных</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модели могут варьировать уровень доступа к предоставляемым ими данным: Они могут быть простыми компонентами только для чтения, другие модели могут обеспечивать операции изменения размера, а другие могут разрешить редактировать элементы. </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Доступ только для чтения</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы обеспечить доступ к предоставляемым моделью данным только для чтения, в подклассе модели <span style=" font-style:italic;">должны</span> быть реализованы следующие функции:</p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="90%" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#flags"><span style=" text-decoration: underline; color:#0057ae;">flags()</span></a></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Используется другими компонентами для получения информации о каждом элементе, предоставляемом моделью. Во многих моделях комбинация флагов будет включать в себя <a href="qt.html#ItemFlag-enum"><span style=" text-decoration: underline; color:#0057ae;">Qt::ItemIsEnabled</span></a> и <a href="qt.html#ItemFlag-enum"><span style=" text-decoration: underline; color:#0057ae;">Qt::ItemIsSelectable</span></a>.</p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#data"><span style=" text-decoration: underline; color:#0057ae;">data()</span></a></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Используется для снабжения представлений и делегатов элементами данных. Как правило, модели нуждаются только в снабжении данными для <a href="qt.html#ItemDataRole-enum"><span style=" text-decoration: underline; color:#0057ae;">Qt::DisplayRole</span></a> и любых специфичных для приложения пользовательских ролей, но будет хорошей практикой предоставить данные для <a href="qt.html#ItemDataRole-enum"><span style=" text-decoration: underline; color:#0057ae;">Qt::ToolTipRole</span></a>, <a href="qt.html#ItemDataRole-enum"><span style=" text-decoration: underline; color:#0057ae;">Qt::AccessibleTextRole</span></a> и <a href="qt.html#ItemDataRole-enum"><span style=" text-decoration: underline; color:#0057ae;">Qt::AccessibleDescriptionRole</span></a>. Информацию о типах, связанных с каждой ролью, смотрите в документации перечисления <a href="qt.html#ItemDataRole-enum"><span style=" text-decoration: underline; color:#0057ae;">Qt::ItemDataRole</span></a>.</p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#headerData"><span style=" text-decoration: underline; color:#0057ae;">headerData()</span></a></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Предоставляется представлениям с информацией для показа в их заголовках. Информация извлекается представлениями, которые могут отобразить информацию заголовков.</p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#rowCount"><span style=" text-decoration: underline; color:#0057ae;">rowCount()</span></a></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Предоставляет количество строк данных, доступных в модели.</p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Эти четыре функции должны быть реализованы во всех видах моделей, включая модели списков (подклассы <a href="qabstractlistmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractListModel</span></a>) и табличные модели (подклассы <a href="qabstracttablemodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractTableModel</span></a>).</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Кроме того, следующие функции <span style=" font-style:italic;">должны</span> быть реализованы в прямых наследниках <a href="qabstracttablemodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractTableModel</span></a> и <a href="qabstractitemmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel</span></a>:</p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="90%" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#columnCount"><span style=" text-decoration: underline; color:#0057ae;">columnCount()</span></a></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Предоставляет количество столбцов данных, доступных в модели. Модели списков не предоставляют эту функцию поскольку она уже реализована в <a href="qabstractlistmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractListModel</span></a>.</p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Редактируемые элементы</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Редактируемые модели разрешают модифицировать элементы данных, а также могут предоставить функции, разрешающие вставку и удаление строк и столбцов. Чтобы разрешить редактирование, должны быть корректно реализованы следующие функции:</p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="90%" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#flags"><span style=" text-decoration: underline; color:#0057ae;">flags()</span></a></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Должна возвращать комбинацию флагов, соответствующую каждому элементу. В частности, возвращаемое этой функцией значение, в дополнение к используемым в модели только для чтения значениям, должно включать в себя <a href="qt.html#ItemFlag-enum"><span style=" text-decoration: underline; color:#0057ae;">Qt::ItemIsEditable</span></a>.</p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#setData"><span style=" text-decoration: underline; color:#0057ae;">setData()</span></a></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Используется для модификации элемента данных, связанного с заданным модельным индексом. Чтобы иметь возможность принимать пользовательский ввод, предоставляемый элементами пользовательского интерфейса, эта функция должна обрабатывать данные, связанные с <a href="qt.html#ItemDataRole-enum"><span style=" text-decoration: underline; color:#0057ae;">Qt::EditRole</span></a>. Реализация может также принимать данные, связанные со многими различными видами ролей, задаваемыми <a href="qt.html#ItemDataRole-enum"><span style=" text-decoration: underline; color:#0057ae;">Qt::ItemDataRole</span></a>. После изменения элемента данных модели должны испустить сигнал <a href="qabstractitemmodel.html#dataChanged"><span style=" text-decoration: underline; color:#0057ae;">dataChanged()</span></a>, чтобы уведомить другие компоненты об изменении.</p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#setHeaderData"><span style=" text-decoration: underline; color:#0057ae;">setHeaderData()</span></a></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Используется для модификации информации в горизонтальном и вертикальном заголовке. После изменения элемента данных модели должны испустить сигнал <a href="qabstractitemmodel.html#headerDataChanged"><span style=" text-decoration: underline; color:#0057ae;">headerDataChanged()</span></a>, чтобы уведомить другие компоненты об изменении.</p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Изменение размеров моделей</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Все типы моделей могут поддерживать вставку и удаление строк. Табличные модели и иерархические модели могут также поддерживать вставку и удаление столбцов. Важно уведомить другие компоненты об изменениях в измерениях модели как <span style=" font-style:italic;">до</span>, так и <span style=" font-style:italic;">после</span> того как они произойдут. В результате, следующие функции могут быть реализованы для разрешения модели изменять размеры, но реализации должны гарантировать, что вызываются соответствующие функции для уведомления присоединенных представлений и делегатов:</p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="90%" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#insertRows"><span style=" text-decoration: underline; color:#0057ae;">insertRows()</span></a></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Используется для добавления новых строк и элементов данных во все виды моделей. Реализации должны содержать вызов <a href="qabstractitemmodel.html#beginInsertRows"><span style=" text-decoration: underline; color:#0057ae;">beginInsertRows()</span></a> <span style=" font-style:italic;">перед</span> вставкой новых строк в любые базовые структуры данных и вызов <a href="qabstractitemmodel.html#endInsertRows"><span style=" text-decoration: underline; color:#0057ae;">endInsertRows()</span></a> <span style=" font-style:italic;">незамедлительно после</span>.</p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#removeRows"><span style=" text-decoration: underline; color:#0057ae;">removeRows()</span></a></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Используется для удаления строк и содержащихся в них элементов данных изо всех видов моделей. Реализации должны содержать вызов <a href="qabstractitemmodel.html#beginRemoveRows"><span style=" text-decoration: underline; color:#0057ae;">beginRemoveRows()</span></a> <span style=" font-style:italic;">перед</span> удалением столбцов из базовых структур данных и вызов <a href="qabstractitemmodel.html#endRemoveRows"><span style=" text-decoration: underline; color:#0057ae;">endRemoveRows()</span></a> <span style=" font-style:italic;">незамедлительно после</span>.</p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#insertColumns"><span style=" text-decoration: underline; color:#0057ae;">insertColumns()</span></a></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Используется для добавления новых столбцов и элементов данных в табличные и иерархические модели. Реализации должны содержать вызов <a href="qabstractitemmodel.html#beginInsertColumns"><span style=" text-decoration: underline; color:#0057ae;">beginInsertColumns()</span></a> <span style=" font-style:italic;">перед</span> вставкой строк в любые базовые структуры данных и вызов <a href="qabstractitemmodel.html#endInsertColumns"><span style=" text-decoration: underline; color:#0057ae;">endInsertColumns()</span></a> <span style=" font-style:italic;">незамедлительно после</span>.</p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#removeColumns"><span style=" text-decoration: underline; color:#0057ae;">removeColumns()</span></a></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Используется для удаления столбцов и содержащихся в них элементов данных из табличных и иерархических моделей. Реализации должны содержать вызов <a href="qabstractitemmodel.html#beginRemoveColumns"><span style=" text-decoration: underline; color:#0057ae;">beginRemoveColumns()</span></a> <span style=" font-style:italic;">перед</span> удалением столбцов из любых базовых структур данных и вызов <a href="qabstractitemmodel.html#endRemoveColumns"><span style=" text-decoration: underline; color:#0057ae;">endRemoveColumns()</span></a> <span style=" font-style:italic;">незамедлительно после</span>.</p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Как правило, эти функции возвращают true если операция была успешной. Однако могут быть случаи, когда операция достигла успеха только частично; например, если строк может быть вставлено меньше указанного количества. В таких случаях модель должна возвращать false, чтобы, обозначив фатальную ошибку, дать возможность каким-нибудь присоединенным компонентам обработать ситуацию.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Сигналы, испускаемые функциями, вызванными в реализациях API изменения размера, дают шанс присоединенным компонентам принять меры до того, как какие-либо данные станут недоступными. Инкапсуляция операций вставки и удаления с начальными и конечными функциями также дает возможность модели корректно управлять <a href="qpersistentmodelindex.html"><span style=" text-decoration: underline; color:#0057ae;">постоянными модельными индексами</span></a>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Как правило, начальные и конечные функции способны уведомлять другие компоненты об изменениях в базовой структуре модели. Для более сложных изменений в структуре модели, приводящие возможно к преобразованию или сортировке данных, необходимо испустить сигнал <a href="qabstractitemmodel.html#layoutChanged"><span style=" text-decoration: underline; color:#0057ae;">layoutChanged()</span></a>, чтобы заставить все присоединенные представления обновиться. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Ленивое заполнение (Lazy Population) модели данных</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Ленивое заполнение данных модели эффективно разрешает запросы информации о модели, отложенные до тех пор пока они фактически не понадобятся представлениям.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Некоторые модели нуждаются в получении данных из удаленных источников или должны выполнять ресурсоемкие операции, чтобы получить информацию о способе организации данных. Так как представления обычно требуют так много информации, сколько возможно по порядку для правильного отображения данных модели, для уменьшения излишних откликов (follow-up) на запрашиваемые данные может быть полезным ограничить количество возвращаемой к ним информации.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В иерархических моделях, где нахождение количества дочерних элементов заданного элемента является дорогостоящей операцией, полезно обеспечить, чтобы реализация <a href="qabstractitemmodel.html#rowCount"><span style=" text-decoration: underline; color:#0057ae;">rowCount()</span></a> модели вызывалась только когда это необходимо. В таких случаях, функция <a href="qabstractitemmodel.html#hasChildren"><span style=" text-decoration: underline; color:#0057ae;">hasChildren()</span></a> может быть переопределена для предоставления представлениям экономного способа проверки наличия дочерних элементов и, в случае <a href="qtreeview.html"><span style=" text-decoration: underline; color:#0057ae;">QTreeView</span></a>, рисования соответствующего оформления их родительского элемента.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Возвратит ли переопределенная функция <a href="qabstractitemmodel.html#hasChildren"><span style=" text-decoration: underline; color:#0057ae;">hasChildren()</span></a> <span style=" font-family:'Courier New,courier';">true</span> или <span style=" font-family:'Courier New,courier';">false</span>, для представлений нет необходимости вызывать <a href="qabstractitemmodel.html#rowCount"><span style=" text-decoration: underline; color:#0057ae;">rowCount()</span></a>, чтобы узнать сколько имеется дочерних элементов. Например, <a href="qtreeview.html"><span style=" text-decoration: underline; color:#0057ae;">QTreeView</span></a> не нужно знать сколько имеется дочерних элементов, если родительский элемент не развернут для их показа.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если известно, что многие элементы имеют дочерние элементы, переопределение <a href="qabstractitemmodel.html#hasChildren"><span style=" text-decoration: underline; color:#0057ae;">hasChildren()</span></a> для безусловного возврата <span style=" font-family:'Courier New,courier';">true</span> является иногда полезным методом. Это гарантирует, что каждый элемент может позднее проверить наличие дочерних элементов при выполнении начального заполнения данных модели так быстро, как это возможно. Единственное неудобство - это то, что элементы без дочерних элементов в некоторых представлениях могут отображаться неправильно пока пользователь пытается просмотреть несуществующие дочерние элементы. </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Навигация и создание индекса модели</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Иерархические модели должны предоставить функции, которые могут вызываться представлениями для навигации в древовидных структурах, которые они отображают, и получения модельных индексов элементов. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Родители и дети</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Так как структура, открытая представлениям, определяется базовой структурой данных, создание собственных модельных индексов для каждого подкласса модели обеспечивается реализацией следующих функций:</p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="90%" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#index"><span style=" text-decoration: underline; color:#0057ae;">index()</span></a></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Передавая модельный индекс родительского элемента, эта функция разрешает представлениям и делегатам обращаться к дочерним элементам этого элемента. Если не найдено допустимого дочернего элемента - соответствующего указанным строке, столбцу и родительскому модельному индексу, функция должна вернуть QModelIndex(), который является ошибочным модельным индексом.</p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#parent"><span style=" text-decoration: underline; color:#0057ae;">parent()</span></a></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Предоставляет модельный индекс, соответствующий родителю какого-либо дочернего элемента. Если указанный модельный индекс соответствует элементу верхнего уровня модели, или если у элемента в модели нет правильного родителя, функция должна вернуть неправильный модельный индекс, созданный с помощью пустого конструктора QModelIndex().</p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Обе приведенные выше функции используют фабрику функций <a href="qabstractitemmodel.html#createIndex"><span style=" text-decoration: underline; color:#0057ae;">createIndex()</span></a> для генерации индексов, используемых другими компонентами. Для моделей является нормой снабжать эту функцию каким-нибудь уникальным идентификатором, чтобы гарантировать что модельный индекс может быть перепривязан к соответствующему элементу позднее. </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Поддержка перетаскивания (Drag and Drop) и обработка MIME-типов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Классы модель/представление поддерживают операции перетаскивания (drag and drop), предоставляя поведение по умолчанию, что подходит многим приложениям. Тем не менее, возможно также внести изменения в способ кодирования элементов во время операций перетаскивания, копируются ли они по умолчанию или перемещаются, и как они вставляются в существующие модели.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Кроме того, классы вспомогательных представлений реализуют специализированное поведение, что отвечает ожиданиям существующих разработчиков. Раздел <a href="model-view-programming.html#convenience-views"><span style=" text-decoration: underline; color:#0057ae;">Вспомогательные представления</span></a> предоставит обзор этого поведения. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">MIME данные</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">По умолчанию, встроенные модели и представления используют внутренний MIME-тип (<span style=" font-family:'Courier New,courier';">application/x-qabstractitemmodeldatalist</span>) для передачи информации о модельных индексах. Это задает данные для списка элементов, содержащего номера строк и столбцов для каждого элемента и информацию о ролях, поддерживаемых для каждого элемента.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Закодированные с использованием этого MIME-типа данные могут быть получены с помощью вызова <a href="qabstractitemmodel.html#mimeData"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel::mimeData</span></a>() с <a href="qmodelindex.html#QModelIndexList-typedef"><span style=" text-decoration: underline; color:#0057ae;">QModelIndexList</span></a>, содержащим элементы для преобразования в последовательную форму.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">При реализации поддержки перетаскивания в пользовательской модели, можно экспортировать элементы данных в специализированных форматах переопределив следующую функцию:</p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="90%" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#mimeData"><span style=" text-decoration: underline; color:#0057ae;">mimeData()</span></a></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Эта функция может быть переопределена таким образом, чтобы возвращать данные в форматах, отличных от стандартного внутреннего MIME-типа <span style=" font-family:'Courier New,courier';">application/x-qabstractitemmodeldatalist</span>.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Подклассы могут получить стандартный объект <a href="qmimedata.html"><span style=" text-decoration: underline; color:#0057ae;">QMimeData</span></a> из базового класса и добавить в него данные в дополнительных форматах.</p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для многих моделей полезно предоставить содержимое элементов в общем формате, представленном одним из MIME-типов, таких как <span style=" font-family:'Courier New,courier';">text/plain</span> или <span style=" font-family:'Courier New,courier';">image/png</span>. Обратите внимание на то, что изображения, цвета и документы HTML могут быть легко добавлены в объект <a href="qmimedata.html"><span style=" text-decoration: underline; color:#0057ae;">QMimeData</span></a> с помощью функций <a href="qmimedata.html#setImageData"><span style=" text-decoration: underline; color:#0057ae;">QMimeData::setImageData</span></a>(), <a href="qmimedata.html#setColorData"><span style=" text-decoration: underline; color:#0057ae;">QMimeData::setColorData</span></a>() и <a href="qmimedata.html#setHtml"><span style=" text-decoration: underline; color:#0057ae;">QMimeData::setHtml</span></a>(). </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Получение отпускаемых данных</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Когда операция перетаскивания выполняется в представлении, основная модель запрашивается для определения поддерживаемых ею типов операций и MIME-типов, которые она может принимать. Эта информация предоставляется функциями <a href="qabstractitemmodel.html#supportedDropActions"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel::supportedDropActions</span></a>() и <a href="qabstractitemmodel.html#mimeTypes"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel::mimeTypes</span></a>(). Модели, которые не переопределяют реализации, предоставляемые <a href="qabstractitemmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel</span></a>, поддерживают для элементов операции копирования и стандартный внутренний MIME-тип.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Когда преобразованный в последовательную форму (serialized) элемент данных отпускается над представлением, данные вставляются в текущую модель, используя ее реализацию <a href="qabstractitemmodel.html#dropMimeData"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel::dropMimeData</span></a>(). Стандартная реализация этой функции никогда не затирает какие-либо данные в модели; вместо этого она попытается вставить элементы данных либо на одном уровне с элементом, либо в качестве дочерних этого элемента.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы воспользоваться реализацией по умолчанию <a href="qabstractitemmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel</span></a> для встроенного MIME-типа, новые модели должны обеспечить переопределение следующих функций:</p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="90%" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#insertRows"><span style=" text-decoration: underline; color:#0057ae;">insertRows()</span></a></p></td>
<td rowspan="2" style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Эти функции разрешают модели автоматическую вставку новых данных используя существующую реализацию, предоставляемую <a href="qabstractitemmodel.html#dropMimeData"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel::dropMimeData</span></a>().</p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#insertColumns"><span style=" text-decoration: underline; color:#0057ae;">insertColumns()</span></a></p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#setData"><span style=" text-decoration: underline; color:#0057ae;">setData()</span></a></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Разрешает заполнять элементами новые строки и столбцы.</p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#setItemData"><span style=" text-decoration: underline; color:#0057ae;">setItemData()</span></a></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Эта функция предоставляет более эффективную поддержку заполнения новых элементов.</p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы принять другие формы данных эти функции должны быть переопределены:</p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="90%" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#supportedDropActions"><span style=" text-decoration: underline; color:#0057ae;">supportedDropActions()</span></a></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Используется чтобы возвратить сочетание <a href="qt.html#DropAction-enum"><span style=" text-decoration: underline; color:#0057ae;">действий отпускания</span></a> (drop actions), указывающих типы операций перетаскивания, которые принимает модель.</p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#mimeTypes"><span style=" text-decoration: underline; color:#0057ae;">mimeTypes()</span></a></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Используется чтобы возвращать список MIME-типов, которые могут быть декодированы и обработаны моделью. Как правило, MIME-типы, которые поддерживаются для ввода в модель, являются теми же, которые после раскодирования данных могут использоваться внешними компонентами.</p></td></tr>
<tr>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#dropMimeData"><span style=" text-decoration: underline; color:#0057ae;">dropMimeData()</span></a></p></td>
<td style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Выполняет действительное раскодирование данных, переданных операциями перетаскивания, определяет где в модели они были положены и вставляет новые строки и столбцы там, где необходимо. Как реализуется эта функция в подклассах - зависит от требований данных, доступных в каждой модели.</p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если реализация функции <a href="qabstractitemmodel.html#dropMimeData"><span style=" text-decoration: underline; color:#0057ae;">dropMimeData()</span></a> изменяет измерения модели, вставляя или удаляя строки или столбцы, или же если элементы данных модифицировались, осторожность требует убедиться, что все соответствующие сигналы испущены. Полезно просто вызвать другие переопределенные функции в подклассе, такие как <a href="qabstractitemmodel.html#setData"><span style=" text-decoration: underline; color:#0057ae;">setData()</span></a>, <a href="qabstractitemmodel.html#insertRows"><span style=" text-decoration: underline; color:#0057ae;">insertRows()</span></a> и <a href="qabstractitemmodel.html#insertColumns"><span style=" text-decoration: underline; color:#0057ae;">insertColumns()</span></a>, чтобы убедиться, что модель ведет себя соответственно.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для того, чтобы убедиться что операции перетаскивания работают правильно, важно переопределить следующие функции, которые удаляют данные из модели:</p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#removeRows"><span style=" text-decoration: underline; color:#0057ae;">removeRows()</span></a></li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#removeRow"><span style=" text-decoration: underline; color:#0057ae;">removeRow()</span></a></li>
<li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#removeColumns"><span style=" text-decoration: underline; color:#0057ae;">removeColumns()</span></a></li>
<li style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="qabstractitemmodel.html#removeColumn"><span style=" text-decoration: underline; color:#0057ae;">removeColumn()</span></a></li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">За дополнительной информацией о перетаскивании с представлениями элементов обратитесь к <a href="model-view-programming.html#using-drag-and-drop-with-item-views"><span style=" text-decoration: underline; color:#0057ae;">Использование перетаскивания (Drag and Drop) с представлениями элементов</span></a>. </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:medium; font-weight:600;">Вспомогательные представления</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Вспомогательные представления (<a href="qlistwidget.html"><span style=" text-decoration: underline; color:#0057ae;">QListWidget</span></a>, <a href="qtablewidget.html"><span style=" text-decoration: underline; color:#0057ae;">QTableWidget</span></a> и <a href="qtreewidget.html"><span style=" text-decoration: underline; color:#0057ae;">QTreeWidget</span></a>) замещают стандартную функциональность перетаскивания чтобы обеспечить меньшую гибкость, но более естественное поведение, подходящее многим приложениям. Например, так как наиболее распространено отпускание данных в ячейки <a href="qtablewidget.html"><span style=" text-decoration: underline; color:#0057ae;">QTableWidget</span></a> с заменой имеющегося содержимого переданными данными, базовая модель будет устанавливать данные в элементы-приемник охотнее, чем вставлять в модель новые строки и строки. Для получения дополнительной информации о перетаскивании во вспомогательных представлениях смотрите <a href="model-view-programming.html#using-drag-and-drop-with-item-views"><span style=" text-decoration: underline; color:#0057ae;">Использование перетаскивания (Drag and Drop) с представлениями элементов</span></a>. </p>
<p style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:large; font-weight:600;">Оптимизация производительности для больших объемов данных</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Функция <a href="qabstractitemmodel.html#canFetchMore"><span style=" text-decoration: underline; color:#0057ae;">canFetchMore()</span></a> проверяет, содержит ли родитель дополнительные доступные данные и соответственно возвращает true или false. Функция <a href="qabstractitemmodel.html#fetchMore"><span style=" text-decoration: underline; color:#0057ae;">fetchMore()</span></a> извлекает данные, базирующиеся в указанном родителе. Обе этих функции могут комбинироваться, например, в запросе к базе данных содержать инкрементные данные для заполнения <a href="qabstractitemmodel.html"><span style=" text-decoration: underline; color:#0057ae;">QAbstractItemModel</span></a>. Мы переопределили <a href="qabstractitemmodel.html#canFetchMore"><span style=" text-decoration: underline; color:#0057ae;">canFetchMore()</span></a> чтобы указать, если для извлечения имеется больше данных, и <a href="qabstractitemmodel.html#fetchMore"><span style=" text-decoration: underline; color:#0057ae;">fetchMore()</span></a> для заполнения модели по требованию.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Другой пример будет динамически заполнять древовидные модели, в нем мы переопределяем <a href="qabstractitemmodel.html#fetchMore"><span style=" text-decoration: underline; color:#0057ae;">fetchMore()</span></a> когда ветвь дерева в древовидной модели является раскрытой.</p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Если ваша переопределенная <a href="qabstractitemmodel.html#fetchMore"><span style=" text-decoration: underline; color:#0057ae;">fetchMore()</span></a> добавляет строки к модели, вам нужно вызывать <a href="qabstractitemmodel.html#beginInsertRows"><span style=" text-decoration: underline; color:#0057ae;">beginInsertRows()</span></a> и <a href="qabstractitemmodel.html#endInsertRows"><span style=" text-decoration: underline; color:#0057ae;">endInsertRows()</span></a>. Кроме того, и <a href="qabstractitemmodel.html#canFetchMore"><span style=" text-decoration: underline; color:#0057ae;">canFetchMore()</span></a> и <a href="qabstractitemmodel.html#fetchMore"><span style=" text-decoration: underline; color:#0057ae;">fetchMore()</span></a> должны быть переопределены поскольку их реализации по умолчанию возвращают false и ничего не делают. </p>
<p style="-qt-paragraph-type:empty; margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; font-weight:600;">Классы модель/представление</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Эти классы используются при разработке паттернов модель/представление, где основные данные (в модели) хранятся отдельно от данных представленных и управляемых пользователем (в представлении).</p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QAbstractItemDelegate</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Используется для отображения и редактирования элементов данных модели</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QAbstractItemModel</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Абстрактный интерфейс для классов моделей элементов</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QAbstractItemView</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Базовая функциональность для классов представлений элементов</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QAbstractListModel</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Абстрактная модель, подкласс которой можно создать для реализации одномерной модели списка</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QAbstractProxyModel</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Базовый класс для моделей-посредников элементов, которые могут сортировать, фильтровать и выполнять другие действия над данными</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QAbstractTableModel</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Абстрактная модель, подкласс которой можно создать для реализации собственной табличной модели</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QColumnView</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Реализация идеи модель/представление в виде постолбцового представления</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QDataWidgetMapper</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Отображение области данных модели на виджеты</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QFileSystemModel</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модель данных для локальной файловой системы</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QHeaderView</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Заголовок строки и столбца для представлений элементов</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QItemDelegate</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Средство отображения и редактирования элементов данных модели</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QItemEditorCreator</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Делает возможным создание элемента редактора без наследования QItemEditorCreatorBase</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QItemEditorCreatorBase</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Абстрактный базовый класс, для которого, при реализации нового редактора элемента, должен быть создан подкласс</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QItemEditorFactory</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Виджеты для отображения данных в представлении и делегатах</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QItemSelection</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Управляет информацией о выбранных в модели элементах</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QItemSelectionModel</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Отслеживает элементы, выбранные в представлении</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QItemSelectionRange</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Управляет информацией о диапазоне выбранных элементов в модели</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QListView</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Представление списка или пиктограмм в модели</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QListWidget</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Основанный на элементах виджет-список</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QListWidgetItem</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Элемент, используемый совместно с классом представления элементов QListWidget</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QModelIndex</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Используется для нахождения информации в модели данных</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QPersistentModelIndex</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Используется для нахождения информации в модели данных</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QSortFilterProxyModel</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Поддержка сортировки и фильтрации данных, передаваемых между другой моделью и представлением</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QStandardItem</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Элемент, использующийся в классе QStandardItemModel</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QStandardItemEditorCreator</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Возможность регистрации виджетов без использования наследования QItemEditorCreatorBase</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QStandardItemModel</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Общая модель для хранения пользовательских данных</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QStringListModel</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Модель, предоставляющая представлению строки</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QStyledItemDelegate</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Средство отображения и редактирования элементов данных модели</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QTableView</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Реализация по умолчанию модели/представления таблицы</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QTableWidget</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Основанное на элементах представление таблицы в модели по умолчанию</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QTableWidgetItem</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Элемент, использующийся в классе QTableWidget</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QTableWidgetSelectionRange</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Способ взаимодействия с выбором в модели без использования модельных индексов и модели выбора.</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QTreeView</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Реализация модели/представления по умолчанию для представления дерева</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QTreeWidget</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Представление дерева, использующее заданную модель дерева</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QTreeWidgetItem</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Элемент, используемый в классе QTreeWidget</p></td></tr>
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600; color:#000000;">QTreeWidgetItemIterator</span></p></td>
<td>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Способ перебора всех элементов QTreeWidget</p></td></tr></table>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:x-large; font-weight:600;">Связанные примеры</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Представление каталога</span></li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Делегат окошка счетчика</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Pixelator</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Простая модель дерева</li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Диаграмма</li></ul>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Смотрите также</span><span style=" color:#000000;"> </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" color:#000000;">Пример &quot;Item Views Puzzle&quot;. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>