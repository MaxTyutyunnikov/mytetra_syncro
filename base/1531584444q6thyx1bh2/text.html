<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Внимание! Эта статья от 2013 года. В настоящий момент в Qt работают &quot;подключаемые&quot; подпроекты *.pri. Однако по ним, кроме сухой документации, информации мало.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:xx-large; font-weight:600;">Сборка группы проектов в qmake с помощью SUBDIRS </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">Представьте себе программу, имеющую плагинную архитектуру. Qt Creator тому хороший пример. Исходники таких программ должны состоять из нескольких отдельно компилируемых проектов: собственно программы и динамических библиотек плагинов. Прибавьте к этому тест-кейсы, и вполне можем получить пару десятков взаимосвязанных проектов.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="more-2425"></a><span style=" font-family:'Sans';">К</span><span style=" font-family:'Sans';">онечно, можно компилировать их по отдельности, но это неправильно. И дело здесь не только в том, что нужно нажать 5-10-20 раз на кнопку «build» вместо одного. Проекты может быть нужно строить в определенном порядке, да и банально можно пропустить какой проект. Ошибки в билде никому не нужны.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">Поэтому, например, в Visual Studio для автоматизации построения группы проектов ввели понятие solution (решение), которое может содержать в себе проекты. Аналогом этого механизма в qmake является переменная </span><span style=" font-family:'monospace';">SUBDIRS</span><span style=" font-family:'Sans';">.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Sans';"><br /></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:x-large; font-weight:600;">Базовый функционал SUBDIRS</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">Все проекты, составляющие программу, должны быть в своих подкаталогах каталога программы. В этом каталоге нужно создать .pro файл специального вида: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><a name="crayon-5b4a0541037e4956915427"></a><span style=" font-family:'Sans'; font-size:14px;">Б</span><span style=" font-family:'Sans'; font-size:14px;">азовый SUBDIRS </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;"># проект типа subdirs TEMPLATE = subdirs # список каталогов проектов # в каждом каталоге должен существовать # одноименный .pro файл: prj1/prj1.pro, prj2/prg2.pro и т.п. SUBDIRS = prj1 prj2 prj3 # Кроме этих двух переменных толком больше писать смысла нет. # Разве что QMAKE_EXTRA_TARGETS, о чем ниже. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Sans'; font-size:14px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:-27px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-family:'Sans'; font-size:14px;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">4</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">5</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">6</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">7</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">8</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">9</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">10</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">11</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">12 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5b4a0541037e4956915427-1"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a0541037e4956915427-2"></a><span style=" font-family:'Sans'; font-size:14px;">#</span><span style=" font-family:'Sans'; font-size:14px;"> проект типа subdirs</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a0541037e4956915427-3"></a><span style=" font-family:'Sans'; font-size:14px;">T</span><span style=" font-family:'Sans'; font-size:14px;">EMPLATE = subdirs</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a0541037e4956915427-4"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a0541037e4956915427-5"></a><span style=" font-family:'Sans'; font-size:14px;">#</span><span style=" font-family:'Sans'; font-size:14px;"> список каталогов проектов</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a0541037e4956915427-6"></a><span style=" font-family:'Sans'; font-size:14px;">#</span><span style=" font-family:'Sans'; font-size:14px;"> в каждом каталоге должен существовать </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a0541037e4956915427-7"></a><span style=" font-family:'Sans'; font-size:14px;">#</span><span style=" font-family:'Sans'; font-size:14px;"> одноименный .pro файл: prj1/prj1.pro, prj2/prg2.pro и т.п.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a0541037e4956915427-8"></a><span style=" font-family:'Sans'; font-size:14px;">S</span><span style=" font-family:'Sans'; font-size:14px;">UBDIRS = prj1 prj2 prj3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a0541037e4956915427-9"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a0541037e4956915427-10"></a><span style=" font-family:'Sans'; font-size:14px;">#</span><span style=" font-family:'Sans'; font-size:14px;"> Кроме этих двух переменных толком больше писать смысла нет.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a0541037e4956915427-11"></a><span style=" font-family:'Sans'; font-size:14px;">#</span><span style=" font-family:'Sans'; font-size:14px;"> Разве что QMAKE_EXTRA_TARGETS, о чем ниже.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Sans'; font-size:14px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a0541037e4956915427-12"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p></td></tr></table>
<p align="center" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image12165460.png" /></p>
<p align="center" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">Вид subdirs проекта в Qt Creator</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">qmake при обработке этого файла обработает — независимо друг от друга, но с одними и теми же настройками qmake — дочерние проекты в подкаталогах, после чего в каталоге программы создаст Makefile, который будет вызывать make для дочерних проектов. К примеру, </span><span style=" font-family:'monospace';">make all</span><span style=" font-family:'Sans';"> в корневом каталоге вызовет </span><span style=" font-family:'monospace';">make all</span><span style=" font-family:'Sans';"> во всех дочерних каталогах.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">Qt Creator отлично поддерживает проекты типа subdirs. В интерфейсе Projects все наглядно отображается, можно добавлять новые проекты в контекстном меню subdirs-проекта (New Subproject…), но самое главное — это поддержка shadow builds. Весь проект типа subdirs вместе со своими дочерними проектами билдится в один shadow каталог — с повторением структуры каталогов исходников. Очень удобно.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:x-large; font-weight:600;">Структура каталогов</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">Если дочерние проекты хочется организовать в иерархию, можно поступить двумя способами. Во-первых, можно дочерний проект сделать subdirs проектом, все будет работать. Во-вторых, можно просто указать в переменной </span><span style=" font-family:'monospace';">SUBDIRS</span><span style=" font-family:'Sans';"> путь к подкаталогу подкаталога, например. </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><a name="crayon-5b4a0541037fc268533144"></a><span style=" font-family:'Sans'; font-size:14px;">П</span><span style=" font-family:'Sans'; font-size:14px;">одкаталог в SUBDIRS </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">SUBDIRS = prj1 prj2 prj3 dir/subdir1 dir/subdir2 </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Sans'; font-size:14px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:-19px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-family:'Sans'; font-size:14px;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">3 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5b4a0541037fc268533144-1"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a0541037fc268533144-2"></a><span style=" font-family:'Sans'; font-size:14px;">S</span><span style=" font-family:'Sans'; font-size:14px;">UBDIRS = prj1 prj2 prj3 dir/subdir1 dir/subdir2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a0541037fc268533144-3"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">Но на этом история не заканчивается. Значения, перечисленные в переменной </span><span style=" font-family:'monospace';">SUBDIRS</span><span style=" font-family:'Sans';">, можно использовать как имена составных переменных. Если значения содержат символы, отличные от </span><span style=" font-family:'monospace';">[a-zA-Z0-9_]</span><span style=" font-family:'Sans';">, они заменяются на </span><span style=" font-family:'monospace';">-</span><span style=" font-family:'Sans';">, например для </span><span style=" font-family:'monospace';">dir/subdir1</span><span style=" font-family:'Sans';"> имя переменной будет </span><span style=" font-family:'monospace';">dir-subdir1</span><span style=" font-family:'Sans';">. Странный выбор, т.к. переменные с </span><span style=" font-family:'monospace';">-</span><span style=" font-family:'Sans';"> в имени не везде проходят мимо парсера без ошибки. Так что лучше вложенные пути не использовать напрямую, а задавать для них алиасы: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><a name="crayon-5b4a05410380c518557346"></a><span style=" font-family:'Sans'; font-size:14px;">.</span><span style=" font-family:'Sans'; font-size:14px;">subdir </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">SUBDIRS += prj1 prj1.subdir = dir/prj1 # Фактически, это то же самое, что SUBDIRS += dir/prj1 # только вместо составной переменной dir-prj1 # теперь используется составная переменная prj1 </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Sans'; font-size:14px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:-19px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-family:'Sans'; font-size:14px;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">4</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">5</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">6</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">7</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">8</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">9 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5b4a05410380c518557346-1"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a05410380c518557346-2"></a><span style=" font-family:'Sans'; font-size:14px;">S</span><span style=" font-family:'Sans'; font-size:14px;">UBDIRS += prj1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a05410380c518557346-3"></a><span style=" font-family:'Sans'; font-size:14px;">p</span><span style=" font-family:'Sans'; font-size:14px;">rj1.subdir = dir/prj1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a05410380c518557346-4"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a05410380c518557346-5"></a><span style=" font-family:'Sans'; font-size:14px;">#</span><span style=" font-family:'Sans'; font-size:14px;"> Фактически, это то же самое, что</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a05410380c518557346-6"></a><span style=" font-family:'Sans'; font-size:14px;">S</span><span style=" font-family:'Sans'; font-size:14px;">UBDIRS += dir/prj1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a05410380c518557346-7"></a><span style=" font-family:'Sans'; font-size:14px;">#</span><span style=" font-family:'Sans'; font-size:14px;"> только вместо составной переменной dir-prj1 </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a05410380c518557346-8"></a><span style=" font-family:'Sans'; font-size:14px;">#</span><span style=" font-family:'Sans'; font-size:14px;"> теперь используется составная переменная prj1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a05410380c518557346-9"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">Вместо переменной </span><span style=" font-family:'monospace';">.subdir</span><span style=" font-family:'Sans';"> (не одновременно с ней) можно использовать переменную </span><span style=" font-family:'monospace';">.file</span><span style=" font-family:'Sans';">, которая позволяет явно указать путь к .pro файлу дочернего проекта, и в этом случае его имя не должно совпадать с именем каталога проекта. </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><a name="crayon-5b4a054103817199710793"></a><span style=" font-family:'Sans'; font-size:14px;">.</span><span style=" font-family:'Sans'; font-size:14px;">file </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">SUBDIRS += prj1 prj1.file = dir/prj1/project.pro </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Sans'; font-size:14px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:-19px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-family:'Sans'; font-size:14px;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">4 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5b4a054103817199710793-1"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103817199710793-2"></a><span style=" font-family:'Sans'; font-size:14px;">S</span><span style=" font-family:'Sans'; font-size:14px;">UBDIRS += prj1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103817199710793-3"></a><span style=" font-family:'Sans'; font-size:14px;">p</span><span style=" font-family:'Sans'; font-size:14px;">rj1.file = dir/prj1/project.pro</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103817199710793-4"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p></td></tr></table>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:x-large; font-weight:600;">Зависимости между проектами</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">Есть два способа задать порядок билда проектов (их, при желании, можно использовать одновременно). Первый — это указать настойку в переменной </span><span style=" font-family:'monospace';">CONFIG</span><span style=" font-family:'Sans';">, которая означает, что проекты должны компилироваться в том порядке, в котором они указаны в переменной </span><span style=" font-family:'monospace';">SUBDIRS</span><span style=" font-family:'Sans';">: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><a name="crayon-5b4a054103821426243413"></a><span style=" font-family:'Sans'; font-size:14px;">o</span><span style=" font-family:'Sans'; font-size:14px;">rdered </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">CONFIG += ordered </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Sans'; font-size:14px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:-19px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-family:'Sans'; font-size:14px;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">3 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5b4a054103821426243413-1"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103821426243413-2"></a><span style=" font-family:'Sans'; font-size:14px;">C</span><span style=" font-family:'Sans'; font-size:14px;">ONFIG += ordered</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103821426243413-3"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">Второй способ — это явно указать зависимости между проектами. </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><a name="crayon-5b4a05410382b821526608"></a><span style=" font-family:'Sans'; font-size:14px;">.</span><span style=" font-family:'Sans'; font-size:14px;">depends </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">SUBDIRS = prj1 prj2 prj3 prj4 # prj1 будет скомпилирован после prj2 и prj3 prj1.depends = prj2 prj3 </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Sans'; font-size:14px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:-19px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-family:'Sans'; font-size:14px;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">4</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">5 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5b4a05410382b821526608-1"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a05410382b821526608-2"></a><span style=" font-family:'Sans'; font-size:14px;">S</span><span style=" font-family:'Sans'; font-size:14px;">UBDIRS = prj1 prj2 prj3 prj4</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a05410382b821526608-3"></a><span style=" font-family:'Sans'; font-size:14px;">#</span><span style=" font-family:'Sans'; font-size:14px;"> prj1 будет скомпилирован после prj2 и prj3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a05410382b821526608-4"></a><span style=" font-family:'Sans'; font-size:14px;">p</span><span style=" font-family:'Sans'; font-size:14px;">rj1.depends = prj2 prj3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a05410382b821526608-5"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">В </span><span style=" font-family:'monospace';">.depends</span><span style=" font-family:'Sans';"> имена проектов должны указываться в том же виде, в каком они указаны в переменной </span><span style=" font-family:'monospace';">SUBDIRS</span><span style=" font-family:'Sans';">.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:x-large; font-weight:600;">Makefile и subdirs</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">Для проекта можно указать нестандартное имя для Makefile файла. </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><a name="crayon-5b4a054103834672373284"></a><span style=" font-family:'Sans'; font-size:14px;">.</span><span style=" font-family:'Sans'; font-size:14px;">depends </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">prj1.makefile = MyMakefile </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Sans'; font-size:14px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:-19px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-family:'Sans'; font-size:14px;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">3 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5b4a054103834672373284-1"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103834672373284-2"></a><span style=" font-family:'Sans'; font-size:14px;">p</span><span style=" font-family:'Sans'; font-size:14px;">rj1.makefile = MyMakefile</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103834672373284-3"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">При этом по неведомой мне причине стандартный файл с именем Makefile тоже формируется.</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">В корневом Makefile (который получается из .pro файла subdir-проекта) все дочерние проекты оформляются как набор отдельных целей. Префикс для этих целей имеет вид </span><span style=" font-family:'monospace';">sub-имя_переменной_проекта</span><span style=" font-family:'Sans';">. Например, для проекта </span><span style=" font-family:'monospace';">prg1</span><span style=" font-family:'Sans';"> цели будет иметь вид в духе </span><span style=" font-family:'monospace';">sub-prg1-sub_Debug</span><span style=" font-family:'Sans';">. Префикс для целей можно поменять: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><a name="crayon-5b4a054103841177341779"></a><span style=" font-family:'Sans'; font-size:14px;">.</span><span style=" font-family:'Sans'; font-size:14px;">depends </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;"># цели будут иметь вид customtarget-sub_Debug prj1.target = customtarget </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Sans'; font-size:14px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:-19px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-family:'Sans'; font-size:14px;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">4 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5b4a054103841177341779-1"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103841177341779-2"></a><span style=" font-family:'Sans'; font-size:14px;">#</span><span style=" font-family:'Sans'; font-size:14px;"> цели будут иметь вид customtarget-sub_Debug</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103841177341779-3"></a><span style=" font-family:'Sans'; font-size:14px;">p</span><span style=" font-family:'Sans'; font-size:14px;">rj1.target = customtarget</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103841177341779-4"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">И последнее. В корневой Makefile можно добавлять свои цели с помощью </span><a href="http://blog.mgsxx.com/?p=2046"><span style=" font-family:'Sans'; text-decoration: underline; color:#0000ff;">рассмотренного ранее механизма QMAKE_EXTRA_TARGETS</span></a><span style=" font-family:'Sans';">. Просто цель не представляет собой интересна, но в режиме </span><span style=" font-family:'monospace';">recursive</span><span style=" font-family:'Sans';"> этот механизм может быть полезен. </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><a name="crayon-5b4a05410384b857626492"></a><span style=" font-family:'Sans'; font-size:14px;">Д</span><span style=" font-family:'Sans'; font-size:14px;">обавление своей цели в Makefile </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">customtarget.target = check customtarget.CONFIG = recursive customtarget.commands = @echo Check is completed. QMAKE_EXTRA_TARGETS += customtarget </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Sans'; font-size:14px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:-19px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-family:'Sans'; font-size:14px;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">4</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">5</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">6 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5b4a05410384b857626492-1"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a05410384b857626492-2"></a><span style=" font-family:'Sans'; font-size:14px;">c</span><span style=" font-family:'Sans'; font-size:14px;">ustomtarget.target = check</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a05410384b857626492-3"></a><span style=" font-family:'Sans'; font-size:14px;">c</span><span style=" font-family:'Sans'; font-size:14px;">ustomtarget.CONFIG = recursive</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a05410384b857626492-4"></a><span style=" font-family:'Sans'; font-size:14px;">c</span><span style=" font-family:'Sans'; font-size:14px;">ustomtarget.commands = @echo Check is completed.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a05410384b857626492-5"></a><span style=" font-family:'Sans'; font-size:14px;">Q</span><span style=" font-family:'Sans'; font-size:14px;">MAKE_EXTRA_TARGETS += customtarget</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a05410384b857626492-6"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p></td></tr></table>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">Чтобы это работало, в дочерних проектах должны быть определены цели </span><span style=" font-family:'monospace';">check</span><span style=" font-family:'Sans';">. После этого вызов </span><span style=" font-family:'monospace';">make check</span><span style=" font-family:'Sans';"> в корневом каталоге выполнит</span><span style=" font-family:'monospace';"> make check</span><span style=" font-family:'Sans';"> для всех дочерних проектов. Можно в Qt Creator для этого отдельный конфиг настроить, например.</span></p>
<p style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:x-large; font-weight:600;">Небольшая автоматизация</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">Из всех рассмотренных расширенных фич наибольший интерес представляют собой зависимости между проектами. Для некоторого упрощения жизни я использую функцию, почти без изменений позаимствованную </span><a href="http://www.qtcentre.org/wiki/index.php?title=Undocumented_qmake#SUBDIRS_projects"><span style=" font-family:'Sans'; text-decoration: underline; color:#0000ff;">у одного хорошего человека</span></a><span style=" font-family:'Sans';">: </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:21px;"><a name="crayon-5b4a054103857608045024"></a><span style=" font-family:'Sans'; font-size:14px;">a</span><span style=" font-family:'Sans'; font-size:14px;">ddSubdirs </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;"># addSubdirs(subdirs,deps): добавляет subdirs (может быть маской) вместе с зависимостями # пути могут быть как с прямыми, так и с обратными слэшами defineReplace(addSubdirs) { for(subdirs, 1) { entries = $$files($$subdirs) for(entry, entries) { name = $$replace(entry, [/\\\\], _) SUBDIRS += $$name eval ($${name}.subdir = $$entry) for(dep, 2):eval ($${name}.depends += $$replace(dep, [/\\\\], _)) export ($${name}.subdir) export ($${name}.depends) } } export(SUBDIRS) return(1) } # добавляет все проекты из каталога dir, и делает их зависимыми от проекта lib $$addSubdirs(dir/*, lib) </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Sans'; font-size:14px;"><br /></p>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:-27px; margin-right:0px;" cellspacing="2" cellpadding="0">
<tr>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><span style=" font-family:'Sans'; font-size:14px;">1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">2</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">3</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">4</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">5</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">6</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">7</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">8</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">9</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">10</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">11</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">12</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">13</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">14</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">15</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">16</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">17</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">18</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">19</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">20</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">21</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans'; font-size:14px;">22 </span></p></td>
<td>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; line-height:15px;"><a name="crayon-5b4a054103857608045024-1"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103857608045024-2"></a><span style=" font-family:'Sans'; font-size:14px;">#</span><span style=" font-family:'Sans'; font-size:14px;"> addSubdirs(subdirs,deps): добавляет subdirs (может быть маской) вместе с зависимостями</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103857608045024-3"></a><span style=" font-family:'Sans'; font-size:14px;">#</span><span style=" font-family:'Sans'; font-size:14px;"> пути могут быть как с прямыми, так и с обратными слэшами</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103857608045024-4"></a><span style=" font-family:'Sans'; font-size:14px;">d</span><span style=" font-family:'Sans'; font-size:14px;">efineReplace(addSubdirs) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103857608045024-5"></a><span style=" font-family:'Sans'; font-size:14px;"> </span><span style=" font-family:'Sans'; font-size:14px;"> for(subdirs, 1) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103857608045024-6"></a><span style=" font-family:'Sans'; font-size:14px;"> </span><span style=" font-family:'Sans'; font-size:14px;">   entries = $$files($$subdirs)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103857608045024-7"></a><span style=" font-family:'Sans'; font-size:14px;"> </span><span style=" font-family:'Sans'; font-size:14px;">   for(entry, entries) {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103857608045024-8"></a><span style=" font-family:'Sans'; font-size:14px;"> </span><span style=" font-family:'Sans'; font-size:14px;">     name = $$replace(entry, [/\\\\], _)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103857608045024-9"></a><span style=" font-family:'Sans'; font-size:14px;"> </span><span style=" font-family:'Sans'; font-size:14px;">     SUBDIRS += $$name</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103857608045024-10"></a><span style=" font-family:'Sans'; font-size:14px;"> </span><span style=" font-family:'Sans'; font-size:14px;">     eval ($${name}.subdir = $$entry)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103857608045024-11"></a><span style=" font-family:'Sans'; font-size:14px;"> </span><span style=" font-family:'Sans'; font-size:14px;">     for(dep, 2):eval ($${name}.depends += $$replace(dep, [/\\\\], _))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103857608045024-12"></a><span style=" font-family:'Sans'; font-size:14px;"> </span><span style=" font-family:'Sans'; font-size:14px;">     export ($${name}.subdir)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103857608045024-13"></a><span style=" font-family:'Sans'; font-size:14px;"> </span><span style=" font-family:'Sans'; font-size:14px;">     export ($${name}.depends)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103857608045024-14"></a><span style=" font-family:'Sans'; font-size:14px;"> </span><span style=" font-family:'Sans'; font-size:14px;">   }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103857608045024-15"></a><span style=" font-family:'Sans'; font-size:14px;"> </span><span style=" font-family:'Sans'; font-size:14px;"> }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103857608045024-16"></a><span style=" font-family:'Sans'; font-size:14px;"> </span><span style=" font-family:'Sans'; font-size:14px;"> export(SUBDIRS)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103857608045024-17"></a><span style=" font-family:'Sans'; font-size:14px;"> </span><span style=" font-family:'Sans'; font-size:14px;"> return(1)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103857608045024-18"></a><span style=" font-family:'Sans'; font-size:14px;">}</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103857608045024-19"></a><span style=" font-family:'Sans'; font-size:14px;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103857608045024-20"></a><span style=" font-family:'Sans'; font-size:14px;">#</span><span style=" font-family:'Sans'; font-size:14px;"> добавляет все проекты из каталога dir, и делает их зависимыми от проекта lib</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="crayon-5b4a054103857608045024-21"></a><span style=" font-family:'Sans'; font-size:14px;">$</span><span style=" font-family:'Sans'; font-size:14px;">$addSubdirs(dir/*, lib)</span></p></td></tr></table></body></html>