<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">GNU Flex позволяет описать лексический анализатор на простом языке Flex, перечислив регулярные выражения для отдельных токенов и указав код, исполняемый при сопоставлении каждого токена. Затем Flex генерирует код на языке C или C++. Полученный код использует детерминированный конечный автомат для разбора текста.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" font-style:italic; color:#323232;">Пример к статье </span><a href="https://github.com/westes/flex"><span style=" font-style:italic; text-decoration: underline; color:#2a7ae2;">доступен на github</span></a></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">Перед чтением этой статьи рекомендуется ознакомиться со</span><span style=" color:#000000;"> </span><a href="https://ps-group.github.io/compilers/c_style_code"><span style=" text-decoration: underline; color:#2a7ae2;">статьёй об особенностях языка C</span></a></p>
<h2 align="center" style=" margin-top:32px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><a name="wow0"></a><span style=" font-size:x-large; font-weight:600; color:#000000; background-color:#fefefe;">О</span><span style=" font-size:x-large; font-weight:600; color:#000000; background-color:#fefefe;">пции командной строки</span></h2>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" font-style:italic; color:#323232;">Философия UNIX гласит: пишите программы, которые делают что-то одно и делают это хорошо.</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">GNU flex является утилитой командной строки, построенной по принципам UNIX-систем. Утилита принимает множество опций командной строки, в том числе</span><span style=" color:#000000;"> </span><span style=" color:#000000; background-color:#fefefe;">--help</span><span style=" color:#000000;"> и </span><span style=" color:#000000; background-color:#fefefe;">--version</span><span style=" color:#000000;">. Примеры вывода при запуске с этими опциями:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">&gt;flex --version</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">flex 2.6.0</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">&gt;flex --help</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">Использование: flex [ПАРАМЕТРЫ] [ФАЙЛ]…</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">Generates programs that perform pattern-matching on text.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">Table Compression:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -Ca, --align      trade off larger tables for better memory alignment</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -Ce, --ecs        construct equivalence classes</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -Cf               do not compress tables; use -f representation</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -CF               do not compress tables; use -F representation</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -Cm, --meta-ecs   construct meta-equivalence classes</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -Cr, --read       use read() instead of stdio for scanner input</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -f, --full        generate fast, large scanner. Same as -Cfr</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -F, --fast        use alternate table representation. Same as -CFr</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -Cem              default compression (same as --ecs --meta-ecs)</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">Debugging:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -d, --debug             enable debug mode in scanner</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -b, --backup            write backing-up information to lex.backup</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -p, --perf-report       write performance report to stderr</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -s, --nodefault         suppress default rule to ECHO unmatched text</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -T, --trace             flex should run in trace mode</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -w, --nowarn            do not generate warnings</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -v, --verbose           write summary of scanner statistics to stdout</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">      --hex               use hexadecimal numbers instead of octal in debug outputs</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">Files:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -o, --outfile=FILE      specify output filename</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -S, --skel=FILE         specify skeleton file</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -t, --stdout            write scanner on stdout instead of lex.yy.c</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">      --yyclass=NAME      name of C++ class</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">      --header-file=FILE   create a C header file in addition to the scanner</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">      --tables-file[=FILE] write tables to FILE</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">Scanner behavior:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -7, --7bit              generate 7-bit scanner</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -8, --8bit              generate 8-bit scanner</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -B, --batch             generate batch scanner (opposite of -I)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -i, --case-insensitive  ignore case in patterns</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -l, --lex-compat        maximal compatibility with original lex</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -X, --posix-compat      maximal compatibility with POSIX lex</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -I, --interactive       generate interactive scanner (opposite of -B)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">      --yylineno          track line count in yylineno</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">Generated code:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -+,  --c++               generate C++ scanner class</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -Dmacro[=defn]           #define macro defn  (default defn is '1')</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -L,  --noline            suppress #line directives in scanner</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -P,  --prefix=STRING     use STRING as prefix instead of &quot;yy&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -R,  --reentrant         generate a reentrant C scanner</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">       --bison-bridge      scanner for bison pure parser.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">       --bison-locations   include yylloc support.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">       --stdinit           initialize yyin/yyout to stdin/stdout</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">       --noansi-definitions old-style function definitions</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">       --noansi-prototypes  empty parameter list in prototypes</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">       --nounistd          do not include &lt;unistd.h&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">       --noFUNCTION        do not generate a particular FUNCTION</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">Miscellaneous:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -c                      do-nothing POSIX option</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -n                      do-nothing POSIX option</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -?</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -h, --help              produce this help message</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">  -V, --version           report flex version</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<h2 align="center" style=" margin-top:32px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><a name="wow1"></a><span style=" font-size:x-large; font-weight:600; color:#000000; background-color:#fefefe;">З</span><span style=" font-size:x-large; font-weight:600; color:#000000; background-color:#fefefe;">адача: интерпретатор для управления роботом</span></h2>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">Допустим, нам нужно написать простой интерпретатор, принимающий 6 команд:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">help - выводит справку обо всех командах</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">up - направляет робота вверх</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">left - направляет робота влево</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">down - направляет робота вниз</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">right - направляет робота вправо</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">exit - выходит из программы</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">Команды читаются из стандартного потока ввода</span><span style=" color:#000000;"> </span><span style=" color:#000000; background-color:#fefefe;">std::cin</span><span style=" color:#000000;"> последовательно как слова, вывод и ошибки печатаются в потоки </span><span style=" color:#000000; background-color:#fefefe;">std::cin</span><span style=" color:#000000;"> и </span><span style=" color:#000000; background-color:#fefefe;">std::cout</span><span style=" color:#000000;"> соответственно.</span></p>
<h3 align="center" style=" margin-top:24px; margin-bottom:6px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><a name="wow2"></a><span style=" font-size:large; font-weight:600; color:#000000; background-color:#fefefe;">Р</span><span style=" font-size:large; font-weight:600; color:#000000; background-color:#fefefe;">еализация на C++ с помощью iostream</span></h3>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">Ниже представлена реализация, использующая потоки для чтения отдельных слов. Далее мы попробуем дополнить эту реализацию сканером на GNU Flex, а пока что изучите исходный код примера:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#999999; background-color:#ffffff;">#include &lt;string&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#999999; background-color:#ffffff;">#include &lt;map&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#999999; background-color:#ffffff;">#include &lt;memory&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#999999; background-color:#ffffff;">#include &lt;iostream&gt;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-weight:600; color:#999999; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#000000; background-color:#ffffff;">namespace</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#000000; background-color:#ffffff;">struct</span><span style=" color:#000000; background-color:#ffffff;"> Interpreter</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">map</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;</span><span style=" color:#000000; background-color:#ffffff;">std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">string, std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">function</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;</span><span style=" font-weight:600; color:#445588; background-color:#ffffff;">void</span><span style=" color:#000000; background-color:#ffffff;">()</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&gt;&gt;</span><span style=" color:#000000; background-color:#ffffff;"> commands;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    </span><span style=" font-weight:600; color:#445588; background-color:#ffffff;">bool</span><span style=" color:#000000; background-color:#ffffff;"> willExit </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#0086b3; background-color:#ffffff;">false</span><span style=" color:#000000; background-color:#ffffff;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">};</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#000000; background-color:#ffffff;">decltype</span><span style=" color:#000000; background-color:#ffffff;">(</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">auto</span><span style=" color:#000000; background-color:#ffffff;">) MakeRobotInterpreter()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">auto</span><span style=" color:#000000; background-color:#ffffff;"> interpreter </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">make_shared</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;</span><span style=" color:#000000; background-color:#ffffff;">Interpreter</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&gt;</span><span style=" color:#000000; background-color:#ffffff;">();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    interpreter</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">-&gt;</span><span style=" color:#000000; background-color:#ffffff;">commands[</span><span style=" color:#dd1144; background-color:#ffffff;">&quot;up&quot;</span><span style=" color:#000000; background-color:#ffffff;">] </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> [] {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">cout </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;Walking up...&quot;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">endl;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    };</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    interpreter</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">-&gt;</span><span style=" color:#000000; background-color:#ffffff;">commands[</span><span style=" color:#dd1144; background-color:#ffffff;">&quot;down&quot;</span><span style=" color:#000000; background-color:#ffffff;">] </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> [] {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">cout </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;Walking down...&quot;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">endl;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    };</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    interpreter</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">-&gt;</span><span style=" color:#000000; background-color:#ffffff;">commands[</span><span style=" color:#dd1144; background-color:#ffffff;">&quot;left&quot;</span><span style=" color:#000000; background-color:#ffffff;">] </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> [] {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">cout </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;Walking left...&quot;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">endl;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    };</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    interpreter</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">-&gt;</span><span style=" color:#000000; background-color:#ffffff;">commands[</span><span style=" color:#dd1144; background-color:#ffffff;">&quot;right&quot;</span><span style=" color:#000000; background-color:#ffffff;">] </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> [] {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">cout </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;Walking right...&quot;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">endl;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    };</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    interpreter</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">-&gt;</span><span style=" color:#000000; background-color:#ffffff;">commands[</span><span style=" color:#dd1144; background-color:#ffffff;">&quot;help&quot;</span><span style=" color:#000000; background-color:#ffffff;">] </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> [interpreter] {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">cout </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;Available commands:&quot;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">endl;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">for</span><span style=" color:#000000; background-color:#ffffff;"> (</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">const</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">auto</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&amp;</span><span style=" color:#000000; background-color:#ffffff;">pair </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">:</span><span style=" color:#000000; background-color:#ffffff;"> interpreter</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">-&gt;</span><span style=" color:#000000; background-color:#ffffff;">commands)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">            std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">cout </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> pair.first </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">endl;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    };</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    interpreter</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">-&gt;</span><span style=" color:#000000; background-color:#ffffff;">commands[</span><span style=" color:#dd1144; background-color:#ffffff;">&quot;exit&quot;</span><span style=" color:#000000; background-color:#ffffff;">] </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> [interpreter] {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        interpreter</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">-&gt;</span><span style=" color:#000000; background-color:#ffffff;">willExit </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#0086b3; background-color:#ffffff;">true</span><span style=" color:#000000; background-color:#ffffff;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">cout </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;Bye bye!&quot;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">endl;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    };</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">return</span><span style=" color:#000000; background-color:#ffffff;"> interpreter;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#445588; background-color:#ffffff;">void</span><span style=" color:#000000; background-color:#ffffff;"> ExecuteCommand(Interpreter </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&amp;</span><span style=" color:#000000; background-color:#ffffff;">interpreter, </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">const</span><span style=" color:#000000; background-color:#ffffff;"> std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">string </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&amp;</span><span style=" color:#000000; background-color:#ffffff;">word)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">auto</span><span style=" color:#000000; background-color:#ffffff;"> foundIt </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> interpreter.commands.find(word);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">if</span><span style=" color:#000000; background-color:#ffffff;"> (foundIt </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">!=</span><span style=" color:#000000; background-color:#ffffff;"> interpreter.commands.end())</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        foundIt</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">-&gt;</span><span style=" color:#000000; background-color:#ffffff;">second();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">cerr </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;unknown command &quot;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> foundIt</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">-&gt;</span><span style=" color:#000000; background-color:#ffffff;">first </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">endl;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#445588; background-color:#ffffff;">void</span><span style=" color:#000000; background-color:#ffffff;"> ReadInputInLoop(Interpreter </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&amp;</span><span style=" color:#000000; background-color:#ffffff;">interpreter)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">string word;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">while</span><span style=" color:#000000; background-color:#ffffff;"> (</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">!</span><span style=" color:#000000; background-color:#ffffff;">interpreter.willExit </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&amp;&amp;</span><span style=" color:#000000; background-color:#ffffff;"> (std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">cin </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&gt;&gt;</span><span style=" color:#000000; background-color:#ffffff;"> word))</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        ExecuteCommand(interpreter, word);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">}</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#445588; background-color:#ffffff;">int</span><span style=" color:#000000; background-color:#ffffff;"> main()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">auto</span><span style=" color:#000000; background-color:#ffffff;"> interpreter </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> MakeRobotInterpreter();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    ExecuteCommand(</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">*</span><span style=" color:#000000; background-color:#ffffff;">interpreter, </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;help&quot;</span><span style=" color:#000000; background-color:#ffffff;">);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    ReadInputInLoop(</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">*</span><span style=" color:#000000; background-color:#ffffff;">interpreter);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<h3 align="center" style=" margin-top:24px; margin-bottom:6px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><a name="wow3"></a><span style=" font-size:large; font-weight:600; color:#000000; background-color:#fefefe;">О</span><span style=" font-size:large; font-weight:600; color:#000000; background-color:#fefefe;">писание лексера на Flex</span></h3>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">Flex получает описание лексического анализатора из входного файла на специальном языке. Этот файл состоит из трёх секций:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">секция опций позволяет настраивать генерацию лексера</span></li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">секция </span><span style=" font-size:16px; background-color:#fefefe;">%{ ... }%</span><span style=" font-size:18px;"> содержит код на C, который будет размещён выше остального сгенерированного кода</span></li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:15px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">секция </span><span style=" font-size:16px; background-color:#fefefe;">%% ... %%</span><span style=" font-size:18px;"> содержит список правил и обработчиков правил</span></li></ul>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">Обработчик правила — это вставка кода на языке C, которая будет помещена внутрь switch-case. Этот switch-case будет находиться в теле созданной генератором функции, выполняющей сканирование следующего токена. Внутри такой вставки можно выполнить return, чтобы функция вернула сопоставленную подстроку как токен, а можно ничего не делать, чтобы функция пропустила эту подстроку и продолжила выполнение.</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">GNU Flex предполагает, что набор типов токенов уже известен и предоставлен снаружи; дело в том, что этот набор обычно генерирует парсер контекстно-свободной грамматики, и он же проставляет числовое значение для каждого типа токена; генератору GNU Flex числовые значения типов токена безразличны. Ниже показан пример заголовка, определяющего типы токенов:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#999999; background-color:#ffffff;">#pragma once</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-weight:600; color:#999999; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#000000; background-color:#ffffff;">enum</span><span style=" color:#000000; background-color:#ffffff;"> Token</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    </span><span style=" font-style:italic; color:#999988; background-color:#ffffff;">// Token 0 reserved for the end of input.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    TOKEN_HELP </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#009999; background-color:#ffffff;">1</span><span style=" color:#000000; background-color:#ffffff;">,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    TOKEN_UP,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    TOKEN_LEFT,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    TOKEN_DOWN,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    TOKEN_RIGHT,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    TOKEN_EXIT,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">};</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">Далее покажем описание сканера для языка управления роботом:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" font-style:italic; color:#323232;">Flex использует функцию </span><span style=" font-style:italic; color:#323232; background-color:#fefefe;">yywrap()</span><span style=" font-style:italic; color:#323232;"> для поддержки языков с препроцессором и директивой </span><span style=" font-style:italic; color:#323232; background-color:#fefefe;">#include</span><span style=" font-style:italic; color:#323232;">, таких как язык C. В нашем языке нет препроцессора, опция отключена.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#000000; background-color:#ffffff;">%</span><span style=" color:#000000; background-color:#ffffff;">option noyywrap</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#000000; background-color:#ffffff;">%</span><span style=" color:#000000; background-color:#ffffff;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#999999; background-color:#ffffff;">#include &lt;stdio.h&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#999999; background-color:#ffffff;">#include &quot;RobotTokens.h&quot;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-weight:600; color:#999999; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-style:italic; color:#999988; background-color:#ffffff;">// Flex использует макрос YY_DECL как основу объявления функции, сканирующей следующий токен.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-style:italic; color:#999988; background-color:#ffffff;">// По умолчанию значение макроса YY_DECL равно `int yylex()`</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-style:italic; color:#999988; background-color:#ffffff;">// Но мы назовём функцию ScanToken.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#999999; background-color:#ffffff;">#define YY_DECL int ScanToken()</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-weight:600; color:#999999; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#000000; background-color:#ffffff;">%</span><span style=" color:#000000; background-color:#ffffff;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#000000; background-color:#ffffff;">%%</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-weight:600; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">[ </span><span style=" color:#a61717; background-color:#e3d2d2;">\</span><span style=" color:#000000; background-color:#ffffff;">t</span><span style=" color:#a61717; background-color:#e3d2d2;">\</span><span style=" color:#000000; background-color:#ffffff;">r</span><span style=" color:#a61717; background-color:#e3d2d2;">\</span><span style=" color:#000000; background-color:#ffffff;">n]</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">+</span><span style=" color:#000000; background-color:#ffffff;"> { </span><span style=" font-style:italic; color:#999988; background-color:#ffffff;">/* игнорируем пробелы, табы и переносы строк */</span><span style=" color:#000000; background-color:#ffffff;"> }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#dd1144; background-color:#ffffff;">&quot;help&quot;</span><span style=" color:#000000; background-color:#ffffff;">  { </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">return</span><span style=" color:#000000; background-color:#ffffff;"> TOKEN_HELP; }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#dd1144; background-color:#ffffff;">&quot;up&quot;</span><span style=" color:#000000; background-color:#ffffff;">    { </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">return</span><span style=" color:#000000; background-color:#ffffff;"> TOKEN_UP; }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#dd1144; background-color:#ffffff;">&quot;left&quot;</span><span style=" color:#000000; background-color:#ffffff;">  { </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">return</span><span style=" color:#000000; background-color:#ffffff;"> TOKEN_LEFT; }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#dd1144; background-color:#ffffff;">&quot;down&quot;</span><span style=" color:#000000; background-color:#ffffff;">  { </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">return</span><span style=" color:#000000; background-color:#ffffff;"> TOKEN_DOWN; }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#dd1144; background-color:#ffffff;">&quot;right&quot;</span><span style=" color:#000000; background-color:#ffffff;"> { </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">return</span><span style=" color:#000000; background-color:#ffffff;"> TOKEN_RIGHT; }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#dd1144; background-color:#ffffff;">&quot;exit&quot;</span><span style=" color:#000000; background-color:#ffffff;">  { </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">return</span><span style=" color:#000000; background-color:#ffffff;"> TOKEN_EXIT; }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#000000; background-color:#ffffff;">%%</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-weight:600; color:#000000; background-color:#ffffff;"><br /></p>
<h3 align="center" style=" margin-top:24px; margin-bottom:6px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><a name="wow4"></a><span style=" font-size:large; font-weight:600; color:#000000; background-color:#fefefe;">Г</span><span style=" font-size:large; font-weight:600; color:#000000; background-color:#fefefe;">енерация кода сканера с помощью GNU Flex</span></h3>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">Для сборки потребуется запустить flex из командной строки с подходящими опциями (список возможных опций был показан ранее). Лучше всего написать скрипт, который автоматизирует запуск генератора кода и позволит не писать одни и те же команды повторно. Скрипт написан на языке Python:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-style:italic; color:#999988; background-color:#ffffff;">#!/usr/bin/env python</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-style:italic; color:#999988; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">import </span><span style=" color:#555555; background-color:#ffffff;">subprocess</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#555555; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-style:italic; color:#999988; background-color:#ffffff;"># flex получает на вход RobotScanner.l и генерирует RobotScanner.c.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">subprocess</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">.</span><span style=" color:#000000; background-color:#ffffff;">check_call([</span><span style=" color:#dd1144; background-color:#ffffff;">'flex'</span><span style=" color:#000000; background-color:#ffffff;">, </span><span style=" color:#dd1144; background-color:#ffffff;">'-o'</span><span style=" color:#000000; background-color:#ffffff;">, </span><span style=" color:#dd1144; background-color:#ffffff;">'RobotScanner.c'</span><span style=" color:#000000; background-color:#ffffff;">, </span><span style=" color:#dd1144; background-color:#ffffff;">'RobotScanner.l'</span><span style=" color:#000000; background-color:#ffffff;">])</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">Если скрип завершился успешно, откройте “RobotScanner.c” и исследуйте созданный код:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">поищите, куда попала строка </span><span style=" font-size:16px; background-color:#fefefe;">#define YY_DECL int ScanToken()</span><span style=" font-size:18px;"> и где используется макрос </span><span style=" font-size:16px; background-color:#fefefe;">YY_DECL</span></li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:15px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">посмотрите, где оказалась конструкция </span><span style=" font-size:16px; background-color:#fefefe;">return TOKEN_EXIT;</span></li></ul>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">Код в “RobotScanner.c” довольно запутанный, и на деле его можно было написать проще на современном языке C, но GNU Flex рассчитан на работу в любых условиях, включая очень необычные компиляторы и операционные системы.</span></p>
<h3 align="center" style=" margin-top:24px; margin-bottom:6px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><a name="wow5"></a><span style=" font-size:large; font-weight:600; color:#000000; background-color:#fefefe;">П</span><span style=" font-size:large; font-weight:600; color:#000000; background-color:#fefefe;">одключение сканера в main</span></h3>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">GNU Flex сгенерировал только файл .c без заголовка, но это не мешает использовать объявленную в нём функцию ScanToken. Мы сделаем следующее:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">опишем функцию ScanToken без тела, т.е. объявим её без определения</span></li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:15px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-size:18px;">изменим тип поля commands в структуре Interpreter: теперь словарь команд хранит ещё и описания команд, а в роли ключа использует </span><span style=" font-size:16px; background-color:#fefefe;">enum Token</span><span style=" font-size:18px;">.</span></li></ul>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#999999; background-color:#ffffff;">#include &quot;RobotTokens.h&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#999999; background-color:#ffffff;">#include &lt;string&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#999999; background-color:#ffffff;">#include &lt;map&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#999999; background-color:#ffffff;">#include &lt;memory&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#999999; background-color:#ffffff;">#include &lt;iostream&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#999999; background-color:#ffffff;">#include &lt;functional&gt;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-weight:600; color:#999999; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-style:italic; color:#999988; background-color:#ffffff;">// Объявим функции, которые линковщик найдёт в объектном файле, полученном при компиляции RobotScanner.c</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#000000; background-color:#ffffff;">extern</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;C&quot;</span><span style=" color:#000000; background-color:#ffffff;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-style:italic; color:#999988; background-color:#ffffff;">// Возвращает ID сопоставленного токена или 0, если достигнут конец ввода.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#445588; background-color:#ffffff;">int</span><span style=" color:#000000; background-color:#ffffff;"> ScanToken();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#000000; background-color:#ffffff;">namespace</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#000000; background-color:#ffffff;">struct</span><span style=" color:#000000; background-color:#ffffff;"> Command</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">string info;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">function</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;</span><span style=" font-weight:600; color:#445588; background-color:#ffffff;">void</span><span style=" color:#000000; background-color:#ffffff;">()</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&gt;</span><span style=" color:#000000; background-color:#ffffff;"> action;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">};</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#000000; background-color:#ffffff;">struct</span><span style=" color:#000000; background-color:#ffffff;"> Interpreter</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">map</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;</span><span style=" color:#000000; background-color:#ffffff;">Token, Command</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&gt;</span><span style=" color:#000000; background-color:#ffffff;"> commands;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    </span><span style=" font-weight:600; color:#445588; background-color:#ffffff;">bool</span><span style=" color:#000000; background-color:#ffffff;"> willExit </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#0086b3; background-color:#ffffff;">false</span><span style=" color:#000000; background-color:#ffffff;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">};</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#000000; background-color:#ffffff;">decltype</span><span style=" color:#000000; background-color:#ffffff;">(</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">auto</span><span style=" color:#000000; background-color:#ffffff;">) MakeRobotInterpreter()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">auto</span><span style=" color:#000000; background-color:#ffffff;"> interpreter </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">make_shared</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;</span><span style=" color:#000000; background-color:#ffffff;">Interpreter</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&gt;</span><span style=" color:#000000; background-color:#ffffff;">();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    interpreter</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">-&gt;</span><span style=" color:#000000; background-color:#ffffff;">commands[TOKEN_UP] </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;up - moves robot up&quot;</span><span style=" color:#000000; background-color:#ffffff;">,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        [] {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">            std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">cout </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;Walking up...&quot;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">endl;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        }};</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    interpreter</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">-&gt;</span><span style=" color:#000000; background-color:#ffffff;">commands[TOKEN_DOWN] </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;down - moves robot down&quot;</span><span style=" color:#000000; background-color:#ffffff;">,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        [] {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">            std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">cout </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;Walking down...&quot;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">endl;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        }};</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    interpreter</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">-&gt;</span><span style=" color:#000000; background-color:#ffffff;">commands[TOKEN_LEFT] </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;left - moves robot left&quot;</span><span style=" color:#000000; background-color:#ffffff;">,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        [] {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">            std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">cout </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;Walking left...&quot;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">endl;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        }};</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    interpreter</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">-&gt;</span><span style=" color:#000000; background-color:#ffffff;">commands[TOKEN_RIGHT] </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;right - moves robot right&quot;</span><span style=" color:#000000; background-color:#ffffff;">,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        [] {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">            std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">cout </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;Walking right...&quot;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">endl;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        }};</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    interpreter</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">-&gt;</span><span style=" color:#000000; background-color:#ffffff;">commands[TOKEN_HELP] </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;help - outputs this help&quot;</span><span style=" color:#000000; background-color:#ffffff;">,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        [interpreter] {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">            std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">cout </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;Available commands:&quot;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">endl;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">            </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">for</span><span style=" color:#000000; background-color:#ffffff;"> (</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">const</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">auto</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&amp;</span><span style=" color:#000000; background-color:#ffffff;">pair </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">:</span><span style=" color:#000000; background-color:#ffffff;"> interpreter</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">-&gt;</span><span style=" color:#000000; background-color:#ffffff;">commands)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">            {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">                std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">cout </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> pair.second.info </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">endl;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">            }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        }};</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    interpreter</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">-&gt;</span><span style=" color:#000000; background-color:#ffffff;">commands[TOKEN_EXIT] </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;exit - exits program&quot;</span><span style=" color:#000000; background-color:#ffffff;">,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        [interpreter] {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">            interpreter</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">-&gt;</span><span style=" color:#000000; background-color:#ffffff;">willExit </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#0086b3; background-color:#ffffff;">true</span><span style=" color:#000000; background-color:#ffffff;">;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">            std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">cout </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;Bye bye!&quot;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">endl;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        }};</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">return</span><span style=" color:#000000; background-color:#ffffff;"> interpreter;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#445588; background-color:#ffffff;">void</span><span style=" color:#000000; background-color:#ffffff;"> ExecuteCommand(Interpreter </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&amp;</span><span style=" color:#000000; background-color:#ffffff;">interpreter, Token tokenId)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">auto</span><span style=" color:#000000; background-color:#ffffff;"> foundIt </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> interpreter.commands.find(tokenId);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">if</span><span style=" color:#000000; background-color:#ffffff;"> (foundIt </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">!=</span><span style=" color:#000000; background-color:#ffffff;"> interpreter.commands.end())</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        foundIt</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">-&gt;</span><span style=" color:#000000; background-color:#ffffff;">second.action();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">cerr </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;unknown command, type 'help' to see available commands &quot;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">endl;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#445588; background-color:#ffffff;">void</span><span style=" color:#000000; background-color:#ffffff;"> ReadInputInLoop(Interpreter </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&amp;</span><span style=" color:#000000; background-color:#ffffff;">interpreter)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">while</span><span style=" color:#000000; background-color:#ffffff;"> (</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">!</span><span style=" color:#000000; background-color:#ffffff;">interpreter.willExit)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        </span><span style=" font-weight:600; color:#445588; background-color:#ffffff;">int</span><span style=" color:#000000; background-color:#ffffff;"> tokenId </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> ScanToken();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">if</span><span style=" color:#000000; background-color:#ffffff;"> (tokenId </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">==</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#009999; background-color:#ffffff;">0</span><span style=" color:#000000; background-color:#ffffff;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">            </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">return</span><span style=" color:#000000; background-color:#ffffff;">; </span><span style=" font-style:italic; color:#999988; background-color:#ffffff;">// конец ввода</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        ExecuteCommand(interpreter, </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">static_cast&lt;</span><span style=" color:#000000; background-color:#ffffff;">Token</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&gt;</span><span style=" color:#000000; background-color:#ffffff;">(tokenId));</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">}</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#445588; background-color:#ffffff;">int</span><span style=" color:#000000; background-color:#ffffff;"> main()</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">auto</span><span style=" color:#000000; background-color:#ffffff;"> interpreter </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> MakeRobotInterpreter();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    ExecuteCommand(</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">*</span><span style=" color:#000000; background-color:#ffffff;">interpreter, TOKEN_HELP);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    ReadInputInLoop(</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">*</span><span style=" color:#000000; background-color:#ffffff;">interpreter);</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<h2 align="center" style=" margin-top:32px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><a name="wow6"></a><span style=" font-size:x-large; font-weight:600; color:#000000; background-color:#fefefe;">Д</span><span style=" font-size:x-large; font-weight:600; color:#000000; background-color:#fefefe;">обавляем обработку ошибок</span></h2>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">Полученная выше программа не умеет обрабатывать ошибки: любой неожиданный ввод просто отражается обратно в консоль. Это неподобающее поведение, и мы реализуем обработку ошибок.</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">Добавим два новых типа токена в</span><span style=" color:#000000;"> </span><span style=" color:#000000; background-color:#fefefe;">enum Token</span><span style=" color:#000000;">:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-style:italic; color:#999988; background-color:#ffffff;">// ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">TOKEN_UNEXPECTED_WORD, </span><span style=" font-style:italic; color:#999988; background-color:#ffffff;">// неожиданная команда</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">TOKEN_ERROR, </span><span style=" font-style:italic; color:#999988; background-color:#ffffff;">// символ, не входящий в алфавит языка</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-style:italic; color:#999988; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">Добавим два новых правила сканера в “RobotScanner.l”:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-style:italic; color:#999988; background-color:#ffffff;">// ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#dd1144; background-color:#ffffff;">&quot;exit&quot;</span><span style=" color:#000000; background-color:#ffffff;">  { </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">return</span><span style=" color:#000000; background-color:#ffffff;"> TOKEN_EXIT; }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">[a</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">-</span><span style=" color:#000000; background-color:#ffffff;">zA</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">-</span><span style=" color:#000000; background-color:#ffffff;">Z]</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">+</span><span style=" color:#000000; background-color:#ffffff;"> { </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">return</span><span style=" color:#000000; background-color:#ffffff;"> TOKEN_UNEXPECTED_WORD; }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">.       { </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">return</span><span style=" color:#000000; background-color:#ffffff;"> TOKEN_ERROR; }</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">Модифицируем функцию ReadInputInLoop, чтобы обрабатывать TOKEN_ERROR. Обрабатывать TOKEN_UNEXPECTED_WORD в этой функции не надо, т.к. функция ExecuteCommand уже обрабатывает неопознанные команды.</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-weight:600; color:#445588; background-color:#ffffff;">void</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" font-weight:600; color:#990000; background-color:#ffffff;">ReadInputInLoop</span><span style=" color:#000000; background-color:#ffffff;">(Interpreter </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&amp;</span><span style=" color:#000000; background-color:#ffffff;">interpreter)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">{</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">while</span><span style=" color:#000000; background-color:#ffffff;"> (</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">!</span><span style=" color:#000000; background-color:#ffffff;">interpreter.willExit)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        </span><span style=" font-weight:600; color:#445588; background-color:#ffffff;">int</span><span style=" color:#000000; background-color:#ffffff;"> tokenId </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">=</span><span style=" color:#000000; background-color:#ffffff;"> ScanToken();</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">if</span><span style=" color:#000000; background-color:#ffffff;"> (tokenId </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">==</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#009999; background-color:#ffffff;">0</span><span style=" color:#000000; background-color:#ffffff;">)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">            </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">return</span><span style=" color:#000000; background-color:#ffffff;">; </span><span style=" font-style:italic; color:#999988; background-color:#ffffff;">// конец ввода</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">if</span><span style=" color:#000000; background-color:#ffffff;"> (tokenId </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">==</span><span style=" color:#000000; background-color:#ffffff;"> TOKEN_ERROR)</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">            std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">cerr </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" color:#dd1144; background-color:#ffffff;">&quot;wrong character in input&quot;</span><span style=" color:#000000; background-color:#ffffff;"> </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&lt;&lt;</span><span style=" color:#000000; background-color:#ffffff;"> std</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">::</span><span style=" color:#000000; background-color:#ffffff;">endl;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">else</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        {</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">            ExecuteCommand(interpreter, </span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">static_cast&lt;</span><span style=" color:#000000; background-color:#ffffff;">Token</span><span style=" font-weight:600; color:#000000; background-color:#ffffff;">&gt;</span><span style=" color:#000000; background-color:#ffffff;">(tokenId));</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">        }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">    }</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">}</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">После перекомпиляции и запуска программы введём “no!!!” и получим:</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">&gt;no!!!</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">unknown command, type 'help' to see available commands </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">wrong character in input</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">wrong character in input</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" color:#000000; background-color:#ffffff;">wrong character in input</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000; background-color:#ffffff;"><br /></p>
<h2 align="center" style=" margin-top:32px; margin-bottom:10px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><a name="wow7"></a><span style=" font-size:x-large; font-weight:600; color:#000000; background-color:#fefefe;">Ч</span><span style=" font-size:x-large; font-weight:600; color:#000000; background-color:#fefefe;">то делать дальше?</span></h2>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">Поупражняйтесь с Flex: попробуйте описать правила для ключевых слов и операторов языка C, или сделать сканер для кода на Python. Не забывайте, что GNU Flex способен работать только с регулярными грамматиками, в которых нет рекурсивно определённых правил.</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">Если вы хотите использовать свой объект во вставках кода для правил, просто модифицируйте YY_DECL:</span><span style=" color:#000000;"> </span><span style=" color:#000000; background-color:#fefefe;">#define YY_DECL int ScanToken(MyClass *myClass)</span><span style=" color:#000000;">. Тогда сгенерированной функции будет параметр myClass, который сам Flex использовать не станет.</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">Для отладки правил сканера советуем использовать отладчики регулярных выражений, которые легко найти в поисковике по запросу “online regex debugger”.</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">Справку можно получить на stackoverflow по тегу flex-lexer:</span><span style=" color:#000000;"> </span><a href="http://stackoverflow.com/questions/tagged/flex-lexer"><span style=" text-decoration: underline; color:#2a7ae2;">stackoverflow.com/questions/tagged/flex-lexer</span></a><span style=" color:#000000;">.</span></p>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">Избранные вопросы по интеграции GNU Flex в сборку проекта:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://stackoverflow.com/questions/5456011/"><span style=" font-size:18px; text-decoration: underline; color:#2a7ae2;">How to compile LEX/YACC files on Windows?</span></a></li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://stackoverflow.com/questions/2793413/"><span style=" font-size:18px; text-decoration: underline; color:#2a7ae2;">unistd.h related difficulty when compiling bison &amp; flex program under vc++</span></a></li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:15px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://stackoverflow.com/questions/19398113/"><span style=" font-size:18px; text-decoration: underline; color:#2a7ae2;">CMake and Flex/Bison</span></a></li></ul>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">По интеграции сканера в код проекта:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://stackoverflow.com/questions/780676/"><span style=" font-size:18px; text-decoration: underline; color:#2a7ae2;">String input to flex lexer</span></a></li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://stackoverflow.com/questions/1796520/"><span style=" font-size:18px; text-decoration: underline; color:#2a7ae2;">In lex how to make yyin point to a file with the main function in yacc?</span></a></li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://stackoverflow.com/questions/22107203/"><span style=" font-size:18px; text-decoration: underline; color:#2a7ae2;">Configuring Bison and Flex without global or static variable</span></a></li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:15px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://stackoverflow.com/questions/6467166/"><span style=" font-size:18px; text-decoration: underline; color:#2a7ae2;">bison/flex: print erroneous line</span></a></li></ul>
<p style=" margin-top:0px; margin-bottom:15px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fefefe;"><span style=" color:#000000; background-color:#fefefe;">По составлению правил сканера:</span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://stackoverflow.com/questions/2039795/"><span style=" font-size:18px; text-decoration: underline; color:#2a7ae2;">Regular expression for a string literal in flex/lex</span></a></li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://stackoverflow.com/questions/2130097/"><span style=" font-size:18px; text-decoration: underline; color:#2a7ae2;">Difficulty getting c-style comments in flex/lex</span></a></li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:0px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://stackoverflow.com/questions/1413204/"><span style=" font-size:18px; text-decoration: underline; color:#2a7ae2;">How to use indentation as block delimiters with bison and flex</span></a></li>
<li style=" color:#000000;" style=" margin-top:0px; margin-bottom:15px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://stackoverflow.com/questions/8379299/"><span style=" font-size:18px; text-decoration: underline; color:#2a7ae2;">Is it possible to set priorities for rules to avoid the “longest-earliest” matching pattern?</span></a></li></ul>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; color:#000000;"><br /></p></body></html>