<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="Computational_formulas"></a><span style=" font-family:'Sans'; font-size:large; font-weight:600;">C</span><span style=" font-family:'Sans'; font-size:large; font-weight:600;">omputational formulas</span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">On computer systems with low </span><a href="https://en.wikipedia.org/wiki/Floating_point"><span style=" font-family:'Sans'; text-decoration: underline; color:#0000ff;">floating-point precision</span></a><span style=" font-family:'Sans';">, the spherical law of cosines formula can have large </span><a href="https://en.wikipedia.org/wiki/Rounding_error"><span style=" font-family:'Sans'; text-decoration: underline; color:#0000ff;">rounding errors</span></a><span style=" font-family:'Sans';"> if the distance is small (if the two points are a kilometer apart on the surface of the Earth, the cosine of the central angle comes out 0.99999999). For modern </span><a href="https://en.wikipedia.org/wiki/IEEE_754"><span style=" font-family:'Sans'; text-decoration: underline; color:#0000ff;">64-bit floating-point numbers</span></a><span style=" font-family:'Sans';">, the spherical law of cosines formula, given above, does not have serious rounding errors for distances larger than a few meters on the surface of the Earth.</span><a name="cite_ref-3"></a><a href="https://en.wikipedia.org/wiki/Great-circle_distance#cite_note-3"><span style=" font-family:'Sans'; text-decoration: underline; color:#0000ff; vertical-align:super;">[</span></a><span style=" font-family:'Sans'; text-decoration: underline; color:#0000ff; vertical-align:super;">3]</span><span style=" font-family:'Sans';"> The </span><a href="https://en.wikipedia.org/wiki/Haversine_formula"><span style=" font-family:'Sans'; text-decoration: underline; color:#0000ff;">haversine formula</span></a><span style=" font-family:'Sans';"> is </span><a href="https://en.wikipedia.org/wiki/Condition_number"><span style=" font-family:'Sans'; text-decoration: underline; color:#0000ff;">numerically better-conditioned</span></a><span style=" font-family:'Sans';"> for small distances:</span><a name="cite_ref-4"></a><a href="https://en.wikipedia.org/wiki/Great-circle_distance#cite_note-4"><span style=" font-family:'Sans'; text-decoration: underline; color:#0000ff; vertical-align:super;">[</span></a><span style=" font-family:'Sans'; text-decoration: underline; color:#0000ff; vertical-align:super;">4]</span><span style=" font-family:'Sans';"> </span></p>
<p style=" margin-top:8px; margin-bottom:8px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><img src="image1533399621qidnrj5rit.png" width="507" height="64" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">Historically, the use of this formula was simplified by the availability of tables for the </span><a href="https://en.wikipedia.org/wiki/Haversine"><span style=" font-family:'Sans'; text-decoration: underline; color:#0000ff;">haversine</span></a><span style=" font-family:'Sans';"> function: hav(</span><span style=" font-family:'Sans'; font-style:italic;">θ</span><span style=" font-family:'Sans';">) = sin</span><span style=" font-family:'Sans'; vertical-align:super;">2</span><span style=" font-family:'Sans';">(</span><span style=" font-family:'Sans'; font-style:italic;">θ</span><span style=" font-family:'Sans';">/2). </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">Although this formula is accurate for most distances on a sphere, it too suffers from rounding errors for the special (and somewhat unusual) case of </span><a href="https://en.wikipedia.org/wiki/Antipodal_point"><span style=" font-family:'Sans'; text-decoration: underline; color:#0000ff;">antipodal points</span></a><span style=" font-family:'Sans';"> (on opposite ends of the sphere). A more complicated formula that is accurate for all distances is the following special case of the </span><a href="https://en.wikipedia.org/wiki/Vincenty%27s_formulae"><span style=" font-family:'Sans'; text-decoration: underline; color:#0000ff;">Vincenty formula</span></a><span style=" font-family:'Sans';"> for an ellipsoid with equal major and minor axes:</span><a name="cite_ref-5"></a><a href="https://en.wikipedia.org/wiki/Great-circle_distance#cite_note-5"><span style=" font-family:'Sans'; text-decoration: underline; color:#0000ff; vertical-align:super;">[</span></a><span style=" font-family:'Sans'; text-decoration: underline; color:#0000ff; vertical-align:super;">5]</span><span style=" font-family:'Sans';"> </span></p>
<p style=" margin-top:8px; margin-bottom:8px; margin-left:30px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';"> </span><img src="image1533399621fms6t8cevy.png" width="693" height="73" /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Sans';">When programming a computer, one should use the </span><a href="https://en.wikipedia.org/wiki/Atan2"><span style=" font-family:'monospace'; text-decoration: underline; color:#0000ff;">atan2</span></a><span style=" font-family:'monospace';">()</span><span style=" font-family:'Sans';"> function rather than the ordinary arctangent function (</span><span style=" font-family:'monospace';">atan()</span><span style=" font-family:'Sans';">), so that Δ σ {\displaystyle \Delta \sigma } </span><img src="image1533399621kyr8re7riz.png" width="28" height="18" /><span style=" font-family:'Sans';"> is placed in the correct quadrant. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'Sans';"><br /></p></body></html>