<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:10pt; font-weight:400; font-style:normal;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="0">
<tr>
<td style=" padding-left:1; padding-right:1; padding-top:1; padding-bottom:0;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="3">
<tr>
<td>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="5">
<tr>
<td width="85%" style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Чтобы нормально работали saveState() и restoreState().. надо чтобы для всех обьектов которые сохраняются и восстанавливаются, были заданны имена (в дизанере например <img src="http://prog.org.ru/forum/Smileys/default/smiley.gif" style="vertical-align: top;" />) </p></td></tr>
<tr>
<td style=" vertical-align:bottom;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="2" cellpadding="0">
<tr>
<td colspan="2" style=" vertical-align:bottom;"></td></tr>
<tr>
<td width="50%" style=" vertical-align:bottom;"></td>
<td width="50%" style=" vertical-align:bottom;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="modified_76545"></a><a href="http://www.prog.org.ru/index.php?action=reporttm;topic=12127.1;msg=76545"><span style=" text-decoration: underline; color:#0000ff;">С</span></a><span style=" text-decoration: underline; color:#0000ff;">ообщить модератору</span>   <img src="http://prog.org.ru/Themes/default/images/ip.gif" /> <a href="http://www.prog.org.ru/index.php?action=helpadmin;help=see_member_ip"><span style=" text-decoration: underline; color:#0000ff;">Записан</span></a> </p></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr>
<td style=" padding-left:1; padding-right:1; padding-top:1; padding-bottom:0;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="3">
<tr>
<td>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="5">
<tr>
<td width="16%" rowspan="2" style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="msg76556"></a><span style=" font-weight:600;">b</span><span style=" font-weight:600;">abutta</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Гость<br /></p></td>
<td width="85%" style=" vertical-align:top;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:middle;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://www.prog.org.ru/index.php?topic=12127.msg76556#msg76556"><img src="http://prog.org.ru/Themes/default/images/post/xx.gif" style="vertical-align: middle;" /></a></p></td>
<td style=" vertical-align:middle;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="subject_76556"></a><a href="http://www.prog.org.ru/index.php?topic=12127.msg76556#msg76556"><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">R</span></a><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">e: QMainWindow не восстанавливает размеры centralWidget'a</span><span style=" font-weight:600;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">« <span style=" font-weight:600;">Ответ #2 :</span> Январь 21, 2010, 13:58 »</p></td>
<td style=" vertical-align:bottom;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://www.prog.org.ru/index.php?action=post;quote=76556;topic=12127.0;num_replies=4;sesc=627db28962dc62c04d89cd1161dd0030"><img src="http://prog.org.ru/Themes/default/images/buttons/quote.gif" style="vertical-align: middle;" /></a><a href="http://www.prog.org.ru/index.php?action=post;quote=76556;topic=12127.0;num_replies=4;sesc=627db28962dc62c04d89cd1161dd0030"><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">Цитировать</span></a> </p></td></tr></table>
<hr width="100%"/>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">имена объектов заданы конечно (через setObjectName()) для всех уникальные, иначе бы этот механизм вообще не работал.<br />а он работает, только не так как должен =( </p></td></tr>
<tr>
<td style=" vertical-align:bottom;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="2" cellpadding="0">
<tr>
<td colspan="2" style=" vertical-align:bottom;"></td></tr>
<tr>
<td width="50%" style=" vertical-align:bottom;"></td>
<td width="50%" style=" vertical-align:bottom;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="modified_76556"></a><a href="http://www.prog.org.ru/index.php?action=reporttm;topic=12127.2;msg=76556"><span style=" text-decoration: underline; color:#0000ff;">С</span></a><span style=" text-decoration: underline; color:#0000ff;">ообщить модератору</span>   <img src="http://prog.org.ru/Themes/default/images/ip.gif" /> <a href="http://www.prog.org.ru/index.php?action=helpadmin;help=see_member_ip"><span style=" text-decoration: underline; color:#0000ff;">Записан</span></a> </p></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr>
<td style=" padding-left:1; padding-right:1; padding-top:1; padding-bottom:0;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="3">
<tr>
<td>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="5">
<tr>
<td width="16%" rowspan="2" style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="msg77130"></a><span style=" font-weight:600;">b</span><span style=" font-weight:600;">abutta</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Гость<br /></p></td>
<td width="85%" style=" vertical-align:top;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:middle;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://www.prog.org.ru/index.php?topic=12127.msg77130#msg77130"><img src="http://prog.org.ru/Themes/default/images/post/xx.gif" style="vertical-align: middle;" /></a></p></td>
<td style=" vertical-align:middle;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="subject_77130"></a><a href="http://www.prog.org.ru/index.php?topic=12127.msg77130#msg77130"><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">R</span></a><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">e: QMainWindow не восстанавливает размеры centralWidget'a</span><span style=" font-weight:600;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">« <span style=" font-weight:600;">Ответ #3 :</span> Январь 26, 2010, 14:08 »</p></td>
<td style=" vertical-align:bottom;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://www.prog.org.ru/index.php?action=post;quote=77130;topic=12127.0;num_replies=4;sesc=627db28962dc62c04d89cd1161dd0030"><img src="http://prog.org.ru/Themes/default/images/buttons/quote.gif" style="vertical-align: middle;" /></a><a href="http://www.prog.org.ru/index.php?action=post;quote=77130;topic=12127.0;num_replies=4;sesc=627db28962dc62c04d89cd1161dd0030"><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">Цитировать</span></a> </p></td></tr></table>
<hr width="100%"/>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">В общем проблема решена... не без посторонних внимательных глаз =)<br />Ошибка была в том, что я пользовался конструктором и деструктором для восстановления и сохранения состояния соответственно...<br />так вот восстановление состояния на конструкторе было ошибкой...<br />как только перешел на closeEvent() и showEvent() так все и заработало =) </p></td></tr>
<tr>
<td style=" vertical-align:bottom;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="2" cellpadding="0">
<tr>
<td colspan="2" style=" vertical-align:bottom;"></td></tr>
<tr>
<td width="50%" style=" vertical-align:bottom;"></td>
<td width="50%" style=" vertical-align:bottom;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="modified_77130"></a><a href="http://www.prog.org.ru/index.php?action=reporttm;topic=12127.3;msg=77130"><span style=" text-decoration: underline; color:#0000ff;">С</span></a><span style=" text-decoration: underline; color:#0000ff;">ообщить модератору</span>   <img src="http://prog.org.ru/Themes/default/images/ip.gif" /> <a href="http://www.prog.org.ru/index.php?action=helpadmin;help=see_member_ip"><span style=" text-decoration: underline; color:#0000ff;">Записан</span></a> </p></td></tr></table></td></tr></table></td></tr></table></td></tr>
<tr>
<td style=" padding-left:1; padding-right:1; padding-top:1; padding-bottom:0;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="3">
<tr>
<td>
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="0" cellpadding="5">
<tr>
<td width="16%" style=" vertical-align:top;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="msg89320"></a><span style=" font-weight:600;">b</span><span style=" font-weight:600;">abutta</span> </p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Гость<br /></p></td>
<td width="85%" style=" vertical-align:top;">
<table border="0" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px;" width="100%" cellspacing="2" cellpadding="0">
<tr>
<td style=" vertical-align:middle;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://www.prog.org.ru/index.php?topic=12127.msg89320#msg89320"><img src="http://prog.org.ru/Themes/default/images/post/xx.gif" style="vertical-align: middle;" /></a></p></td>
<td style=" vertical-align:middle;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a name="subject_89320"></a><a href="http://www.prog.org.ru/index.php?topic=12127.msg89320#msg89320"><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">R</span></a><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">e: QMainWindow не восстанавливает размеры centralWidget'a</span><span style=" font-weight:600;"> </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">« <span style=" font-weight:600;">Ответ #4 :</span> Май 27, 2010, 09:08 »</p></td>
<td style=" vertical-align:bottom;">
<p align="right" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><a href="http://www.prog.org.ru/index.php?action=post;quote=89320;topic=12127.0;num_replies=4;sesc=627db28962dc62c04d89cd1161dd0030"><img src="http://prog.org.ru/Themes/default/images/buttons/quote.gif" style="vertical-align: middle;" /></a><a href="http://www.prog.org.ru/index.php?action=post;quote=89320;topic=12127.0;num_replies=4;sesc=627db28962dc62c04d89cd1161dd0030"><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">Цитировать</span></a> </p></td></tr></table>
<hr width="100%"/>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">вот еще раз пришлось столкнуться с этим же... забыл как боролся и в поиске увидел свой пост, нашел свою ошибку и решил поправить =)<br /><br />После внимательного прочтения ( целого абзаца! =) ) документации оказалось, что никто и не обещал восстановления геометрии главного окна при вызове метода restoreState().<br /><br />В общем не важно где происходит сохранение в деструкторе или в closeEvent(), как, думаю, не важно и с восстановлением... Важно сохранять и восстанавливать (если это, конечно, требуется) и геометрию и состояние отдельно!<br /><br />Вот так все работает:<br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Код:</p>
<pre style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Courier New,courier';">ActionTest::ActionTest(QWidget *parent, Qt::WFlags flags)<br />    : QMainWindow(parent, flags)<br />{<br />    QSettings s;<br /><br />    restoreGeometry( s.value( APP_GEOMETRY, QByteArray() ).toByteArray() ); <br />    restoreState( s.value( APP_STATE, QByteArray() ).toByteArray() );<br />}<br /><br />ActionTest::~ActionTest()<br />{<br />    QSettings s;<br />    <br />    s.setValue( APP_STATE, saveState() );<br />    s.setValue( APP_GEOMETRY, saveGeometry() );<br />}</span></pre></td></tr></table></td></tr></table></td></tr></table></body></html>