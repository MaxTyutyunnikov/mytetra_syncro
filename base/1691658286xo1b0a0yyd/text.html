<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">В статье описаны наиболее распространенные и часто используемые варианты реализации контроля доступа клиента к web серверу Apache на основе анализа разнообразных характеристик запроса. Представлен синтаксис и примеры директив Require, Allow, Deny, Order, RequireAll, RequireAny, RequireNone и подробно расписаны типы и виды аргументов для этих директив. Приведены примеры для ограничения доступа к сайту или его части по IP, названию хоста, агенту пользователя и другие. </span></p>
<h2 style=" margin-top:16px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Директивы управления доступом </span></h2>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Управление доступом клиента к </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">web</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> серверу на основе значений хоста и других параметров запроса реализуется в </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Apache</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> при помощи директив </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Allow</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Deny</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Order</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> из соответствующих модулей web сервера. Основное предназначение этого функционала в том, что </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Apache</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> позволяет выполнять ограничения доступа клиента к web серверу на основе анализа разных характеристик запроса клиента, от которого получен запрос. На деле это позволяет блокировать или разрешать доступ к серверу по доменному имени (</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">hostname</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">) или по </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">IP</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> адресу хоста клиента, сделавшего текущий запрос, и по многим другим параметрам. Этот подход является одним из нескольких вариантов по реализации ограничения и короля доступа, предоставляемых web сервером </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Apache</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> и здесь использование директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> с методами проверки хоста, является частным случаем применения этой директивы.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:33px; -qt-block-indent:0; text-indent:0px; background-color:#fbe6f2;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fbe6f2;"> Директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Allow</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Deny</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Order</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> модуля mod_access_compat </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">нежелательны</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> к использованию и считаются устаревшими, хотя и поддерживаются еще в версиях Apache 2.3 и 2.4, но в следующих версиях они будут удалены. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Теперь, вместо устаревших директив </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Allow</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Deny</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Order</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, начиная с версии </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Apache 2.3</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, этот функционал реализуется директивой </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> из модуля </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">mod_authz_core</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> с дополнительным методом проверки авторизации на основе значений хоста из нового модуля </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">mod_authz_host</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. Нужно так же заметить, что директива Require как с базовыми методами, так и дополнительными предоставляет намного более гибкий функционал по контролю доступа к web серверу, чем устаревшие директивы. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Если посмотреть хронологию директив </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Allow</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Deny</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Order</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> в разных версиях Apache, то можно вспомнить, что в Apache версии 2.2 и более старых эти директивы были реализованы в модуле </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">mod_access</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> и активно использовались для короля доступа. Начиная с версии Apache 2.3 эти директивы стали выводиться из обращения и, реализуемый ими функционал, стал предоставляться теперь директивой </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. Для этого директива была расширена новым модулем </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">mod_authz_host</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, который был добавлен в Apache начиная с версии 2.3 и призван в дальнейшем обеспечивать этот функционал управления доступом на основе значений хоста клиента как частный случай использования директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, взамен устаревших модулей и директив. Поэтому функционал устаревающих директив </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Allow</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Deny</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Order</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> был перенесен в модуль </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">mod_access_compat</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, который появился в Apache начиная с версии 2.3 (</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">он есть и в 2.4 версии</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">) для поддержки совместимости со старыми сайтами (</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">их конфигами</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">), которые еще применяют для конфигурации Apache устаревшие директивы.Однако, несмотря на то, что директива </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> теперь заменяет функционал директив </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Allow</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Deny</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Order</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, применение этого функционала, вид и форматы аргументов остались неизменными. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Allow</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Deny</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Order</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> предназначены для управления доступом на уровне </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline;">директорий</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> (</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">каталогов</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">) сайта и могут применяться в конфигурационных файлах </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Apache</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> внутри тегов (</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">директив</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">) </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Directory&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Files&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> или </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Location&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, или напрямую, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline;">без</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> этих тегов, в файле </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">.htaccess</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, позволяя детально контролировать и управлять доступом к тем или иным разделам и папкам сайта на web сервере. Директивы-теги </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Directory&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Files&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Location&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> используются в глобальном конфиге или в конфиге виртуального хоста </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Apache</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> для задания локализации (</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">директории сайта с распространением действия на вложенные подкаталоги</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">) применения заключенных в них директив. Эти директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600; text-decoration: underline;">не</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> используются в </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">.htaccess</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, так как этот файл сам по себе уже является локализованным каталогом, в котором он помещен.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:36px; -qt-block-indent:0; text-indent:0px; background-color:#fbe6f2;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fbe6f2;">Соблюдайте осторожность при установке директив </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline;">авторизации</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> в </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Location  &quot;URL-path|URL&quot;&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> секциях, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">URL</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> аргумент которых перекрывается с файловым путем в файловой системе вашего Linux сервера. Это связано с тем, что по умолчанию</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;"> &lt;Location&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> перезаписывает конфигурации </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Directory&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> и </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Files&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, так как </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Location&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> секции обрабатываются в порядке их появления в файле конфигурации, после того как </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Directory&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Files&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> и </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">.htaccess</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> уже прочитаны Apache. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Применять же директиву </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Location&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> нужно только для контента, который находиться </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline;">вне</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> пределов файловой системы сервера, так как эта директива принимает URL как аргумент, а не путь в файловой системе. Исключение из этого может быть вариант применение директивы в виде  </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Location &quot;/&quot;&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, который является легким способом применить конфигурацию сразу ко всему серверу </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Apache</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">#Пример из конфига виртуального хоста</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;Directory &quot;/www/example&quot;&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">    #Будут действовать только для указанного каталога</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">    Require entity-name ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">    Require entity-name ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;/Directory&gt;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">По умолчанию, все эти директивы ограничения доступа применяются ко всем типам запроса - </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">GET</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">PUT</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">POST</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, и т.д, что удобно и оптимально для большинства случаев. Однако, можно ограничить применение этих директив только на нужных вам методах запроса посредством помещения директивы (</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">директив</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">) в тег </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Limit&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;Limit POST&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">  #Здесь директивы будут работать только для POST типа запроса,</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">  #Другие типы запросов будут выполняться без ограничений</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">  Require ip entity-name ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">  Require ip entity-name ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">  ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;/Limit&gt;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Если </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> авторизация применена для каталога при помощи секций </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Directory&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Files&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Location&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> или напрямую в файле </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">.htaccess</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, то она по умолчанию наследуется каждой последующей секцией конфигурации для этого каталога и подкаталогов, если иной набор директив </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> авторизации не указан для них. Такое поведение по умолчанию определяется директивой </span><a href="https://httpd.apache.org/docs/2.4/mod/mod_authz_core.html#authmerging"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600; text-decoration: underline; color:#0000ff;">AuthMerging</span></a><a href="https://httpd.apache.org/docs/2.4/mod/mod_authz_core.html#authmerging"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline; color:#0000ff;"> </span></a><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> со значением по умолчанию равным </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">AuthMerging Off</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. Именно директива </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">AuthMerging</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> задает логику переопределения директив авторизации. Если она установлена как </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">AuthMerging And</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, то директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> секций будут объединяться, как если бы они были заключены в </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireAll&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. Если </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">AuthMerging Or</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, то директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> из секций будут объединяться, как если бы они были заключены в </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireAny&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Общий синтаксис директивы Require:</span></h3>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Описание</span>: Проверяет, прошел ли аутентифицированный (<span style=" font-style:italic;">распознанный</span>) пользователь авторизацию посредством указанного в директиве для этого метода; </li>
<li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Синтаксис:</span> <span style=" font-family:'verdana','geneva','sans-serif'; font-weight:600;">Require</span><span style=" font-family:'verdana','geneva','sans-serif';"> [</span><span style=" font-family:'verdana','geneva','sans-serif'; font-weight:600;">not</span><span style=" font-family:'verdana','geneva','sans-serif';">] entity-name [entity-name] ...;</span> </li>
<li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Контекст применения директивы:</span>    <span style=" font-family:'verdana','geneva','sans-serif';">directory, .htaccess;</span> </li>
<li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Переопределение директивы:</span> что бы директива <span style=" font-weight:600;">Require</span> была доступна в <span style=" font-weight:600;">.htaccess</span> файле сайта/каталога она должна быть разрешена в конфигурационном файле более высокого уровня (<span style=" font-style:italic;">конфиг виртуального хоста или глобальный конфиг Apache</span>) для этого каталога (<span style=" font-style:italic;">каталогов</span>) выражением: <span style=" font-family:'verdana','geneva','sans-serif';">AllowOverride AuthConfig</span> или выражением <span style=" font-family:'verdana','geneva','sans-serif';">AllowOverride All</span> </li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Например:</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;Directory /home/mysite/www&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">        #Пример из конфига виртуального хоста</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">        ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">        AllowOverride AuthConfig</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">        # или</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">        #AllowOverride All</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">        ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;/Directory&gt;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"><br /></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Статус: </span> директива <span style=" font-weight:600;">Require</span> является базовым функционалам и входит в состав <span style=" font-weight:600;">Apache</span> по умолчанию; </li>
<li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Модуль Apache:</span> директива предоставляется модулем <a href="http://httpd.apache.org/docs/2.4/mod/mod_authz_core.html"><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">mod_authz_core</span></a><a href="http://httpd.apache.org/docs/2.4/mod/mod_authz_core.html"><span style=" text-decoration: underline; color:#0000ff;"> </span></a> ; </li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span></p>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Общее описание директивы Require: </span></h3>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Директива </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> проверяет аутентифицированного (</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">распознанного</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">) пользователя текущего запроса на предмет успешного прохождения им авторизации в соответствии с конкретным, заданным в ней методом авторизации и указанных ограничений и условий. В результате чего, если такая проверка прошла успешно, то доступ разрешатся к сайту, его части или каталогу. По другому можно сказать так, что сама по себе директива </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> - это всегда принятие решения о предоставлении клиенту доступа к сайту или его части. Если директива исполняется, то доступ текущему клиенту разрешается, если директива не исполняется, то доступ запрещается. Директива </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> исполняется и доступ клиенту разрешается, если метод проверки авторизации, указанный в этой директиве (</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">суммарное выражение из аргументов директивы - все, что справа от названия директивы</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">) в общем итоге возвращает </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">истину</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. Если метод проверки суммарно возвращает </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">ложь</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, то директива не исполняется и доступ клиенту запрещается. Это базовая логика работы отдельно взятой директивы. Однако, директива </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> может применяться не только в виде одиночного варианта, а возможно одновременное использование нескольких вызовов этой директивы (</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">несколько записей</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">). Так же несколько вызовов директивы можно сгруппировать дополнительными группирующими директивами (</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">они выглядят как теги</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">) </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireAll&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireAny&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireNone&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. Заключенные (</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">обернутые</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">) внутри этих тегов несколько директив </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> работаю как одно целое, и решение о доступе принимается уже на уровне группы директив по логике устанавливаемой групповой оберточной директивой (</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">тегом</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">). Директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireAll&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireAny&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> и </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireNone&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, так же как и </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, работают в контексте каталога, и так же предоставляются модулем </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">mod_authz_core</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span></p>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Принцип работы директивы Require </span></h3>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Более развернуто синтаксис можно представить так (</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">но это не все возможные варианты</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">):</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> [not] all|env|method|expr|user|group|host|ip|local entity-name [entity-name] ... </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Как видно и представленного синтаксиса, директива </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> состоит из двух частей. </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">Первая</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, это объявление самой директивы через ключевое слово </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> и </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">вторая</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> часть, все что справа от объявления директивы, именно которая и определяет метод выполнения проверки авторизации и аргументы передаваемые этому методу. Задание нужного метода проверки авторизации, для использования его директивой при принятии решения о доступе, выполняется путем указания, после объявления самой директивы, следующих ключевых слов -  </span><span style=" font-family:'verdana','geneva','sans-serif'; font-size:12pt; font-weight:600;">all</span><span style=" font-family:'verdana','geneva','sans-serif'; font-size:12pt;">|</span><span style=" font-family:'verdana','geneva','sans-serif'; font-size:12pt; font-weight:600;">env</span><span style=" font-family:'verdana','geneva','sans-serif'; font-size:12pt;">|</span><span style=" font-family:'verdana','geneva','sans-serif'; font-size:12pt; font-weight:600;">method</span><span style=" font-family:'verdana','geneva','sans-serif'; font-size:12pt;">|</span><span style=" font-family:'verdana','geneva','sans-serif'; font-size:12pt; font-weight:600;">expr</span><span style=" font-family:'verdana','geneva','sans-serif'; font-size:12pt;">|</span><span style=" font-family:'verdana','geneva','sans-serif'; font-size:12pt; font-weight:600;">user</span><span style=" font-family:'verdana','geneva','sans-serif'; font-size:12pt;">|</span><span style=" font-family:'verdana','geneva','sans-serif'; font-size:12pt; font-weight:600;">group</span><span style=" font-family:'verdana','geneva','sans-serif'; font-size:12pt;">|</span><span style=" font-family:'verdana','geneva','sans-serif'; font-size:12pt; font-weight:600;">host</span><span style=" font-family:'verdana','geneva','sans-serif'; font-size:12pt;">|</span><span style=" font-family:'verdana','geneva','sans-serif'; font-size:12pt; font-weight:600;">ip</span><span style=" font-family:'verdana','geneva','sans-serif'; font-size:12pt;">|</span><span style=" font-family:'verdana','geneva','sans-serif'; font-size:12pt; font-weight:600;">local</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, каждое из которых соответствует определенному методу. Заданный директиве метод может иметь и принимать много разных аргументов, которые, в свою очередь, могут быть разного типа и вида, и по разному сочетаться, для каждого конкретного метода. Например, аргументы могут быть ключевыми, зарезервированными словами (</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">ключами</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">) и фразами, могут быть логическим выражением (</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">доступно начиная с v2.4.8</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">), и т.д. Если в директиве для метода указано через пробел несколько аргументов, которые не являются зарезервированными ключевыми словами, а представляют собой значения для сравнения указанным методом, то все такие аргументы воспринимаются объединенными логически [</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">или]</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> и достаточно, что бы одни из таких аргументов получил соответствие в методе проверки, что бы  метод суммарно вернул истину, как результат проверки, и директива сработала, и доступ был предоставлен. Метод проверки авторизации, указанный в директиве, всегда суммарно возвращает </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">истину</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> или </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">ложь</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, соответственно если </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">истина</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, директива исполняется и доступ разрешается. Но возможно изменить логику срабатывание директивы на противоположную при помощи необязательного оператора </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">not</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, который используется сразу после объявления директивы. В случае его использования директива срабатывает, когда ее метод суммарно возвращает </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">ложь</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Директива </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> может быть указана многократно, каждая следующая с новой строки. Так же директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> могут быть сгруппированы в секции при помощи тегов-директив </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireAll&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireAny&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireNone&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. Если в конфигурационном файле присутствует несколько директив </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline;">без</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> группирующих тегов, то в этом случае все такие директивы считаются по умолчанию обернутыми в групповой тег</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;"> &lt;RequireAny&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, а это значит, что доступ будет разрешен, если </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline;">хотя бы одна</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> из таких директив исполниться. И в этом случае все остальные директивы, после первой исполненной, будут </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline;">проигнорированы</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. Это нужно понимать и помнить, т.к. в этом случае </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline;">порядок</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> следования директив будет иметь </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline;">значение</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. Более детально, всегда необходимо смотреть документацию по соответствующему модулю в каждом конкретном случае использования директивы. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Как видим директива </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, несмотря на то, что сама по себе она решает только одни вопрос - предоставлять доступ или нет на основе результата метода, является достаточно универсальной. И такая универсальность и гибкость возможна именно благодаря возможности использовать в директиве самые разнообразные методы проверки авторизации. Базовые, основные методы проверки, как и сами директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireAll&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireAny&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireNone&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> реализованы в базовом модуле </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Apache</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">mod_authz_core</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. Дополнительные методы проверки авторизации для использования с директивой </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> предоставляются уже другими модулями </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Apache</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, такими как </span><a href="https://httpd.apache.org/docs/2.4/mod/mod_authz_user.html"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600; text-decoration: underline; color:#0000ff;">mod_authz_user </span></a><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><a href="https://httpd.apache.org/docs/2.4/mod/mod_authz_host.html"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600; text-decoration: underline; color:#0000ff;">mod_authz_host</span></a><a href="https://httpd.apache.org/docs/2.4/mod/mod_authz_host.html"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline; color:#0000ff;"> </span></a><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, и </span><a href="https://httpd.apache.org/docs/2.4/mod/mod_authz_groupfile.html"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600; text-decoration: underline; color:#0000ff;">mod_authz_groupfile </span></a><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> и т.д. </span></p>
<h3 style="-qt-paragraph-type:empty; margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:large; font-weight:600;"><br /></h3>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Примеры использования директивы Require </span></h3>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Примеры и синтаксис </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> c общими методами авторизации из модуля Apache </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">mod_authz_core</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">: </span></p>
<h4 style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:medium; font-weight:600;"><br /></h4>
<h4 style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require all</span></h4>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Общий синтаксис для </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require all</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. После </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">all</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> может быть только ключевое слово </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">granted</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> или </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">denied</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">Require all granted|deniedZZ</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'FreeMono'; color:#6a1009;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Пример разрешения доступа всем без ограничений, что аналогично устаревшей </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Allow from all</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">Require all granted</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'FreeMono'; color:#6a1009;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Пример запрещения доступа всем, что аналогично устаревшей </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Deny from all</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">Require all denied</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'FreeMono'; color:#6a1009;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span></p>
<h4 style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require env </span></h4>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Синтаксис примера для разрешения доступа только, если одна из указанных переменных окружения установлена, где env метод проверки (</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">проверяет существование переменной</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">), env-var имя переменной. Здесь, в примере для </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">.htaccess</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> использована установка через директиву </span><a href="https://httpd.apache.org/docs/2.4/mod/mod_setenvif.html#setenvifnocase"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600; text-decoration: underline; color:#0000ff;">SetEnvIfNoCase </span></a><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> переменной окружения с именем let_me_in по условию, когда строка User-Agent клиента начинается с My_secret_User_Agent. Затем, в директиве </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> проверяется существование этой переменной, и если такая переменная была установлена, то доступ разрешается. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">#Общий вид</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">Require env env-var [env-var] ...</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'FreeMono'; color:#6a1009;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">#Пример для .htaccess</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">SetEnvIfNoCase User-Agent ^My_secret_User_Agent let_me_in</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">Require env let_me_in </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Использование </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">not</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> выполняет инверсию срабатывания процедуры, поэтому в примере синтаксиса ниже, если одна, из указанных в аргументах директивы, </span><a href="https://httpd.apache.org/docs/2.4/env.html"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline; color:#0000ff;">переменных окружения </span></a><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> будет установлена, то доступ, наоборот, будет запрещен, потому что оператор not выполнит инверсию результата метода проверки. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">Require not env env-var [env-var] ... </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<h4 style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require method </span></h4>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Синтаксис примера для разрешения доступа только для указанного метода или методов запроса. Аргумент http-method - это метод запроса вида </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">GET</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">POST</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> и др. Для клиентов, выполнившие запрос к серверу другими методами, не указанными в аргументах директивы, доступ будет запрещен. Это может быть удобно, если необходимо, например, для некоторых разделов сайта разрешить доступ только для </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">GET</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> запросов. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">Require method http-method [http-method] ... </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<h4 style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require expr </span></h4>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Синтаксис примера для разрешения доступа на основе проверки по логическому выражению (</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">доступно начиная с v2.4.8</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">). Аргумент expression это </span><a href="https://httpd.apache.org/docs/2.4/expr.html"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline; color:#0000ff;">логическое выражение в формате синтаксиса Apache </span></a><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, которое в итоге возвращает ИСТИНУ или ЛОЖЬ. Доступ клиенту разрешается, если выражение возвращает ИСТИНУ. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">Require expr expression</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Пример разрешения доступа на основе логического выражения. Здесь, доступ разрешается для всех клиентов, у которых значение </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">USER_AGENT</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline;">не</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> содержит фразу 'BadBot': </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">Require expr %{HTTP_USER_AGENT} != 'BadBot' </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<h4 style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require с If, ElseIf, Else</span></h4>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Пример использования </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> совместно с директивами-тегами условий </span><a href="https://httpd.apache.org/docs/2.4/mod/core.html#if"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600; text-decoration: underline; color:#0000ff;">&lt;If&gt;</span></a><a href="https://httpd.apache.org/docs/2.4/mod/core.html#if"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline; color:#0000ff;"> </span></a><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;ElseIf&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Else&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> и т.д, которые доступны для применения в глобальном конфиге, в конфиге виртуального хоста, в секциях локализации (</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">directory</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">) в конфигах, и в </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">.htaccess</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> файле. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">#Пример на основе USER_AGENT</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;If &quot;%{HTTP_USER_AGENT} == 'BadBot'&quot;&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">    Require all denied</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;/If&gt;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'FreeMono'; color:#6a1009;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">#Пример на основе диапазона IP</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">#Если удаленный IP в диапазоне 10.1.0.0/16</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;If &quot;-R '10.1.0.0/16'&quot;&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">  Require ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;/If&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">#ИначеЕсли удаленный IP лежит в диапазоне 10.0.0.0/8</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;ElseIf &quot;-R '10.0.0.0/8'&quot;&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">  Require ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;/ElseIf&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">#Иначе удаленный IP НЕ в диапазоне 10.1.0.0/16 и 10.0.0.0/8</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;Else&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">  Require ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;/Else&gt; </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<h4 style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require с RequireAll, RequireAny, RequireNone </span></h4>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Синтаксис примера </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireAll&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> директивы-тега. Эта групповая директива требует, что бы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline;">все</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, заключенные внутри нее, директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> были исполнены, и только в этом случае </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireAll&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> исполниться, и доступ будет предоставлен. В приведенном примере клиентам, приходящим с IP 192.168.48.185 или с домена host.example.com, доступ будет </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline;">запрещен</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, а всем остальным доступ будет разрешен.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;RequireAll&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">    Require all granted</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">    Require not ip 192.168.48.185</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">    Require not host host.example.com</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;/RequireAll&gt; </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Синтаксис примера </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireAny&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> директивы-тега. Эта групповая директива требует, что бы хотя бы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline;">одна</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> из заключенных внутри нее директив </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> была исполнена, только в этом случае </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireAny&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> исполниться и доступ будет предоставлен. Поэтому внутри </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireAny&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, все последующие директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, следующие после </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline;">первой</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline;">исполненной</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, уже игнорируются. В данном примере доступ будет предоставлен только клиентам, выполнившим запрос методом GET или POST, или только клиентам, прошедшим авторизацию по пользователю и паролю методом заданным директивой </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">AuthType</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;RequireAny&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">     Require method GET POST</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">     Require valid-user</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;/RequireAny&gt;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Синтаксис примера применения группой директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireNone&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. Эта групповая директива требует, что бы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline;">ВСЕ</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> заключенные внутри нее директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> были </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline;">НЕ исполненные</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, только в этом случае </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireNone&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> исполниться и доступ будет предоставлен. В примере, доступ клиента к каталогу &quot;/www/doc&quot; будет предоставлен только в том случае, если ВСЕ директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> внутри группой директивы-тега </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;RequireNone&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline;">НЕ</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> исполняться. Этот пример для конфига виртуального хоста. В файле </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">.htaccess</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> используйте этот код без тега </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Directory&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">#Пример из конфига виртуального хоста</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;Directory &quot;/www/doc&quot;&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">    &lt;</span><span style=" font-family:'FreeMono'; font-weight:600; color:#6a1009; background-color:#fafafa;">RequireNone</span><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">        Require ip entity-name ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">        Require not ip entity-name ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">    &lt;/</span><span style=" font-family:'FreeMono'; font-weight:600; color:#6a1009; background-color:#fafafa;">RequireNone</span><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;/Directory&gt; </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Условный пример комбинированного использования директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> c группирующими директивами для конфига виртуального хоста.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;Directory &quot;/www/doc&quot;&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">    &lt;RequireAll&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">        &lt;RequireAny&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">            Require ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">            &lt;RequireAll&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">                Require ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">                Require ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">                &lt;RequireAny&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">                    Require ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">                    Require ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">                &lt;/RequireAny&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">            &lt;/RequireAll&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">        &lt;/RequireAny&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">        &lt;RequireNone&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">            Require ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">            Require ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">        &lt;/RequireNone&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">    &lt;/RequireAll&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;/Directory&gt; </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<h4 style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require инверсия условия </span></h4>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Логику срабатывания директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> можно изменить на противоположную путем использования: </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">not</span> - необязательного первого аргумента в директиве <span style=" font-weight:600;">Require</span>, наличие которого приведет к инверсии срабатывания директивы. Оператор <span style=" font-weight:600;">not</span> работает на уровне одной директивы и не является false, а представляет собой опцию указывавшую серверу на изменение логики обработки директивы. </li>
<li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">&lt;RequireNone&gt;</span> - групповой тег (<span style=" font-style:italic;">директива</span>), если расположить одну или несколько директив <span style=" font-weight:600;">Require</span> внутри тега <span style=" font-weight:600;">&lt;RequireNone&gt;</span>, то это приведет к групповой инверсии срабатывания директив внутри этого контейнера. Для того, что бы директива <span style=" font-weight:600;">&lt;RequireNone&gt;</span> была успешно выполнена, <span style=" text-decoration: underline;">ВСЕ</span> расположенные внутри нее директивы <span style=" font-weight:600;">Require</span> должны быть <span style=" font-weight:600;">НЕ</span> успешными (<span style=" font-style:italic;">не исполненными</span>), и только в этом случае групповая директива <span style=" font-weight:600;">&lt;RequireNone&gt;</span> будет успешно исполнена и доступ будет разрешен. </li></ul>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Примеры и синтаксис </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> с дополнительными методами авторизации из модулей </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">mod_authz_user</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">mod_authz_groupfile</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">: </span></p>
<h4 style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-size:medium; font-weight:600;"><br /></h4>
<h4 style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require user, group</span></h4>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Синтаксис примера для разрешения доступа на основе проверки пользователя по его логину. Доступ разрешается только пользователям с логинами указанными в аргументе userid директивы. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">Require user userid [userid] ... </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Синтаксис примера для разрешения доступа на основе проверки пользователя на принадлежность указанным в аргументе group-name группе. Доступ разрешен только пользователям из указанных групп.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">Require group group-name [group-name] ... </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<h4 style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require valid-user </span></h4>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Синтаксис примера для разрешения доступа пользователям, успешно прошедшим авторизацию (</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-style:italic;">валидацию</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">), например, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">AuthType Basic</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">http</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> авторизацию. Здесь, доступ разрешен только пользователям прошедшим валидацию. Метод валидации указывается отдельными директивами, например, </span><a href="https://httpd.apache.org/docs/2.4/mod/mod_authn_core.html#authtype"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600; text-decoration: underline; color:#0000ff;">AuthType </span></a></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">Require valid-user</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Пример использования директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> с базовой </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">http</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> авторизацией по паролю, предоставляемой модулем </span><a href="https://httpd.apache.org/docs/2.4/mod/mod_authn_core.html"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline; color:#0000ff;">mod_authn_core </span></a><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. В примере доступ к директории сайта &quot;/www/doc&quot; будет разрешен только пользователям, успешно прошедшим базовую </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">http</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> авторизацию по паролю. Этот пример для конфига виртуального хоста. В файле </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">.htaccess</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> используйте этот код без тега </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Directory&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">#Пример из конфига виртуального хоста</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">#Защита паролем директории &quot;/www/doc&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;Directory &quot;/www/doc&quot;&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">    AuthType Basic</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">    AuthName </span><span style=" font-family:'FreeMono'; font-weight:600; color:#6a1009; background-color:#fafafa;">Documents</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">    AuthBasicProvider file</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">    #Путь к файлу с хэшами паролей</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">    AuthUserFile &quot;/usr/local/apache/passwd/passwords&quot;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">    Require valid-user</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;/Directory&gt;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'FreeMono'; color:#6a1009;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">#Отмена наследования защиты паролем для вложенной директории</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;Directory &quot;/www/doc/public&quot;&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">    AuthType None</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">    Require all granted</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">&lt;/Directory&gt; </span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Доступом на основе значений хоста </span></h3>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Организация короля доступа к сайту и его частям директивой </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> на основе дополнительных методов анализа значений хоста клиента из модуля </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">mod_authz_host</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> является одним из часто применяемых на практике вариантов использования директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. В этом варианте авторизация выполняется на основе проверки соответствия значения хоста клиента аргументам метода директивы, заданным в виде: '</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">ip</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">', '</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">hostname</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">' или '</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">local</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">'. Такой же функционал предоставляют и устаревшие директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Allow</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Deny</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, которые в ранних версиях </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Apache</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> в основном выполняли эту роль. Здесь, нужно заметить, что смысл, виды и форматы аргументов для методов, выполняющих проверку и сравнение значений хоста в директивах </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Allow</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Deny</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> одинаковы для всех директив. Поэтому, представленное ниже описания этих аргументов, применимо для всех этих директив. </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">  </span></p>
<h4 style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require host, ip, local </span></h4>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Синтаксис использования директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Require</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> с методом проверки по значению хоста:</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">Require [not] host|ip|local value1 [value2]... </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">где:</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">[not]</span> - необязательный аргумент, который выполняет инверсию обработки условия и директива исполниться только если хост не соответствует аргументам; </li>
<li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">host|ip|local</span> -аргумент ключ, сообщающий директиве, какой конкретно метод проверки аргументов value нужно использовать, т.е. указание на то, какой тип значения используется в аргументах value: </li></ul>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 2;"><li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">host</span> - указывает, что value содержит имя хоста в виде полного или частичного доменного имени. Можно через пробел указать несколько value, которые будут считаться объединенными через логическое [или]. Директивы в таком варианте сработают для доменов, полные компоненты которых будут заканчиваться на строку в аргументе value. Подбор и проверка строки имени домена, сделавшего запрос, будет выполняться по полным компонентам. Например для <span style=" font-style:italic;">example.com</span> будут пропускаться домен <span style=" font-style:italic;">example.com</span> и любые под домены этого домина вида <span style=" font-style:italic;">foo.example.com</span>, но домен вида <span style=" font-style:italic;">myexample.com</span> будет отклонен. Такой вариант задания аргумента сравнения значения хоста в виде полной части доменного имени обяжет <span style=" font-weight:600;">Apache</span> выполнить обратный <span style=" font-weight:600;">DNS</span> запрос для <span style=" font-weight:600;">IP</span> адреса клиента, что бы получить связанное с ним доменное имя хоста. Затем <span style=" font-weight:600;">Apache</span>, выполнит уже прямой <span style=" font-weight:600;">DNS</span> запрос, что бы убедиться, что полученное обратным запросом доменное имя действительно соответствует <span style=" font-weight:600;">IP</span> адресу запроса. Только, если <span style=" text-decoration: underline;">оба</span> эти запроса - обратный и прямой укажут на одно и тоже доменное имя и это доменное имя будет соответствовать/совпадать строке аргумента value, при сравнении с конца строки по полным компонентам доменного имени, директива исполниться. Такой функционал <span style=" font-style:italic;">double-reverse DNS lookup</span> обеспечивается возможностями ядра apache и управляется директивой <a href="https://httpd.apache.org/docs/2.4/mod/core.html#hostnamelookups"><span style=" font-weight:600; text-decoration: underline; color:#0000ff;">HostnameLookups</span></a><a href="https://httpd.apache.org/docs/2.4/mod/core.html#hostnamelookups"><span style=" text-decoration: underline; color:#0000ff;"> </span></a>, которая по умолчанию имеет значение <span style=" font-weight:600;">Off</span> для экономии трафика. Эта директива разрешает выполнение <span style=" font-weight:600;">DNS</span>-запросов, и имена хостов могут быть переданы как <span style=" font-weight:600;">REMOTE_HOST</span> значение. Однако, ВНЕ ЗАВИСИМОСТИ ОТ НАСТРОЙКИ <span style=" font-weight:600;">HostnameLookups</span>, КОГДА MOD_AUTHZ_HOST используется для контроля доступа по имени хоста, двойной DNS запрос <span style=" text-decoration: underline;">будет выполнен</span>, потому, что это необходимо для обеспечения безопасности, так как речь идет о короле доступа. Начиная с версии <span style=" font-weight:600;">Apache</span>  v2.4.8, в Require host value... в аргументах value поддерживаются различные логические выражения, что дает еще большую гибкость в задании условий проверки хоста по его имени (<span style=" font-style:italic;">см. выше примеры для Require expr</span>). </li>
<li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">ip</span> - указывает, что value содержит IP-адрес или диапазон IP, как часть ip, как <span style=" font-style:italic;">network/netmask</span>, <span style=" font-style:italic;">network/nnn </span><span style=" font-weight:600; font-style:italic;">CIDR</span>. Можно через пробел указать несколько value, которые будут считаться объединенными через логическое [или]. </li>
<li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">local</span> -указывает, что проверку хоста клиента делать на соответствие локальному хосту. С этим ключом не нужно указывать аргументы value, т.к. <span style=" font-weight:600;">Apache</span> сам их получит от локального хоста. Для этого варианта будет выполнена проверка на то, что хост клиента, выполнившего запрос является (или не является, при использовании [not]) локальным хостом. Проверка на соответствие локальному хосту будет выполняться по следующим пунктам, все из которых должны быть <span style=" text-decoration: underline;">истинными</span>: </li></ul>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 3;"><li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">IP4 находиться в диапазоне 127.0.0.0/8 </li>
<li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">IP6 ::1 </li>
<li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">адрес клиента и адрес сервера одинаковы </li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:80px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Однако, если у вас установлен прокси сервер и </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">apache</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> получил запрос не от клиента напрямую, а от прокси сервера, то для </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">apache</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> уже значение хоста клиента будет прокси сервер, а не первоначальный клиент. Для решения вопроса правильного контроля доступа в этом случае нужно воспользоваться модулем </span><a href="https://httpd.apache.org/docs/2.4/mod/mod_remoteip.html"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600; text-decoration: underline; color:#0000ff;">mod_remoteip</span></a><a href="https://httpd.apache.org/docs/2.4/mod/mod_remoteip.html"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline; color:#0000ff;"> </span></a><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">value1</span> [<span style=" font-weight:600;">value2</span>]... - аргументы для использования в методе проверки и сравнения в соответствии указанным типом значения. Можно через пробел указать несколько value, которые будут считаться объединенными через логическое [или]. Нужно сказать, что этот аргумент директивы <span style=" font-weight:600;">Require</span> задается и обрабатывается по такому же принципу как и в директивах <span style=" font-weight:600;">Allow</span>, <span style=" font-weight:600;">Deny</span> и детально он будет описан ниже. </li></ul>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<h4 style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Allow и Deny с all, host, env </span></h4>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Пример общего синтаксиса директив </span><a href="https://httpd.apache.org/docs/2.4/mod/mod_access_compat.html#allow"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600; text-decoration: underline; color:#0000ff;">Allow</span></a><a href="https://httpd.apache.org/docs/2.4/mod/mod_access_compat.html#allow"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline; color:#0000ff;"> </span></a><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> и </span><a href="https://httpd.apache.org/docs/2.4/mod/mod_access_compat.html#deny"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600; text-decoration: underline; color:#0000ff;">Deny </span></a><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. Директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Allow</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> и </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Deny</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> применяются на уровне каталога, поэтому в глобальном конфиге </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Apache</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> и в конфиге виртуальных хостов они должны быть заключены внутрь тегов-директив локализации </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Directory&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Files&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">&lt;Location&gt;</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">  и т.п., а в файле .htaccess указываются уже напрямую. Можно написать несколько директив подряд, каждая с новой строки. В этом случае директивы объединяются логическим [или].</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">Allow from all|host|env=[!]env-variable [host|env=[!]env-variable] ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">Deny  from all|host|env=[!]env-variable [host|env=[!]env-variable] ... </span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">где:</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">all - ключевое слово, что значит для всех запросов. Соответственно, после All последующие аргументы не задаются; </li>
<li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">host - это аргумент для проверки значения хоста. Может быть задан, как <span style=" font-weight:600;">ip</span>, диапазон ip, имя хоста. Вид аргумента такой же, как и у директивы <span style=" font-weight:600;">Require</span> </li>
<li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">env-variable - имя переменной окружения для проверки, что такая переменная установлена ([!] - не установлена). Этот функционал аналогичен функционалу предоставляемому директивой Require env env-var [env-var] ... </li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Для расширения функционала </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Allow</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> и </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Deny</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> директив используется директива </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Order</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, которая устанавливает порядок обработки директив и предоставляет </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline;">два</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> варианта организации контроля доступа: </span></p>
<ul style="margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;"><li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Order Allow,Deny</span> - сначала обрабатываются все <span style=" font-weight:600;">Allow</span> директивы, среди которых, как минимум одна должна исполниться, иначе доступ сразу запрещается и следующие директивы уже игнорируются. Если на предыдущем шаге была хотя бы одна исполненная директива <span style=" font-weight:600;">Allow</span>, то далее начинают обрабатываться директивы <span style=" font-weight:600;">Deny</span>. Если хотя бы одна из директив <span style=" font-weight:600;">Deny</span> будет исполнена, то доступ будет запрещен и следующие директивы будут уже проигнорированы. Иначе говоря, что бы доступ клиенту был предоставлен необходимо, в этом варианте, что бы хотя бы одна директива <span style=" font-weight:600;">Allow</span> была исполнена и все директивы <span style=" font-weight:600;">Deny</span> были <span style=" text-decoration: underline;">НЕ</span> исполнены; </li>
<li style=" font-family:'DejaVu LGC Sans'; font-size:12pt;" style=" margin-top:0px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-weight:600;">Order Deny,Allow</span> - сначала обрабатываются все директивы <span style=" font-weight:600;">Deny</span>, и если какая либо их них исполниться, то доступ будет запрещен, если при этом же запрос не приведет к исполнению <span style=" font-weight:600;">Allow</span> директивы. Любые запросы, которые не соответствуют ни одной директиве <span style=" font-weight:600;">Allow</span> или <span style=" font-weight:600;">Deny</span> будут <span style=" text-decoration: underline;">разрешены</span>. Иначе горя, в этом варианте вы сначала ставите запрещающие условия в <span style=" font-weight:600;">Deny</span>, а затем в <span style=" font-weight:600;">Allow</span> ставите исключения для того что указали в Deny. </li></ul>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">В примере доступ будет разрешен только хостам принадлежащих домену example.org, т.е. example.org и foo.example.org</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">Order Deny,Allow</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">Deny from all</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">Allow from example.org</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">В примере доступ будет предоставлен только хосту с домена example.org, за исключением его под доменов.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">Order Allow,Deny</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">Allow from example.org</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:40px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'FreeMono'; color:#6a1009; background-color:#fafafa;">Deny from foo.example.org</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"><br /></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">По умолчанию, директива </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Order</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> имеет установку как </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Order Deny,Allow</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, поэтому нужно быть внимательным при указании </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Order</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> без последующего указания директив </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Allow</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> или </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Deny</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, и наоборот, при указании этих директив без предварительного задания директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Order</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. В примере ниже продемонстрировано, как это может привести к не ожидаемому результату. В примере из конфига виртуального хоста указана только директива </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Order Allow,Deny</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">, но после нее </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">не</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> указаны директивы </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Allow</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> или </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Deny</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. Это приведет к тому, что доступ к &quot;/www&quot; каталогу будет запрещен, так как поведение по умолчанию </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">deny</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">.</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">&lt;Directory </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">/www&gt;</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">    Order Allow,Deny</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">    # Ошибка, не указаны директивы Allow или Deny</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">    # Поэтому доступ будет запрещен т.к. по умолчанию deny</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">&lt;/Directory&gt;</span></p>
<p style="-qt-paragraph-type:empty; margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<h3 style=" margin-top:14px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Примеры директив для методов проверки хоста </span></h3>
<h4 style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Использование Require, Allow, Deny с именем хоста </span></h4>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Аргументы для метода проверки хоста, могут быть так же представлены в виде полного или частичного доменного имени. Однако, всегда нужно помнить, что в этом варианте сервер будет делать прямой и обратный </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">DNS</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> запросы, что является накладной операцией и делать это постоянно, для всех запросов не совсем разумно. Если уж есть необходимость делать такую проверку, то лучше вызвать ее по предварительному условию, например на основе анализа значения HTTP_USER_AGENT запроса. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">#Разрешать example.com и все foo.example.com</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Require host example.com</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"># или</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Allow from example.com</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">#Разрешать все foo.com, example.ru и все foo.example.ru</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Require host .com example.ru</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"># или</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Allow from .com example.ru </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">  </span></p>
<h4 style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Использование Require, Allow, Deny с IP </span></h4>
<h5 style=" margin-top:12px; margin-bottom:4px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Как полный IP-адрес </span></h5>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Синтаксис примера для проверки хоста по полному IP адресу. Директивы сработают только для указанных IP. В этом варианте все просто, директива будет срабатывать только если IP адрес запроса будет точно совпадать с указанным или указанными в директиве аргументами в виде строки полного IP. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">#Разрешать только для 10.1.1.1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Require ip 10.1.1.1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"># или</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Allow from 10.1.1.1</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">#Разрешать только для 192.168.0.100 или 192.168.0.205</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Require ip 192.168.0.100 192.168.0.205</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"># или</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Allow from 192.168.0.100 192.168.0.205 </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">  </span></p>
<h5 style=" margin-top:12px; margin-bottom:4px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Как IP диапазон </span></h5>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Как частичный </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">IP</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">-адрес задающий диапазон (диапазоны) IP, для ограничения подсети (подсетей). Директивы сработают для всех IP, лежащих в пределах указанных диапазонов. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">#Первые 2 байта IP для ограничения подсети</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Require ip 10.1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"># или</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Allow from 10.1</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">#Первые 1 - 3 байта IP-адреса для ограничения подсети</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Require ip 10 172.10 192.168.1</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"># или</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Allow from 10 172.10 192.168.1 </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">  </span></p>
<h5 style=" margin-top:12px; margin-bottom:4px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Как IP network/netmask </span></h5>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Как network/netmask пара задающая диапазон ограничения подсети. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Require ip 10.1.0.0/255.255.0.0 network/netmask ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"># или</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Allow from 10.1.0.0/255.255.0.0 network/netmask ... </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">  </span></p>
<h5 style=" margin-top:12px; margin-bottom:4px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Как IP network/nnn CIDR </span></h5>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Как network/nnn </span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">CIDR</span><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;"> пара задающая диапазон ограничения подсети. Достаточно удобный вариант задания параметров проверки хоста. Для преобразования IP диапазонов в CIDR формат можно воспользоваться сервисом - </span><a href="http://ip2cidr.com/"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; text-decoration: underline; color:#0000ff;">ip2cidr.com </span></a><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">. </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Require ip 5.248.128.0/23 network/nnn ...</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"># или</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Allow from 5.248.128.0/23 network/nnn ... </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">  </span></p>
<h5 style=" margin-top:12px; margin-bottom:4px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Адреса IPv6 </span></h5>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Адреса IPv6 и подсети IPv6 могут быть определены как показано в примере ниже: </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Require ip 2001:db8::a00:20ff:fea7:ccea</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"># или</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Allow from 2001:db8::a00:20ff:fea7:ccea</span></p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Require ip 2001:db8::a00:20ff:fea7:ccea/10</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;"># или</span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Allow from 2001:db8::a00:20ff:fea7:ccea/10 </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">  </span></p>
<h4 style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; font-weight:600;">Использование Require local </span></h4>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Разрешать только локальным клиентам: </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Require local </span></p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt;">Или с отрицанием, всем кроме локальных клиентов: </span></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#fafafa;"><span style=" font-family:'DejaVu LGC Sans'; font-size:12pt; background-color:#fafafa;">Require not local</span></p></body></html>